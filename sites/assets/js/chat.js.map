{"version":3,"file":"chat.js","sources":["../../../apps/frappe/node_modules/fuse.js/dist/fuse.js","../../../apps/frappe/frappe/public/js/lib/hyper.min.js","../../../apps/frappe/frappe/public/js/frappe/socketio_client.js","../../../apps/frappe/frappe/public/js/frappe/class.js","../../../apps/frappe/frappe/public/js/frappe/form/layout.js","../../../apps/frappe/frappe/public/js/frappe/ui/field_group.js","../../../apps/frappe/frappe/public/js/frappe/dom.js","../../../apps/frappe/frappe/public/js/frappe/ui/dialog.js","../../../apps/frappe/frappe/public/js/frappe/ui/capture.js","../../../apps/frappe/frappe/public/js/frappe/utils/user.js","../../../apps/frappe/frappe/public/js/frappe/chat.js"],"sourcesContent":["/*!\n * Fuse.js v3.6.1 - Lightweight fuzzy-search (http://fusejs.io)\n * \n * Copyright (c) 2012-2017 Kirollos Risk (http://kiro.me)\n * All Rights Reserved. Apache Software License 2.0\n * \n * http://www.apache.org/licenses/LICENSE-2.0\n */\n!function(e,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(\"Fuse\",[],t):\"object\"==typeof exports?exports.Fuse=t():e.Fuse=t()}(this,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,\"a\",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p=\"\",r(r.s=0)}([function(e,t,r){function n(e){return(n=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=r(1),a=r(7),s=a.get,c=(a.deepValue,a.isArray),h=function(){function e(t,r){var n=r.location,o=void 0===n?0:n,i=r.distance,a=void 0===i?100:i,c=r.threshold,h=void 0===c?.6:c,l=r.maxPatternLength,u=void 0===l?32:l,f=r.caseSensitive,v=void 0!==f&&f,p=r.tokenSeparator,d=void 0===p?/ +/g:p,g=r.findAllMatches,y=void 0!==g&&g,m=r.minMatchCharLength,k=void 0===m?1:m,b=r.id,S=void 0===b?null:b,x=r.keys,M=void 0===x?[]:x,_=r.shouldSort,w=void 0===_||_,L=r.getFn,A=void 0===L?s:L,O=r.sortFn,C=void 0===O?function(e,t){return e.score-t.score}:O,j=r.tokenize,P=void 0!==j&&j,I=r.matchAllTokens,F=void 0!==I&&I,T=r.includeMatches,N=void 0!==T&&T,z=r.includeScore,E=void 0!==z&&z,W=r.verbose,K=void 0!==W&&W;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.options={location:o,distance:a,threshold:h,maxPatternLength:u,isCaseSensitive:v,tokenSeparator:d,findAllMatches:y,minMatchCharLength:k,id:S,keys:M,includeMatches:N,includeScore:E,shouldSort:w,getFn:A,sortFn:C,verbose:K,tokenize:P,matchAllTokens:F},this.setCollection(t),this._processKeys(M)}var t,r,a;return t=e,(r=[{key:\"setCollection\",value:function(e){return this.list=e,e}},{key:\"_processKeys\",value:function(e){if(this._keyWeights={},this._keyNames=[],e.length&&\"string\"==typeof e[0])for(var t=0,r=e.length;t<r;t+=1){var n=e[t];this._keyWeights[n]=1,this._keyNames.push(n)}else{for(var o=null,i=null,a=0,s=0,c=e.length;s<c;s+=1){var h=e[s];if(!h.hasOwnProperty(\"name\"))throw new Error('Missing \"name\" property in key object');var l=h.name;if(this._keyNames.push(l),!h.hasOwnProperty(\"weight\"))throw new Error('Missing \"weight\" property in key object');var u=h.weight;if(u<0||u>1)throw new Error('\"weight\" property in key must bein the range of [0, 1)');i=null==i?u:Math.max(i,u),o=null==o?u:Math.min(o,u),this._keyWeights[l]=u,a+=u}if(a>1)throw new Error(\"Total of weights cannot exceed 1\")}}},{key:\"search\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{limit:!1};this._log('---------\\nSearch pattern: \"'.concat(e,'\"'));var r=this._prepareSearchers(e),n=r.tokenSearchers,o=r.fullSearcher,i=this._search(n,o);return this._computeScore(i),this.options.shouldSort&&this._sort(i),t.limit&&\"number\"==typeof t.limit&&(i=i.slice(0,t.limit)),this._format(i)}},{key:\"_prepareSearchers\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"\",t=[];if(this.options.tokenize)for(var r=e.split(this.options.tokenSeparator),n=0,o=r.length;n<o;n+=1)t.push(new i(r[n],this.options));return{tokenSearchers:t,fullSearcher:new i(e,this.options)}}},{key:\"_search\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,r=this.list,n={},o=[];if(\"string\"==typeof r[0]){for(var i=0,a=r.length;i<a;i+=1)this._analyze({key:\"\",value:r[i],record:i,index:i},{resultMap:n,results:o,tokenSearchers:e,fullSearcher:t});return o}for(var s=0,c=r.length;s<c;s+=1)for(var h=r[s],l=0,u=this._keyNames.length;l<u;l+=1){var f=this._keyNames[l];this._analyze({key:f,value:this.options.getFn(h,f),record:h,index:s},{resultMap:n,results:o,tokenSearchers:e,fullSearcher:t})}return o}},{key:\"_analyze\",value:function(e,t){var r=this,n=e.key,o=e.arrayIndex,i=void 0===o?-1:o,a=e.value,s=e.record,h=e.index,l=t.tokenSearchers,u=void 0===l?[]:l,f=t.fullSearcher,v=t.resultMap,p=void 0===v?{}:v,d=t.results,g=void 0===d?[]:d;!function e(t,o,i,a){if(null!=o)if(\"string\"==typeof o){var s=!1,h=-1,l=0;r._log(\"\\nKey: \".concat(\"\"===n?\"--\":n));var v=f.search(o);if(r._log('Full text: \"'.concat(o,'\", score: ').concat(v.score)),r.options.tokenize){for(var d=o.split(r.options.tokenSeparator),y=d.length,m=[],k=0,b=u.length;k<b;k+=1){var S=u[k];r._log('\\nPattern: \"'.concat(S.pattern,'\"'));for(var x=!1,M=0;M<y;M+=1){var _=d[M],w=S.search(_),L={};w.isMatch?(L[_]=w.score,s=!0,x=!0,m.push(w.score)):(L[_]=1,r.options.matchAllTokens||m.push(1)),r._log('Token: \"'.concat(_,'\", score: ').concat(L[_]))}x&&(l+=1)}h=m[0];for(var A=m.length,O=1;O<A;O+=1)h+=m[O];h/=A,r._log(\"Token score average:\",h)}var C=v.score;h>-1&&(C=(C+h)/2),r._log(\"Score average:\",C);var j=!r.options.tokenize||!r.options.matchAllTokens||l>=u.length;if(r._log(\"\\nCheck Matches: \".concat(j)),(s||v.isMatch)&&j){var P={key:n,arrayIndex:t,value:o,score:C};r.options.includeMatches&&(P.matchedIndices=v.matchedIndices);var I=p[a];I?I.output.push(P):(p[a]={item:i,output:[P]},g.push(p[a]))}}else if(c(o))for(var F=0,T=o.length;F<T;F+=1)e(F,o[F],i,a)}(i,a,s,h)}},{key:\"_computeScore\",value:function(e){this._log(\"\\n\\nComputing score:\\n\");for(var t=this._keyWeights,r=!!Object.keys(t).length,n=0,o=e.length;n<o;n+=1){for(var i=e[n],a=i.output,s=a.length,c=1,h=0;h<s;h+=1){var l=a[h],u=l.key,f=r?t[u]:1,v=0===l.score&&t&&t[u]>0?Number.EPSILON:l.score;c*=Math.pow(v,f)}i.score=c,this._log(i)}}},{key:\"_sort\",value:function(e){this._log(\"\\n\\nSorting....\"),e.sort(this.options.sortFn)}},{key:\"_format\",value:function(e){var t=[];if(this.options.verbose){var r=[];this._log(\"\\n\\nOutput:\\n\\n\",JSON.stringify(e,function(e,t){if(\"object\"===n(t)&&null!==t){if(-1!==r.indexOf(t))return;r.push(t)}return t},2)),r=null}var o=[];this.options.includeMatches&&o.push(function(e,t){var r=e.output;t.matches=[];for(var n=0,o=r.length;n<o;n+=1){var i=r[n];if(0!==i.matchedIndices.length){var a={indices:i.matchedIndices,value:i.value};i.key&&(a.key=i.key),i.hasOwnProperty(\"arrayIndex\")&&i.arrayIndex>-1&&(a.arrayIndex=i.arrayIndex),t.matches.push(a)}}}),this.options.includeScore&&o.push(function(e,t){t.score=e.score});for(var i=0,a=e.length;i<a;i+=1){var s=e[i];if(this.options.id&&(s.item=this.options.getFn(s.item,this.options.id)[0]),o.length){for(var c={item:s.item},h=0,l=o.length;h<l;h+=1)o[h](s,c);t.push(c)}else t.push(s.item)}return t}},{key:\"_log\",value:function(){var e;this.options.verbose&&(e=console).log.apply(e,arguments)}}])&&o(t.prototype,r),a&&o(t,a),e}();e.exports=h},function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=r(2),i=r(3),a=r(6),s=function(){function e(t,r){var n=r.location,o=void 0===n?0:n,i=r.distance,s=void 0===i?100:i,c=r.threshold,h=void 0===c?.6:c,l=r.maxPatternLength,u=void 0===l?32:l,f=r.isCaseSensitive,v=void 0!==f&&f,p=r.tokenSeparator,d=void 0===p?/ +/g:p,g=r.findAllMatches,y=void 0!==g&&g,m=r.minMatchCharLength,k=void 0===m?1:m,b=r.includeMatches,S=void 0!==b&&b;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.options={location:o,distance:s,threshold:h,maxPatternLength:u,isCaseSensitive:v,tokenSeparator:d,findAllMatches:y,includeMatches:S,minMatchCharLength:k},this.pattern=v?t:t.toLowerCase(),this.pattern.length<=u&&(this.patternAlphabet=a(this.pattern))}var t,r,s;return t=e,(r=[{key:\"search\",value:function(e){var t=this.options,r=t.isCaseSensitive,n=t.includeMatches;if(r||(e=e.toLowerCase()),this.pattern===e){var a={isMatch:!0,score:0};return n&&(a.matchedIndices=[[0,e.length-1]]),a}var s=this.options,c=s.maxPatternLength,h=s.tokenSeparator;if(this.pattern.length>c)return o(e,this.pattern,h);var l=this.options,u=l.location,f=l.distance,v=l.threshold,p=l.findAllMatches,d=l.minMatchCharLength;return i(e,this.pattern,this.patternAlphabet,{location:u,distance:f,threshold:v,findAllMatches:p,minMatchCharLength:d,includeMatches:n})}}])&&n(t.prototype,r),s&&n(t,s),e}();e.exports=s},function(e,t){var r=/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g;e.exports=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:/ +/g,o=new RegExp(t.replace(r,\"\\\\$&\").replace(n,\"|\")),i=e.match(o),a=!!i,s=[];if(a)for(var c=0,h=i.length;c<h;c+=1){var l=i[c];s.push([e.indexOf(l),l.length-1])}return{score:a?.5:1,isMatch:a,matchedIndices:s}}},function(e,t,r){var n=r(4),o=r(5);e.exports=function(e,t,r,i){for(var a=i.location,s=void 0===a?0:a,c=i.distance,h=void 0===c?100:c,l=i.threshold,u=void 0===l?.6:l,f=i.findAllMatches,v=void 0!==f&&f,p=i.minMatchCharLength,d=void 0===p?1:p,g=i.includeMatches,y=void 0!==g&&g,m=s,k=e.length,b=u,S=e.indexOf(t,m),x=t.length,M=[],_=0;_<k;_+=1)M[_]=0;if(-1!==S){var w=n(t,{errors:0,currentLocation:S,expectedLocation:m,distance:h});if(b=Math.min(w,b),-1!==(S=e.lastIndexOf(t,m+x))){var L=n(t,{errors:0,currentLocation:S,expectedLocation:m,distance:h});b=Math.min(L,b)}}S=-1;for(var A=[],O=1,C=x+k,j=1<<(x<=31?x-1:30),P=0;P<x;P+=1){for(var I=0,F=C;I<F;){n(t,{errors:P,currentLocation:m+F,expectedLocation:m,distance:h})<=b?I=F:C=F,F=Math.floor((C-I)/2+I)}C=F;var T=Math.max(1,m-F+1),N=v?k:Math.min(m+F,k)+x,z=Array(N+2);z[N+1]=(1<<P)-1;for(var E=N;E>=T;E-=1){var W=E-1,K=r[e.charAt(W)];if(K&&(M[W]=1),z[E]=(z[E+1]<<1|1)&K,0!==P&&(z[E]|=(A[E+1]|A[E])<<1|1|A[E+1]),z[E]&j&&(O=n(t,{errors:P,currentLocation:W,expectedLocation:m,distance:h}))<=b){if(b=O,(S=W)<=m)break;T=Math.max(1,2*m-S)}}if(n(t,{errors:P+1,currentLocation:m,expectedLocation:m,distance:h})>b)break;A=z}var $={isMatch:S>=0,score:0===O?.001:O};return y&&($.matchedIndices=o(M,d)),$}},function(e,t){e.exports=function(e,t){var r=t.errors,n=void 0===r?0:r,o=t.currentLocation,i=void 0===o?0:o,a=t.expectedLocation,s=void 0===a?0:a,c=t.distance,h=void 0===c?100:c,l=n/e.length,u=Math.abs(s-i);return h?l+u/h:u?1:l}},function(e,t){e.exports=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=[],n=-1,o=-1,i=0,a=e.length;i<a;i+=1){var s=e[i];s&&-1===n?n=i:s||-1===n||((o=i-1)-n+1>=t&&r.push([n,o]),n=-1)}return e[i-1]&&i-n>=t&&r.push([n,i-1]),r}},function(e,t){e.exports=function(e){for(var t={},r=e.length,n=0;n<r;n+=1)t[e.charAt(n)]=0;for(var o=0;o<r;o+=1)t[e.charAt(o)]|=1<<r-o-1;return t}},function(e,t){var r=function(e){return Array.isArray?Array.isArray(e):\"[object Array]\"===Object.prototype.toString.call(e)},n=function(e){return null==e?\"\":function(e){if(\"string\"==typeof e)return e;var t=e+\"\";return\"0\"==t&&1/e==-1/0?\"-0\":t}(e)},o=function(e){return\"string\"==typeof e},i=function(e){return\"number\"==typeof e};e.exports={get:function(e,t){var a=[];return function e(t,s){if(s){var c=s.indexOf(\".\"),h=s,l=null;-1!==c&&(h=s.slice(0,c),l=s.slice(c+1));var u=t[h];if(null!=u)if(l||!o(u)&&!i(u))if(r(u))for(var f=0,v=u.length;f<v;f+=1)e(u[f],l);else l&&e(u,l);else a.push(n(u))}else a.push(t)}(e,t),a},isArray:r,isString:o,isNum:i,toString:n}}])});","!function(){\"use strict\";function e(){}function t(t,n){var o,r,i,l,a=W;for(l=arguments.length;l-- >2;)S.push(arguments[l]);n&&null!=n.children&&(S.length||S.push(n.children),delete n.children);while(S.length)if((r=S.pop())&&void 0!==r.pop)for(l=r.length;l--;)S.push(r[l]);else\"boolean\"==typeof r&&(r=null),(i=\"function\"!=typeof t)&&(null==r?r=\"\":\"number\"==typeof r?r+=\"\":\"string\"!=typeof r&&(i=!1)),i&&o?a[a.length-1]+=r:a===W?a=[r]:a.push(r),o=i;var _=new e;return _.nodeName=t,_.children=a,_.attributes=null==n?void 0:n,_.key=null==n?void 0:n.key,void 0!==M.vnode&&M.vnode(_),_}function n(e,t){for(var n in t)e[n]=t[n];return e}function o(e){!e.__d&&(e.__d=!0)&&1==A.push(e)&&(M.debounceRendering||V)(r)}function r(){var e,t=A;A=[];while(e=t.pop())e.__d&&N(e)}function i(e,t,n){return\"string\"==typeof t||\"number\"==typeof t?void 0!==e.splitText:\"string\"==typeof t.nodeName?!e._componentConstructor&&l(e,t.nodeName):n||e._componentConstructor===t.nodeName}function l(e,t){return e.__n===t||e.nodeName.toLowerCase()===t.toLowerCase()}function a(e){var t=n({},e.attributes);t.children=e.children;var o=e.nodeName.defaultProps;if(void 0!==o)for(var r in o)void 0===t[r]&&(t[r]=o[r]);return t}function _(e,t){var n=t?document.createElementNS(\"http://www.w3.org/2000/svg\",e):document.createElement(e);return n.__n=e,n}function u(e){var t=e.parentNode;t&&t.removeChild(e)}function p(e,t,n,o,r){if(\"className\"===t&&(t=\"class\"),\"key\"===t);else if(\"ref\"===t)n&&n(null),o&&o(e);else if(\"class\"!==t||r)if(\"style\"===t){if(o&&\"string\"!=typeof o&&\"string\"!=typeof n||(e.style.cssText=o||\"\"),o&&\"object\"==typeof o){if(\"string\"!=typeof n)for(var i in n)i in o||(e.style[i]=\"\");for(var i in o)e.style[i]=\"number\"==typeof o[i]&&!1===P.test(i)?o[i]+\"px\":o[i]}}else if(\"html\"===t)o&&(e.innerHTML=o);else if(\"o\"==t[0]&&\"n\"==t[1]){var l=t!==(t=t.replace(/Capture$/,\"\"));t=t.toLowerCase().substring(2),o?n||e.addEventListener(t,s,l):e.removeEventListener(t,s,l),(e.__l||(e.__l={}))[t]=o}else if(\"list\"!==t&&\"type\"!==t&&!r&&t in e)c(e,t,null==o?\"\":o),null!=o&&!1!==o||e.removeAttribute(t);else{var a=r&&t!==(t=t.replace(/^xlink\\:?/,\"\"));null==o||!1===o?a?e.removeAttributeNS(\"http://www.w3.org/1999/xlink\",t.toLowerCase()):e.removeAttribute(t):\"function\"!=typeof o&&(a?e.setAttributeNS(\"http://www.w3.org/1999/xlink\",t.toLowerCase(),o):e.setAttribute(t,o))}else e.className=o||\"\"}function c(e,t,n){try{e[t]=n}catch(e){}}function s(e){return this.__l[e.type](M.event&&M.event(e)||e)}function f(){var e;while(e=E.pop())M.afterMount&&M.afterMount(e),e.on_mounted&&e.on_mounted()}function d(e,t,n,o,r,i){D++||(H=null!=r&&void 0!==r.ownerSVGElement,R=null!=e&&!(\"__hyperattr_\"in e));var l=h(e,t,n,o,i);return r&&l.parentNode!==r&&r.appendChild(l),--D||(R=!1,i||f()),l}function h(e,t,n,o,r){var i=e,a=H;if(null!=t&&\"boolean\"!=typeof t||(t=\"\"),\"string\"==typeof t||\"number\"==typeof t)return e&&void 0!==e.splitText&&e.parentNode&&(!e._component||r)?e.nodeValue!=t&&(e.nodeValue=t):(i=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(i,e),m(e,!0))),i.__hyperattr_=!0,i;var u=t.nodeName;if(\"function\"==typeof u)return k(e,t,n,o);if(H=\"svg\"===u||\"foreignObject\"!==u&&H,u+=\"\",(!e||!l(e,u))&&(i=_(u,H),e)){while(e.firstChild)i.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(i,e),m(e,!0)}var p=i.firstChild,c=i.__hyperattr_,s=t.children;if(null==c){c=i.__hyperattr_={};for(var f=i.attributes,d=f.length;d--;)c[f[d].name]=f[d].value}return!R&&s&&1===s.length&&\"string\"==typeof s[0]&&null!=p&&void 0!==p.splitText&&null==p.nextSibling?p.nodeValue!=s[0]&&(p.nodeValue=s[0]):(s&&s.length||null!=p)&&v(i,s,n,o,R||null!=c.html),y(i,t.attributes,c),H=a,i}function v(e,t,n,o,r){var l,a,_,p,c,s=e.childNodes,f=[],d={},v=0,b=0,y=s.length,g=0,w=t?t.length:0;if(0!==y)for(var C=0;C<y;C++){var x=s[C],N=x.__hyperattr_,k=w&&N?x._component?x._component.__k:N.key:null;null!=k?(v++,d[k]=x):(N||(void 0!==x.splitText?!r||x.nodeValue.trim():r))&&(f[g++]=x)}if(0!==w)for(var C=0;C<w;C++){p=t[C],c=null;var k=p.key;if(null!=k)v&&void 0!==d[k]&&(c=d[k],d[k]=void 0,v--);else if(!c&&b<g)for(l=b;l<g;l++)if(void 0!==f[l]&&i(a=f[l],p,r)){c=a,f[l]=void 0,l===g-1&&g--,l===b&&b++;break}c=h(c,p,n,o),_=s[C],c&&c!==e&&c!==_&&(null==_?e.appendChild(c):c===_.nextSibling?u(_):e.insertBefore(c,_))}if(v)for(var C in d)void 0!==d[C]&&m(d[C],!1);while(b<=g)void 0!==(c=f[g--])&&m(c,!1)}function m(e,t){var n=e._component;n?U(n):(null!=e.__hyperattr_&&e.__hyperattr_.ref&&e.__hyperattr_.ref(null),!1!==t&&null!=e.__hyperattr_||u(e),b(e))}function b(e){e=e.lastChild;while(e){var t=e.previousSibling;m(e,!0),e=t}}function y(e,t,n){var o;for(o in n)t&&null!=t[o]||null==n[o]||p(e,o,n[o],n[o]=void 0,H);for(o in t)\"children\"===o||\"innerHTML\"===o||o in n&&t[o]===(\"value\"===o||\"checked\"===o?e[o]:n[o])||p(e,o,n[o],n[o]=t[o],H)}function g(e){var t=e.constructor.name;(j[t]||(j[t]=[])).push(e)}function w(e,t,n){var o,r=j[e.name];if(e.prototype&&e.prototype.render?(o=new e(t,n),L.call(o,t,n)):(o=new L(t,n),o.constructor=e,o.render=C),r)for(var i=r.length;i--;)if(r[i].constructor===e){o.__b=r[i].__b,r.splice(i,1);break}return o}function C(e,t,n){return this.constructor(e,n)}function x(e,t,n,r,i){e.__x||(e.__x=!0,(e.__r=t.ref)&&delete t.ref,(e.__k=t.key)&&delete t.key,!e.base||i?e.on_mount&&e.on_mount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,r),r&&r!==e.context&&(e.__c||(e.__c=e.context),e.context=r),e.__p||(e.__p=e.props),e.props=t,e.__x=!1,0!==n&&(1!==n&&!1===M.syncComponentUpdates&&e.base?o(e):N(e,1,i)),e.__r&&e.__r(e))}function N(e,t,o,r){if(!e.__x){var i,l,_,u=e.props,p=e.state,c=e.context,s=e.__p||u,h=e.__s||p,v=e.__c||c,b=e.base,y=e.__b,g=b||y,C=e._component,k=!1;if(b&&(e.props=s,e.state=h,e.context=v,2!==t&&e.shouldComponentUpdate&&!1===e.shouldComponentUpdate(u,p,c)?k=!0:e.componentWillUpdate&&e.componentWillUpdate(u,p,c),e.props=u,e.state=p,e.context=c),e.__p=e.__s=e.__c=e.__b=null,e.__d=!1,!k){i=e.render(u,p,c),e.getChildContext&&(c=n(n({},c),e.getChildContext()));var L,T,S=i&&i.nodeName;if(\"function\"==typeof S){var W=a(i);l=C,l&&l.constructor===S&&W.key==l.__k?x(l,W,1,c,!1):(L=l,e._component=l=w(S,W,c),l.__b=l.__b||y,l.__u=e,x(l,W,0,c,!1),N(l,1,o,!0)),T=l.base}else _=g,L=C,L&&(_=e._component=null),(g||1===t)&&(_&&(_._component=null),T=d(_,i,c,o||!b,g&&g.parentNode,!0));if(g&&T!==g&&l!==C){var P=g.parentNode;P&&T!==P&&(P.replaceChild(T,g),L||(g._component=null,m(g,!1)))}if(L&&U(L),e.base=T,T&&!r){var V=e,A=e;while(A=A.__u)(V=A).base=T;T._component=V,T._componentConstructor=V.constructor}}if(!b||o?E.unshift(e):k||(e.on_updated&&e.on_updated(s,h,v),M.afterUpdate&&M.afterUpdate(e)),null!=e.__h)while(e.__h.length)e.__h.pop().call(e);D||r||f()}}function k(e,t,n,o){var r=e&&e._component,i=r,l=e,_=r&&e._componentConstructor===t.nodeName,u=_,p=a(t);while(r&&!u&&(r=r.__u))u=r.constructor===t.nodeName;return r&&u&&(!o||r._component)?(x(r,p,3,n,o),e=r.base):(i&&!_&&(U(i),e=l=null),r=w(t.nodeName,p,n),e&&!r.__b&&(r.__b=e,l=null),x(r,p,1,n,o),e=r.base,l&&e!==l&&(l._component=null,m(l,!1))),e}function U(e){M.beforeUnmount&&M.beforeUnmount(e);var t=e.base;e.__x=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?U(n):t&&(t.__hyperattr_&&t.__hyperattr_.ref&&t.__hyperattr_.ref(null),e.__b=t,u(t),g(e),b(t)),e.__r&&e.__r(null)}function L(e,t){this.__d=!0,this.context=t,this.props=e,this.state=this.state||{}}function T(e,t,n){return d(n,e,{},!1,t,!1)}var M={},S=[],W=[],P=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,V=\"function\"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout,A=[],E=[],D=0,H=!1,R=!1,j={};n(L.prototype,{set_state:function(e,t){var r=this.state;this.__s||(this.__s=n({},r)),n(r,\"function\"==typeof e?e(r,this.props):e),t&&(this.__h=this.__h||[]).push(t),o(this)},forceUpdate:function(e){e&&(this.__h=this.__h||[]).push(e),N(this,2)},render:function(){}});var I={h:t,Component:L,render:T};\"undefined\"!=typeof module?module.exports=I:self.hyper=I}();","frappe.socketio = {\n\topen_tasks: {},\n\topen_docs: [],\n\temit_queue: [],\n\tinit: function(port = 3000) {\n\t\tif (!window.io) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (frappe.boot.disable_async) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (frappe.socketio.socket) {\n\t\t\treturn;\n\t\t}\n\n\t\t//Enable secure option when using HTTPS\n\t\tif (window.location.protocol == \"https:\") {\n\t\t\tfrappe.socketio.socket = io.connect(frappe.socketio.get_host(port), {secure: true});\n\t\t}\n\t\telse if (window.location.protocol == \"http:\") {\n\t\t\tfrappe.socketio.socket = io.connect(frappe.socketio.get_host(port));\n\t\t}\n\t\telse if (window.location.protocol == \"file:\") {\n\t\t\tfrappe.socketio.socket = io.connect(window.localStorage.server);\n\t\t}\n\n\t\tif (!frappe.socketio.socket) {\n\t\t\tconsole.log(\"Unable to connect to \" + frappe.socketio.get_host(port));\n\t\t\treturn;\n\t\t}\n\n\t\tfrappe.socketio.socket.on('msgprint', function(message) {\n\t\t\tfrappe.msgprint(message);\n\t\t});\n\n\t\tfrappe.socketio.socket.on('eval_js', function(message) {\n\t\t\teval(message);\n\t\t});\n\n\t\tfrappe.socketio.socket.on('progress', function(data) {\n\t\t\tif(data.progress) {\n\t\t\t\tdata.percent = flt(data.progress[0]) / data.progress[1] * 100;\n\t\t\t}\n\t\t\tif(data.percent) {\n\t\t\t\tif(data.percent==100) {\n\t\t\t\t\tfrappe.hide_progress();\n\t\t\t\t} else {\n\t\t\t\t\tfrappe.show_progress(data.title || __(\"Progress\"), data.percent, 100, data.description);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tfrappe.socketio.setup_listeners();\n\t\tfrappe.socketio.setup_reconnect();\n\n\t\t$(document).on('form-load form-rename', function(e, frm) {\n\t\t\tif (frm.is_new()) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfor (var i=0, l=frappe.socketio.open_docs.length; i<l; i++) {\n\t\t\t\tvar d = frappe.socketio.open_docs[i];\n\t\t\t\tif (frm.doctype==d.doctype && frm.docname==d.name) {\n\t\t\t\t\t// already subscribed\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfrappe.socketio.doc_subscribe(frm.doctype, frm.docname);\n\t\t});\n\n\t\t$(document).on(\"form-refresh\", function(e, frm) {\n\t\t\tif (frm.is_new()) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfrappe.socketio.doc_open(frm.doctype, frm.docname);\n\t\t});\n\n\t\t$(document).on('form-unload', function(e, frm) {\n\t\t\tif (frm.is_new()) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// frappe.socketio.doc_unsubscribe(frm.doctype, frm.docname);\n\t\t\tfrappe.socketio.doc_close(frm.doctype, frm.docname);\n\t\t});\n\n\t\twindow.onbeforeunload = function() {\n\t\t\tif (!cur_frm || cur_frm.is_new()) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// if tab/window is closed, notify other users\n\t\t\tif (cur_frm.doc) {\n\t\t\t\tfrappe.socketio.doc_close(cur_frm.doctype, cur_frm.docname);\n\t\t\t}\n\t\t}\n\t},\n\tget_host: function(port = 3000) {\n\t\tvar host = window.location.origin;\n\t\tif(window.dev_server) {\n\t\t\tvar parts = host.split(\":\");\n\t\t\tport = frappe.boot.socketio_port || port.toString() || '3000';\n\t\t\tif(parts.length > 2) {\n\t\t\t\thost = parts[0] + \":\" + parts[1];\n\t\t\t}\n\t\t\thost = host + \":\" + port;\n\t\t}\n\t\treturn host;\n\t},\n\tsubscribe: function(task_id, opts) {\n\t\t// TODO DEPRECATE\n\n\t\tfrappe.socketio.socket.emit('task_subscribe', task_id);\n\t\tfrappe.socketio.socket.emit('progress_subscribe', task_id);\n\n\t\tfrappe.socketio.open_tasks[task_id] = opts;\n\t},\n\ttask_subscribe: function(task_id) {\n\t\tfrappe.socketio.socket.emit('task_subscribe', task_id);\n\t},\n\ttask_unsubscribe: function(task_id) {\n\t\tfrappe.socketio.socket.emit('task_unsubscribe', task_id);\n\t},\n\tdoc_subscribe: function(doctype, docname) {\n\t\tif (frappe.flags.doc_subscribe) {\n\t\t\tconsole.log('throttled');\n\t\t\treturn;\n\t\t}\n\n\t\tfrappe.flags.doc_subscribe = true;\n\n\t\t// throttle to 1 per sec\n\t\tsetTimeout(function() { frappe.flags.doc_subscribe = false }, 1000);\n\n\t\tfrappe.socketio.socket.emit('doc_subscribe', doctype, docname);\n\t\tfrappe.socketio.open_docs.push({doctype: doctype, docname: docname});\n\t},\n\tdoc_unsubscribe: function(doctype, docname) {\n\t\tfrappe.socketio.socket.emit('doc_unsubscribe', doctype, docname);\n\t\tfrappe.socketio.open_docs = $.filter(frappe.socketio.open_docs, function(d) {\n\t\t\tif(d.doctype===doctype && d.name===docname) {\n\t\t\t\treturn null;\n\t\t\t} else {\n\t\t\t\treturn d;\n\t\t\t}\n\t\t})\n\t},\n\tdoc_open: function(doctype, docname) {\n\t\t// notify that the user has opened this doc, if not already notified\n\t\tif(!frappe.socketio.last_doc\n\t\t\t|| (frappe.socketio.last_doc[0]!=doctype && frappe.socketio.last_doc[1]!=docname)) {\n\t\t\tfrappe.socketio.socket.emit('doc_open', doctype, docname);\n\t\t}\n\t\tfrappe.socketio.last_doc = [doctype, docname];\n\t},\n\tdoc_close: function(doctype, docname) {\n\t\t// notify that the user has closed this doc\n\t\tfrappe.socketio.socket.emit('doc_close', doctype, docname);\n\t},\n\n\tsetup_listeners: function() {\n\t\tfrappe.socketio.socket.on('task_status_change', function(data) {\n\t\t\tfrappe.socketio.process_response(data, data.status.toLowerCase());\n\t\t});\n\t\tfrappe.socketio.socket.on('task_progress', function(data) {\n\t\t\tfrappe.socketio.process_response(data, \"progress\");\n\t\t});\n\t},\n\tsetup_reconnect: function() {\n\t\t// subscribe again to open_tasks\n\t\tfrappe.socketio.socket.on(\"connect\", function() {\n\t\t\t// wait for 5 seconds before subscribing again\n\t\t\t// because it takes more time to start python server than nodejs server\n\t\t\t// and we use validation requests to python server for subscribing\n\t\t\tsetTimeout(function() {\n\t\t\t\t$.each(frappe.socketio.open_tasks, function(task_id, opts) {\n\t\t\t\t\tfrappe.socketio.subscribe(task_id, opts);\n\t\t\t\t});\n\n\t\t\t\t// re-connect open docs\n\t\t\t\t$.each(frappe.socketio.open_docs, function(d) {\n\t\t\t\t\tif(locals[d.doctype] && locals[d.doctype][d.name]) {\n\t\t\t\t\t\tfrappe.socketio.doc_subscribe(d.doctype, d.name);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (cur_frm && cur_frm.doc) {\n\t\t\t\t\tfrappe.socketio.doc_open(cur_frm.doc.doctype, cur_frm.doc.name);\n\t\t\t\t}\n\t\t\t}, 5000);\n\t\t});\n\t},\n\tprocess_response: function(data, method) {\n\t\tif(!data) {\n\t\t\treturn;\n\t\t}\n\n\t\t// success\n\t\tvar opts = frappe.socketio.open_tasks[data.task_id];\n\t\tif(opts[method]) {\n\t\t\topts[method](data);\n\t\t}\n\n\t\t// \"callback\" is std frappe term\n\t\tif(method===\"success\") {\n\t\t\tif(opts.callback) opts.callback(data);\n\t\t}\n\n\t\t// always\n\t\tfrappe.request.cleanup(opts, data);\n\t\tif(opts.always) {\n\t\t\topts.always(data);\n\t\t}\n\n\t\t// error\n\t\tif(data.status_code && data.status_code > 400 && opts.error) {\n\t\t\topts.error(data);\n\t\t}\n\t}\n}\n\nfrappe.provide(\"frappe.realtime\");\nfrappe.realtime.on = function(event, callback) {\n\tfrappe.socketio.socket && frappe.socketio.socket.on(event, callback);\n};\n\nfrappe.realtime.off = function(event, callback) {\n\tfrappe.socketio.socket && frappe.socketio.socket.off(event, callback);\n}\n\nfrappe.realtime.publish = function(event, message) {\n\tif(frappe.socketio.socket) {\n\t\tfrappe.socketio.socket.emit(event, message);\n\t}\n}\n\n","// Copyright (c) 2015, Frappe Technologies Pvt. Ltd. and Contributors\n// MIT License. See license.txt\n\n/*\n\nInheritence \"Class\"\n-------------------\nsee: http://ejohn.org/blog/simple-javascript-inheritance/\nTo subclass, use:\n\n\tvar MyClass = Class.extend({\n\t\tinit: function\n\t})\n\n*/\n// https://stackoverflow.com/a/15052240/5353542\n\n/* Simple JavaScript Inheritance for ES 5.1\n * based on http://ejohn.org/blog/simple-javascript-inheritance/\n *  (inspired by base2 and Prototype)\n * MIT Licensed.\n */\n(function(global) {\n\t\"use strict\";\n\tvar fnTest = /xyz/.test(function(){xyz;}) ? /\\b_super\\b/ : /.*/;\n\n\t// The base Class implementation (does nothing)\n\tfunction Class(){}\n\n\t// Create a new Class that inherits from this class\n\tClass.extend = function(props) {\n\t  var _super = this.prototype;\n\n\t  // Set up the prototype to inherit from the base class\n\t  // (but without running the init constructor)\n\t  var proto = Object.create(_super);\n\n\t  // Copy the properties over onto the new prototype\n\t  for (var name in props) {\n\t\t// Check if we're overwriting an existing function\n\t\tproto[name] = typeof props[name] === \"function\" &&\n\t\t  typeof _super[name] == \"function\" && fnTest.test(props[name])\n\t\t  ? (function(name, fn){\n\t\t\t  return function() {\n\t\t\t\tvar tmp = this._super;\n\n\t\t\t\t// Add a new ._super() method that is the same method\n\t\t\t\t// but on the super-class\n\t\t\t\tthis._super = _super[name];\n\n\t\t\t\t// The method only need to be bound temporarily, so we\n\t\t\t\t// remove it when we're done executing\n\t\t\t\tvar ret = fn.apply(this, arguments);\n\t\t\t\tthis._super = tmp;\n\n\t\t\t\treturn ret;\n\t\t\t  };\n\t\t\t})(name, props[name])\n\t\t  : props[name];\n\t  }\n\n\t  // The new constructor\n\t  var newClass = typeof proto.init === \"function\"\n\t\t? proto.hasOwnProperty(\"init\")\n\t\t  ? proto.init // All construction is actually done in the init method\n\t\t  : function SubClass(){ _super.init.apply(this, arguments); }\n\t\t: function EmptyClass(){};\n\n\t  // Populate our constructed prototype object\n\t  newClass.prototype = proto;\n\n\t  // Enforce the constructor to be what we expect\n\t  proto.constructor = newClass;\n\n\t  // And make this class extendable\n\t  newClass.extend = Class.extend;\n\n\t  return newClass;\n\t};\n\n\t// export\n\tglobal.Class = Class;\n  })(this);","import '../class';\n\nfrappe.ui.form.Layout = Class.extend({\n\tinit: function(opts) {\n\t\tthis.views = {};\n\t\tthis.pages = [];\n\t\tthis.sections = [];\n\t\tthis.fields_list = [];\n\t\tthis.fields_dict = {};\n\n\t\t$.extend(this, opts);\n\t},\n\tmake: function() {\n\t\tif(!this.parent && this.body) {\n\t\t\tthis.parent = this.body;\n\t\t}\n\t\tthis.wrapper = $('<div class=\"form-layout\">').appendTo(this.parent);\n\t\tthis.message = $('<div class=\"form-message text-muted small hidden\"></div>').appendTo(this.wrapper);\n\t\tif(!this.fields) {\n\t\t\tthis.fields = this.get_doctype_fields();\n\t\t}\n\t\tthis.setup_tabbing();\n\t\tthis.render();\n\t},\n\tshow_empty_form_message: function() {\n\t\tif(!(this.wrapper.find(\".frappe-control:visible\").length || this.wrapper.find(\".section-head.collapsed\").length)) {\n\t\t\tthis.show_message(__(\"This form does not have any input\"));\n\t\t}\n\t},\n\tget_doctype_fields: function() {\n\t\tlet fields = [\n\t\t\t{\n\t\t\t\tparent: this.frm.doctype,\n\t\t\t\tfieldtype: 'Data',\n\t\t\t\tfieldname: '__newname',\n\t\t\t\treqd: 1,\n\t\t\t\thidden: 1,\n\t\t\t\tlabel: __('Name'),\n\t\t\t\tget_status: function(field) {\n\t\t\t\t\tif (field.frm && field.frm.is_new()\n\t\t\t\t\t\t&& field.frm.meta.autoname\n\t\t\t\t\t\t&& ['prompt', 'name'].includes(field.frm.meta.autoname.toLowerCase())) {\n\t\t\t\t\t\treturn 'Write';\n\t\t\t\t\t}\n\t\t\t\t\treturn 'None';\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t\tfields = fields.concat(frappe.meta.sort_docfields(frappe.meta.docfield_map[this.doctype]));\n\t\treturn fields;\n\t},\n\tshow_message: function(html, color) {\n\t\tif (this.message_color) {\n\t\t\t// remove previous color\n\t\t\tthis.message.removeClass(this.message_color);\n\t\t}\n\t\tthis.message_color = (color && ['yellow', 'blue'].includes(color)) ? color : 'blue';\n\t\tif(html) {\n\t\t\tif(html.substr(0, 1)!=='<') {\n\t\t\t\t// wrap in a block\n\t\t\t\thtml = '<div>' + html + '</div>';\n\t\t\t}\n\t\t\tthis.message.removeClass('hidden').addClass(this.message_color);\n\t\t\t$(html).appendTo(this.message);\n\t\t} else {\n\t\t\tthis.message.empty().addClass('hidden');\n\t\t}\n\t},\n\trender: function(new_fields) {\n\t\tvar me = this;\n\t\tvar fields = new_fields || this.fields;\n\n\t\tthis.section = null;\n\t\tthis.column = null;\n\n\t\tif (this.with_dashboard) {\n\t\t\tthis.setup_dashboard_section();\n\t\t}\n\n\t\tif (this.no_opening_section()) {\n\t\t\tthis.make_section();\n\t\t}\n\t\t$.each(fields, function(i, df) {\n\t\t\tswitch(df.fieldtype) {\n\t\t\t\tcase \"Fold\":\n\t\t\t\t\tme.make_page(df);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"Section Break\":\n\t\t\t\t\tme.make_section(df);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"Column Break\":\n\t\t\t\t\tme.make_column(df);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tme.make_field(df);\n\t\t\t}\n\t\t});\n\n\t},\n\n\tno_opening_section: function() {\n\t\treturn (this.fields[0] && this.fields[0].fieldtype!=\"Section Break\") || !this.fields.length;\n\t},\n\n\tsetup_dashboard_section: function() {\n\t\tif (this.no_opening_section()) {\n\t\t\tthis.fields.unshift({fieldtype: 'Section Break'});\n\t\t}\n\n\t\tthis.fields.unshift({\n\t\t\tfieldtype: 'Section Break',\n\t\t\tfieldname: '_form_dashboard',\n\t\t\tlabel: __('Dashboard'),\n\t\t\tcssClass: 'form-dashboard',\n\t\t\tcollapsible: 1,\n\t\t\t// hidden: 1\n\t\t});\n\t},\n\n\treplace_field: function(fieldname, df, render) {\n\t\tdf.fieldname = fieldname; // change of fieldname is avoided\n\t\tif (this.fields_dict[fieldname] && this.fields_dict[fieldname].df) {\n\t\t\tconst fieldobj = this.init_field(df, render);\n\t\t\tthis.fields_dict[fieldname].$wrapper.remove();\n\t\t\tthis.fields_list.splice(this.fields_dict[fieldname], 1, fieldobj);\n\t\t\tthis.fields_dict[fieldname] = fieldobj;\n\t\t\tif (this.frm) {\n\t\t\t\tfieldobj.perm = this.frm.perm;\n\t\t\t}\n\t\t\tthis.section.fields_list.splice(this.section.fields_dict[fieldname], 1, fieldobj);\n\t\t\tthis.section.fields_dict[fieldname] = fieldobj;\n\t\t\tthis.refresh_fields([df]);\n\t\t}\n\t},\n\n\tmake_field: function(df, colspan, render) {\n\t\t!this.section && this.make_section();\n\t\t!this.column && this.make_column();\n\n\t\tconst fieldobj = this.init_field(df, render);\n\t\tthis.fields_list.push(fieldobj);\n\t\tthis.fields_dict[df.fieldname] = fieldobj;\n\t\tif(this.frm) {\n\t\t\tfieldobj.perm = this.frm.perm;\n\t\t}\n\n\t\tthis.section.fields_list.push(fieldobj);\n\t\tthis.section.fields_dict[df.fieldname] = fieldobj;\n\t\tfieldobj.section = this.section;\n\t},\n\n\tinit_field: function(df, render = false) {\n\t\tconst fieldobj = frappe.ui.form.make_control({\n\t\t\tdf: df,\n\t\t\tdoctype: this.doctype,\n\t\t\tparent: this.column.wrapper.get(0),\n\t\t\tfrm: this.frm,\n\t\t\trender_input: render,\n\t\t\tdoc: this.doc\n\t\t});\n\n\t\tfieldobj.layout = this;\n\t\treturn fieldobj;\n\t},\n\n\tmake_page: function(df) {\n\t\tvar me = this,\n\t\t\thead = $('<div class=\"form-clickable-section text-center\">\\\n\t\t\t\t<a class=\"btn-fold h6 text-muted\">'+__(\"Show more details\")+'</a>\\\n\t\t\t</div>').appendTo(this.wrapper);\n\n\t\tthis.page = $('<div class=\"form-page second-page hide\"></div>').appendTo(this.wrapper);\n\n\t\tthis.fold_btn = head.find(\".btn-fold\").on(\"click\", function() {\n\t\t\tvar page = $(this).parent().next();\n\t\t\tif(page.hasClass(\"hide\")) {\n\t\t\t\t$(this).removeClass(\"btn-fold\").html(__(\"Hide details\"));\n\t\t\t\tpage.removeClass(\"hide\");\n\t\t\t\tfrappe.utils.scroll_to($(this), true, 30);\n\t\t\t\tme.folded = false;\n\t\t\t} else {\n\t\t\t\t$(this).addClass(\"btn-fold\").html(__(\"Show more details\"));\n\t\t\t\tpage.addClass(\"hide\");\n\t\t\t\tme.folded = true;\n\t\t\t}\n\t\t});\n\n\t\tthis.section = null;\n\t\tthis.folded = true;\n\t},\n\n\tunfold: function() {\n\t\tthis.fold_btn.trigger('click');\n\t},\n\n\tmake_section: function(df) {\n\t\tthis.section = new frappe.ui.form.Section(this, df);\n\n\t\t// append to layout fields\n\t\tif(df) {\n\t\t\tthis.fields_dict[df.fieldname] = this.section;\n\t\t\tthis.fields_list.push(this.section);\n\t\t}\n\n\t\tthis.column = null;\n\t},\n\n\tmake_column: function(df) {\n\t\tthis.column = new frappe.ui.form.Column(this.section, df);\n\t\tif(df && df.fieldname) {\n\t\t\tthis.fields_list.push(this.column);\n\t\t}\n\t},\n\n\trefresh: function(doc) {\n\t\tvar me = this;\n\t\tif(doc) this.doc = doc;\n\n\t\tif (this.frm) {\n\t\t\tthis.wrapper.find(\".empty-form-alert\").remove();\n\t\t}\n\n\t\t// NOTE this might seem redundant at first, but it needs to be executed when frm.refresh_fields is called\n\t\tme.attach_doc_and_docfields(true);\n\n\t\tif(this.frm && this.frm.wrapper) {\n\t\t\t$(this.frm.wrapper).trigger(\"refresh-fields\");\n\t\t}\n\n\t\t// dependent fields\n\t\tthis.refresh_dependency();\n\n\t\t// refresh sections\n\t\tthis.refresh_sections();\n\n\t\t// collapse sections\n\t\tif(this.frm) {\n\t\t\tthis.refresh_section_collapse();\n\t\t}\n\t},\n\n\trefresh_sections: function() {\n\t\tvar cnt = 0;\n\n\t\t// hide invisible sections and set alternate background color\n\t\tthis.wrapper.find(\".form-section:not(.hide-control)\").each(function() {\n\t\t\tvar $this = $(this).removeClass(\"empty-section\")\n\t\t\t\t.removeClass(\"visible-section\")\n\t\t\t\t.removeClass(\"shaded-section\");\n\t\t\tif(!$this.find(\".frappe-control:not(.hide-control)\").length\n\t\t\t\t&& !$this.hasClass('form-dashboard')) {\n\t\t\t\t// nothing visible, hide the section\n\t\t\t\t$this.addClass(\"empty-section\");\n\t\t\t} else {\n\t\t\t\t$this.addClass(\"visible-section\");\n\t\t\t\tif(cnt % 2) {\n\t\t\t\t\t$this.addClass(\"shaded-section\");\n\t\t\t\t}\n\t\t\t\tcnt++;\n\t\t\t}\n\t\t});\n\t},\n\n\trefresh_fields: function(fields) {\n\t\tlet fieldnames = fields.map((field) => {\n\t\t\tif(field.fieldname) return field.fieldname;\n\t\t});\n\n\t\tthis.fields_list.map(fieldobj => {\n\t\t\tif(fieldnames.includes(fieldobj.df.fieldname)) {\n\t\t\t\tfieldobj.refresh();\n\t\t\t\tif(fieldobj.df[\"default\"]) {\n\t\t\t\t\tfieldobj.set_input(fieldobj.df[\"default\"]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\n\tadd_fields: function(fields) {\n\t\tthis.render(fields);\n\t\tthis.refresh_fields(fields);\n\t},\n\n\trefresh_section_collapse: function() {\n\t\tif(!this.doc) return;\n\n\t\tfor(var i=0; i<this.sections.length; i++) {\n\t\t\tvar section = this.sections[i];\n\t\t\tvar df = section.df;\n\t\t\tif(df && df.collapsible) {\n\t\t\t\tvar collapse = true;\n\n\t\t\t\tif(df.collapsible_depends_on) {\n\t\t\t\t\tcollapse = !this.evaluate_depends_on_value(df.collapsible_depends_on);\n\t\t\t\t}\n\n\t\t\t\tif (collapse && section.has_missing_mandatory()) {\n\t\t\t\t\tcollapse = false;\n\t\t\t\t}\n\n\t\t\t\tif(df.fieldname === '_form_dashboard') {\n\t\t\t\t\tcollapse = localStorage.getItem('collapseFormDashboard')==='yes' ? true : false;\n\t\t\t\t}\n\n\t\t\t\tsection.collapse(collapse);\n\t\t\t}\n\t\t}\n\t},\n\n\tattach_doc_and_docfields: function(refresh) {\n\t\tvar me = this;\n\t\tfor(var i=0, l=this.fields_list.length; i<l; i++) {\n\t\t\tvar fieldobj = this.fields_list[i];\n\t\t\tif(me.doc) {\n\t\t\t\tfieldobj.doc = me.doc;\n\t\t\t\tfieldobj.doctype = me.doc.doctype;\n\t\t\t\tfieldobj.docname = me.doc.name;\n\t\t\t\tfieldobj.df = frappe.meta.get_docfield(me.doc.doctype,\n\t\t\t\t\tfieldobj.df.fieldname, me.frm ? me.frm.doc.name : me.doc.name) || fieldobj.df;\n\n\t\t\t\t// on form change, permissions can change\n\t\t\t\tif(me.frm) {\n\t\t\t\t\tfieldobj.perm = me.frm.perm;\n\t\t\t\t}\n\t\t\t}\n\t\t\trefresh && fieldobj.df && fieldobj.refresh && fieldobj.refresh();\n\t\t}\n\t},\n\n\trefresh_section_count: function() {\n\t\tthis.wrapper.find(\".section-count-label:visible\").each(function(i) {\n\t\t\t$(this).html(i+1);\n\t\t});\n\t},\n\tsetup_tabbing: function() {\n\t\tvar me = this;\n\t\tthis.wrapper.on(\"keydown\", function(ev) {\n\t\t\tif(ev.which==9) {\n\t\t\t\tvar current = $(ev.target),\n\t\t\t\t\tdoctype = current.attr(\"data-doctype\"),\n\t\t\t\t\tfieldname = current.attr(\"data-fieldname\");\n\t\t\t\tif(doctype)\n\t\t\t\t\treturn me.handle_tab(doctype, fieldname, ev.shiftKey);\n\t\t\t}\n\t\t});\n\t},\n\thandle_tab: function(doctype, fieldname, shift) {\n\t\tvar me = this,\n\t\t\tgrid_row = null,\n\t\t\tprev = null,\n\t\t\tfields = me.fields_list,\n\t\t\tin_grid = false,\n\t\t\tfocused = false;\n\n\t\t// in grid\n\t\tif(doctype != me.doctype) {\n\t\t\tgrid_row = me.get_open_grid_row();\n\t\t\tif(!grid_row || !grid_row.layout) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tfields = grid_row.layout.fields_list;\n\t\t}\n\n\t\tfor(var i=0, len=fields.length; i < len; i++) {\n\t\t\tif(fields[i].df.fieldname==fieldname) {\n\t\t\t\tif(shift) {\n\t\t\t\t\tif(prev) {\n\t\t\t\t\t\tthis.set_focus(prev);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$(this.primary_button).focus();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif(i < len-1) {\n\t\t\t\t\tfocused = me.focus_on_next_field(i, fields);\n\t\t\t\t}\n\n\t\t\t\tif (focused) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(this.is_visible(fields[i]))\n\t\t\t\tprev = fields[i];\n\t\t}\n\n\t\tif (!focused) {\n\t\t\t// last field in this group\n\t\t\tif(grid_row) {\n\t\t\t\t// in grid\n\t\t\t\tif(grid_row.doc.idx==grid_row.grid.grid_rows.length) {\n\t\t\t\t\t// last row, close it and find next field\n\t\t\t\t\tgrid_row.toggle_view(false, function() {\n\t\t\t\t\t\tgrid_row.grid.frm.layout.handle_tab(grid_row.grid.df.parent, grid_row.grid.df.fieldname);\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t// next row\n\t\t\t\t\tgrid_row.grid.grid_rows[grid_row.doc.idx].toggle_view(true);\n\t\t\t\t}\n\t\t\t} else if (!shift) {\n\t\t\t\t// End of tab navigation\n\t\t\t\t$(this.primary_button).focus();\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t},\n\tfocus_on_next_field: function(start_idx, fields) {\n\t\t// loop to find next eligible fields\n\t\tfor(var i= start_idx + 1, len = fields.length; i < len; i++) {\n\t\t\tvar field = fields[i];\n\t\t\tif(this.is_visible(field)) {\n\t\t\t\tif(field.df.fieldtype===\"Table\") {\n\t\t\t\t\t// open table grid\n\t\t\t\t\tif(!(field.grid.grid_rows && field.grid.grid_rows.length)) {\n\t\t\t\t\t\t// empty grid, add a new row\n\t\t\t\t\t\tfield.grid.add_new_row();\n\t\t\t\t\t}\n\t\t\t\t\t// show grid row (if exists)\n\t\t\t\t\tfield.grid.grid_rows[0].show_form();\n\t\t\t\t\treturn true;\n\n\t\t\t\t} else if(!in_list(frappe.model.no_value_type, field.df.fieldtype)) {\n\t\t\t\t\tthis.set_focus(field);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\tis_visible: function(field) {\n\t\treturn field.disp_status===\"Write\" && (field.$wrapper && field.$wrapper.is(\":visible\"));\n\t},\n\tset_focus: function(field) {\n\t\t// next is table, show the table\n\t\tif(field.df.fieldtype==\"Table\") {\n\t\t\tif(!field.grid.grid_rows.length) {\n\t\t\t\tfield.grid.add_new_row(1);\n\t\t\t} else {\n\t\t\t\tfield.grid.grid_rows[0].toggle_view(true);\n\t\t\t}\n\t\t} else if(field.editor) {\n\t\t\tfield.editor.set_focus();\n\t\t} else if(field.$input) {\n\t\t\tfield.$input.focus();\n\t\t}\n\t},\n\tget_open_grid_row: function() {\n\t\treturn $(\".grid-row-open\").data(\"grid_row\");\n\t},\n\trefresh_dependency: function() {\n\t\t// Resolve \"depends_on\" and show / hide accordingly\n\t\tvar me = this;\n\n\t\t// build dependants' dictionary\n\t\tvar has_dep = false;\n\n\t\tfor(var fkey in this.fields_list) {\n\t\t\tvar f = this.fields_list[fkey];\n\t\t\tf.dependencies_clear = true;\n\t\t\tif(f.df.depends_on) {\n\t\t\t\thas_dep = true;\n\t\t\t}\n\t\t}\n\n\t\tif(!has_dep)return;\n\n\t\t// show / hide based on values\n\t\tfor(var i=me.fields_list.length-1;i>=0;i--) {\n\t\t\tvar f = me.fields_list[i];\n\t\t\tf.guardian_has_value = true;\n\t\t\tif(f.df.depends_on) {\n\t\t\t\t// evaluate guardian\n\n\t\t\t\tf.guardian_has_value = this.evaluate_depends_on_value(f.df.depends_on);\n\n\t\t\t\t// show / hide\n\t\t\t\tif(f.guardian_has_value) {\n\t\t\t\t\tif(f.df.hidden_due_to_dependency) {\n\t\t\t\t\t\tf.df.hidden_due_to_dependency = false;\n\t\t\t\t\t\tf.refresh();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif(!f.df.hidden_due_to_dependency) {\n\t\t\t\t\t\tf.df.hidden_due_to_dependency = true;\n\t\t\t\t\t\tf.refresh();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.refresh_section_count();\n\t},\n\tevaluate_depends_on_value: function(expression) {\n\t\tvar out = null;\n\t\tvar doc = this.doc;\n\n\t\tif (!doc && this.get_values) {\n\t\t\tvar doc = this.get_values(true);\n\t\t}\n\n\t\tif (!doc) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar parent = this.frm ? this.frm.doc : this.doc || null;\n\n\t\tif(typeof(expression) === 'boolean') {\n\t\t\tout = expression;\n\n\t\t} else if(typeof(expression) === 'function') {\n\t\t\tout = expression(doc);\n\n\t\t} else if(expression.substr(0,5)=='eval:') {\n\t\t\ttry {\n\t\t\t\tout = eval(expression.substr(5));\n\t\t\t\tif(parent && parent.istable && expression.includes('is_submittable')) {\n\t\t\t\t\tout = true;\n\t\t\t\t}\n\t\t\t} catch(e) {\n\t\t\t\tfrappe.throw(__('Invalid \"depends_on\" expression'));\n\t\t\t}\n\n\t\t} else if(expression.substr(0,3)=='fn:' && this.frm) {\n\t\t\tout = this.frm.script_manager.trigger(expression.substr(3), this.doctype, this.docname);\n\t\t} else {\n\t\t\tvar value = doc[expression];\n\t\t\tif($.isArray(value)) {\n\t\t\t\tout = !!value.length;\n\t\t\t} else {\n\t\t\t\tout = !!value;\n\t\t\t}\n\t\t}\n\n\t\treturn out;\n\t}\n});\n\nfrappe.ui.form.Section = Class.extend({\n\tinit: function(layout, df) {\n\t\tvar me = this;\n\t\tthis.layout = layout;\n\t\tthis.df = df || {};\n\t\tthis.fields_list = [];\n\t\tthis.fields_dict = {};\n\n\t\tthis.make();\n\t\t// if(this.frm)\n\t\t// \tthis.section.body.css({\"padding\":\"0px 3%\"})\n\t\tthis.row = {\n\t\t\twrapper: this.wrapper\n\t\t};\n\n\t\tif (this.df.collapsible && this.df.fieldname !== '_form_dashboard') {\n\t\t\tthis.collapse(true);\n\t\t}\n\n\t\tthis.refresh();\n\t},\n\tmake: function() {\n\t\tif(!this.layout.page) {\n\t\t\tthis.layout.page = $('<div class=\"form-page\"></div>').appendTo(this.layout.wrapper);\n\t\t}\n\n\t\tthis.wrapper = $('<div class=\"row form-section\">')\n\t\t\t.appendTo(this.layout.page);\n\t\tthis.layout.sections.push(this);\n\n\t\tif(this.df) {\n\t\t\tif(this.df.label) {\n\t\t\t\tthis.make_head();\n\t\t\t}\n\t\t\tif(this.df.description) {\n\t\t\t\t$('<div class=\"col-sm-12 small text-muted form-section-description\">' + __(this.df.description) + '</div>')\n\t\t\t\t\t.appendTo(this.wrapper);\n\t\t\t}\n\t\t\tif(this.df.cssClass) {\n\t\t\t\tthis.wrapper.addClass(this.df.cssClass);\n\t\t\t}\n\t\t}\n\n\n\t\t// for bc\n\t\tthis.body = $('<div class=\"section-body\">').appendTo(this.wrapper);\n\t},\n\tmake_head: function() {\n\t\tvar me = this;\n\t\tif(!this.df.collapsible) {\n\t\t\t$('<div class=\"col-sm-12\"><h6 class=\"form-section-heading uppercase\">'\n\t\t\t\t+ __(this.df.label) + '</h6></div>')\n\t\t\t\t.appendTo(this.wrapper);\n\t\t} else {\n\t\t\tthis.head = $('<div class=\"section-head\"><a class=\"h6 uppercase\">'\n\t\t\t\t+__(this.df.label)+'</a><span class=\"octicon octicon-chevron-down collapse-indicator\"></span></div>').appendTo(this.wrapper);\n\n\t\t\t// show / hide based on status\n\t\t\tthis.collapse_link = this.head.on(\"click\", function() {\n\t\t\t\tme.collapse();\n\t\t\t});\n\n\t\t\tthis.indicator = this.head.find(\".collapse-indicator\");\n\t\t}\n\t},\n\trefresh: function() {\n\t\tif(!this.df)\n\t\t\treturn;\n\n\t\t// hide if explictly hidden\n\t\tvar hide = this.df.hidden || this.df.hidden_due_to_dependency;\n\n\t\t// hide if no perm\n\t\tif(!hide && this.layout && this.layout.frm && !this.layout.frm.get_perm(this.df.permlevel || 0, \"read\")) {\n\t\t\thide = true;\n\t\t}\n\n\t\tthis.wrapper.toggleClass(\"hide-control\", !!hide);\n\t},\n\tcollapse: function(hide) {\n\t\t// unknown edge case\n\t\tif (!(this.head && this.body)) {\n\t\t\treturn;\n\t\t}\n\n\t\tif(hide===undefined) {\n\t\t\thide = !this.body.hasClass(\"hide\");\n\t\t}\n\n\t\tif (this.df.fieldname==='_form_dashboard') {\n\t\t\tlocalStorage.setItem('collapseFormDashboard', hide ? 'yes' : 'no');\n\t\t}\n\n\t\tthis.body.toggleClass(\"hide\", hide);\n\t\tthis.head.toggleClass(\"collapsed\", hide);\n\t\tthis.indicator.toggleClass(\"octicon-chevron-down\", hide);\n\t\tthis.indicator.toggleClass(\"octicon-chevron-up\", !hide);\n\n\t\t// refresh signature fields\n\t\tthis.fields_list.forEach((f) => {\n\t\t\tif (f.df.fieldtype=='Signature') {\n\t\t\t\tf.refresh();\n\t\t\t}\n\t\t});\n\t},\n\tis_collapsed() {\n\t\treturn this.body.hasClass('hide');\n\t},\n\thas_missing_mandatory: function() {\n\t\tvar missing_mandatory = false;\n\t\tfor (var j=0, l=this.fields_list.length; j < l; j++) {\n\t\t\tvar section_df = this.fields_list[j].df;\n\t\t\tif (section_df.reqd && this.layout.doc[section_df.fieldname]==null) {\n\t\t\t\tmissing_mandatory = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn missing_mandatory;\n\t}\n});\n\nfrappe.ui.form.Column = Class.extend({\n\tinit: function(section, df) {\n\t\tif(!df) df = {};\n\n\t\tthis.df = df;\n\t\tthis.section = section;\n\t\tthis.make();\n\t\tthis.resize_all_columns();\n\t},\n\tmake: function() {\n\t\tthis.wrapper = $('<div class=\"form-column\">\\\n\t\t\t<form>\\\n\t\t\t</form>\\\n\t\t</div>').appendTo(this.section.body)\n\t\t\t.find(\"form\")\n\t\t\t.on(\"submit\", function() {\n\t\t\t\treturn false;\n\t\t\t});\n\n\t\tif (this.df.label) {\n\t\t\t$('<label class=\"control-label\">' + __(this.df.label)\n\t\t\t\t+ '</label>').appendTo(this.wrapper);\n\t\t}\n\t},\n\tresize_all_columns: function() {\n\t\t// distribute all columns equally\n\t\tvar colspan = cint(12 / this.section.wrapper.find(\".form-column\").length);\n\n\t\tthis.section.wrapper.find(\".form-column\").removeClass()\n\t\t\t.addClass(\"form-column\")\n\t\t\t.addClass(\"col-sm-\" + colspan);\n\n\t},\n\trefresh: function() {\n\t\tthis.section.refresh();\n\t}\n});\n","import '../form/layout';\n\nfrappe.provide('frappe.ui');\n\nfrappe.ui.FieldGroup = frappe.ui.form.Layout.extend({\n\tinit: function(opts) {\n\t\t$.extend(this, opts);\n\t\tthis.dirty = false;\n\t\tthis._super();\n\t\t$.each(this.fields || [], function(i, f) {\n\t\t\tif(!f.fieldname && f.label) {\n\t\t\t\tf.fieldname = f.label.replace(/ /g, \"_\").toLowerCase();\n\t\t\t}\n\t\t})\n\t\tif(this.values) {\n\t\t\tthis.set_values(this.values);\n\t\t}\n\t},\n\tmake: function() {\n\t\tvar me = this;\n\t\tif(this.fields) {\n\t\t\tthis._super();\n\t\t\tthis.refresh();\n\t\t\t// set default\n\t\t\t$.each(this.fields_list, function(i, field) {\n\t\t\t\tif (field.df[\"default\"]) {\n\t\t\t\t\tlet def_value = field.df[\"default\"];\n\n\t\t\t\t\tif (def_value == 'Today' && field.df[\"fieldtype\"] == 'Date') {\n\t\t\t\t\t\tdef_value = frappe.datetime.get_today();\n\t\t\t\t\t}\n\n\t\t\t\t\tfield.set_input(def_value);\n\t\t\t\t\t// if default and has depends_on, render its fields.\n\t\t\t\t\tme.refresh_dependency();\n\t\t\t\t}\n\t\t\t})\n\n\t\t\tif(!this.no_submit_on_enter) {\n\t\t\t\tthis.catch_enter_as_submit();\n\t\t\t}\n\n\t\t\t$(this.wrapper).find('input, select').on('change', () => {\n\t\t\t\tthis.dirty = true;\n\n\t\t\t\tfrappe.run_serially([\n\t\t\t\t\t() => frappe.timeout(0.1),\n\t\t\t\t\t() => me.refresh_dependency()\n\t\t\t\t]);\n\t\t\t});\n\n\t\t}\n\t},\n\tfirst_button: false,\n\tfocus_on_first_input: function() {\n\t\tif(this.no_focus) return;\n\t\t$.each(this.fields_list, function(i, f) {\n\t\t\tif(!in_list(['Date', 'Datetime', 'Time', 'Check'], f.df.fieldtype) && f.set_focus) {\n\t\t\t\tf.set_focus();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t},\n\tcatch_enter_as_submit: function() {\n\t\tvar me = this;\n\t\t$(this.body).find('input[type=\"text\"], input[type=\"password\"], select').keypress(function(e) {\n\t\t\tif(e.which==13) {\n\t\t\t\tif(me.has_primary_action) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tme.get_primary_btn().trigger(\"click\");\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\tget_input: function(fieldname) {\n\t\tvar field = this.fields_dict[fieldname];\n\t\treturn $(field.txt ? field.txt : field.input);\n\t},\n\tget_field: function(fieldname) {\n\t\treturn this.fields_dict[fieldname];\n\t},\n\tget_values: function(ignore_errors) {\n\t\tvar ret = {};\n\t\tvar errors = [];\n\t\tfor(var key in this.fields_dict) {\n\t\t\tvar f = this.fields_dict[key];\n\t\t\tif(f.get_value) {\n\t\t\t\tvar v = f.get_value();\n\t\t\t\tif(f.df.reqd && is_null(v))\n\t\t\t\t\terrors.push(__(f.df.label));\n\n\t\t\t\tif(!is_null(v)) ret[f.df.fieldname] = v;\n\t\t\t}\n\t\t}\n\t\tif(errors.length && !ignore_errors) {\n\t\t\tfrappe.msgprint({\n\t\t\t\ttitle: __('Missing Values Required'),\n\t\t\t\tmessage: __('Following fields have missing values:') +\n\t\t\t\t\t'<br><br><ul><li>' + errors.join('<li>') + '</ul>',\n\t\t\t\tindicator: 'orange'\n\t\t\t});\n\t\t\treturn null;\n\t\t}\n\t\treturn ret;\n\t},\n\tget_value: function(key) {\n\t\tvar f = this.fields_dict[key];\n\t\treturn f && (f.get_value ? f.get_value() : null);\n\t},\n\tset_value: function(key, val){\n\t\treturn new Promise(resolve => {\n\t\t\tvar f = this.fields_dict[key];\n\t\t\tif(f) {\n\t\t\t\tf.set_value(val).then(() => {\n\t\t\t\t\tf.set_input(val);\n\t\t\t\t\tthis.refresh_dependency();\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tresolve();\n\t\t\t}\n\t\t});\n\t},\n\tset_input: function(key, val) {\n\t\treturn this.set_value(key, val);\n\t},\n\tset_values: function(dict) {\n\t\tfor(var key in dict) {\n\t\t\tif(this.fields_dict[key]) {\n\t\t\t\tthis.set_value(key, dict[key]);\n\t\t\t}\n\t\t}\n\t},\n\tclear: function() {\n\t\tfor(var key in this.fields_dict) {\n\t\t\tvar f = this.fields_dict[key];\n\t\t\tif(f && f.set_input) {\n\t\t\t\tf.set_input(f.df['default'] || '');\n\t\t\t}\n\t\t}\n\t},\n\tset_df_property: function (fieldname, prop, value) {\n\t\tconst field    = this.get_field(fieldname);\n\t\tfield.df[prop] = value;\n\t\tfield.refresh();\n\t}\n});\n","// Copyright (c) 2015, Frappe Technologies Pvt. Ltd. and Contributors\n// MIT License. See license.txt\n\n// add a new dom element\nfrappe.provide('frappe.dom');\n\nfrappe.dom = {\n\tid_count: 0,\n\tfreeze_count: 0,\n\tby_id: function(id) {\n\t\treturn document.getElementById(id);\n\t},\n\tget_unique_id: function() {\n\t\tconst id = 'unique-' + frappe.dom.id_count;\n\t\tfrappe.dom.id_count++;\n\t\treturn id;\n\t},\n\tset_unique_id: function(ele) {\n\t\tvar $ele = $(ele);\n\t\tif($ele.attr('id')) {\n\t\t\treturn $ele.attr('id');\n\t\t}\n\t\tvar id = 'unique-' + frappe.dom.id_count;\n\t\t$ele.attr('id', id);\n\t\tfrappe.dom.id_count++;\n\t\treturn id;\n\t},\n\teval: function(txt) {\n\t\tif(!txt) return;\n\t\tvar el = document.createElement('script');\n\t\tel.appendChild(document.createTextNode(txt));\n\t\t// execute the script globally\n\t\tdocument.getElementsByTagName('head')[0].appendChild(el);\n\t},\n\tremove_script_and_style: function(txt) {\n\t\tconst evil_tags = [\"script\", \"style\", \"noscript\", \"title\", \"meta\", \"base\", \"head\"];\n\t\tconst regex = new RegExp(evil_tags.map(tag => `<${tag}>.*<\\\\/${tag}>`).join('|'));\n\t\tif (!regex.test(txt)) {\n\t\t\t// no evil tags found, skip the DOM method entirely!\n\t\t\treturn txt;\n\t\t}\n\n\t\tvar div = document.createElement('div');\n\t\tdiv.innerHTML = txt;\n\t\tvar found = false;\n\t\tevil_tags.forEach(function(e) {\n\t\t\tvar elements = div.getElementsByTagName(e);\n\t\t\ti = elements.length;\n\t\t\twhile (i--) {\n\t\t\t\tfound = true;\n\t\t\t\telements[i].parentNode.removeChild(elements[i]);\n\t\t\t}\n\t\t});\n\n\t\t// remove links with rel=\"stylesheet\"\n\t\tvar elements = div.getElementsByTagName('link');\n\t\tvar i = elements.length;\n\t\twhile (i--) {\n\t\t\tif (elements[i].getAttribute(\"rel\")==\"stylesheet\"){\n\t\t\t\tfound = true;\n\t\t\t\telements[i].parentNode.removeChild(elements[i]);\n\t\t\t}\n\t\t}\n\t\tif(found) {\n\t\t\treturn div.innerHTML;\n\t\t} else {\n\t\t\t// don't disturb\n\t\t\treturn txt;\n\t\t}\n\t},\n\tis_element_in_viewport: function (el, tolerance=0) {\n\n\t\t//special bonus for those using jQuery\n\t\tif (typeof jQuery === \"function\" && el instanceof jQuery) {\n\t\t\tel = el[0];\n\t\t}\n\n\t\tvar rect = el.getBoundingClientRect();\n\n\t\treturn (\n\t\t\trect.top + tolerance >= 0\n\t\t\t&& rect.left + tolerance >= 0\n\t\t\t&& rect.bottom - tolerance <= $(window).height()\n\t\t\t&& rect.right - tolerance <= $(window).width()\n\t\t);\n\t},\n\n\tset_style: function(txt, id) {\n\t\tif(!txt) return;\n\n\t\tvar se = document.createElement('style');\n\t\tse.type = \"text/css\";\n\n\t\tif (id) {\n\t\t\tvar element = document.getElementById(id);\n\t\t\tif (element) {\n\t\t\t\telement.parentNode.removeChild(element);\n\t\t\t}\n\t\t\tse.id = id;\n\t\t}\n\n\t\tif (se.styleSheet) {\n\t\t\tse.styleSheet.cssText = txt;\n\t\t} else {\n\t\t\tse.appendChild(document.createTextNode(txt));\n\t\t}\n\t\tdocument.getElementsByTagName('head')[0].appendChild(se);\n\t\treturn se;\n\t},\n\tadd: function(parent, newtag, className, cs, innerHTML, onclick) {\n\t\tif(parent && parent.substr)parent = frappe.dom.by_id(parent);\n\t\tvar c = document.createElement(newtag);\n\t\tif(parent)\n\t\t\tparent.appendChild(c);\n\n\t\t// if image, 3rd parameter is source\n\t\tif(className) {\n\t\t\tif(newtag.toLowerCase()=='img')\n\t\t\t\tc.src = className\n\t\t\telse\n\t\t\t\tc.className = className;\n\t\t}\n\t\tif(cs) frappe.dom.css(c,cs);\n\t\tif(innerHTML) c.innerHTML = innerHTML;\n\t\tif(onclick) c.onclick = onclick;\n\t\treturn c;\n\t},\n\tcss: function(ele, s) {\n\t\tif(ele && s) {\n\t\t\t$.extend(ele.style, s);\n\t\t}\n\t\treturn ele;\n\t},\n\tactivate: function($parent, $child, common_class, active_class='active') {\n\t\t$parent.find(`.${common_class}.${active_class}`)\n\t\t\t.removeClass(active_class);\n\t\t$child.addClass(active_class);\n\t},\n\tfreeze: function(msg, css_class) {\n\t\t// blur\n\t\tif(!$('#freeze').length) {\n\t\t\tvar freeze = $('<div id=\"freeze\" class=\"modal-backdrop fade\"></div>')\n\t\t\t\t.on(\"click\", function() {\n\t\t\t\t\tif (cur_frm && cur_frm.cur_grid) {\n\t\t\t\t\t\tcur_frm.cur_grid.toggle_view();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.appendTo(\"#body_div\");\n\n\t\t\tfreeze.html(repl('<div class=\"freeze-message-container\"><div class=\"freeze-message\"><p class=\"lead\">%(msg)s</p></div></div>',\n\t\t\t\t{msg: msg || \"\"}));\n\n\t\t\tsetTimeout(function() { freeze.addClass(\"in\") }, 1);\n\n\t\t} else {\n\t\t\t$(\"#freeze\").addClass(\"in\");\n\t\t}\n\n\t\tif (css_class) {\n\t\t\t$(\"#freeze\").addClass(css_class);\n\t\t}\n\n\t\tfrappe.dom.freeze_count++;\n\t},\n\tunfreeze: function() {\n\t\tif(!frappe.dom.freeze_count) return; // anything open?\n\t\tfrappe.dom.freeze_count--;\n\t\tif(!frappe.dom.freeze_count) {\n\t\t\tvar freeze = $('#freeze').removeClass(\"in\").remove();\n\t\t}\n\t},\n\tsave_selection: function() {\n\t\t// via http://stackoverflow.com/questions/5605401/insert-link-in-contenteditable-element\n\t\tif (window.getSelection) {\n\t\t\tvar sel = window.getSelection();\n\t\t\tif (sel.getRangeAt && sel.rangeCount) {\n\t\t\t\tvar ranges = [];\n\t\t\t\tfor (var i = 0, len = sel.rangeCount; i < len; ++i) {\n\t\t\t\t\tranges.push(sel.getRangeAt(i));\n\t\t\t\t}\n\t\t\t\treturn ranges;\n\t\t\t}\n\t\t} else if (document.selection && document.selection.createRange) {\n\t\t\treturn document.selection.createRange();\n\t\t}\n\t\treturn null;\n\t},\n\trestore_selection: function(savedSel) {\n\t\tif (savedSel) {\n\t\t\tif (window.getSelection) {\n\t\t\t\tvar sel = window.getSelection();\n\t\t\t\tsel.removeAllRanges();\n\t\t\t\tfor (var i = 0, len = savedSel.length; i < len; ++i) {\n\t\t\t\t\tsel.addRange(savedSel[i]);\n\t\t\t\t}\n\t\t\t} else if (document.selection && savedSel.select) {\n\t\t\t\tsavedSel.select();\n\t\t\t}\n\t\t}\n\t},\n\tis_touchscreen: function() {\n\t\treturn ('ontouchstart' in window)\n\t},\n\thandle_broken_images(container) {\n\t\t$(container).find('img').on('error', (e) => {\n\t\t\tconst $img = $(e.currentTarget);\n\t\t\t$img.addClass('no-image');\n\t\t});\n\t},\n\tscroll_to_bottom(container) {\n\t\tconst $container = $(container);\n\t\t$container.scrollTop($container[0].scrollHeight);\n\t},\n\tfile_to_base64(file_obj) {\n\t\treturn new Promise(resolve => {\n\t\t\tconst reader = new FileReader();\n\t\t\treader.onload = function() {\n\t\t\t\tresolve(reader.result);\n\t\t\t};\n\t\t\treader.readAsDataURL(file_obj);\n\t\t});\n\t},\n\tscroll_to_section(section_name) {\n\t\tsetTimeout(() => {\n\t\t\tconst section = $(`a:contains(\"${section_name}\")`);\n\t\t\tif (section.length) {\n\t\t\t\tif(section.parent().hasClass('collapsed')) {\n\t\t\t\t\t// opens the section\n\t\t\t\t\tsection.click();\n\t\t\t\t}\n\t\t\t\tfrappe.ui.scroll(section.parent().parent());\n\t\t\t}\n\t\t}, 200);\n\t},\n\tpixel_to_inches(pixels) {\n\t\tconst div = $('<div id=\"dpi\" style=\"height: 1in; width: 1in; left: 100%; position: fixed; top: 100%;\"></div>');\n\t\tdiv.appendTo(document.body);\n\n\t\tconst dpi_x = document.getElementById('dpi').offsetWidth;\n\t\tconst inches = pixels / dpi_x;\n\t\tdiv.remove();\n\n\t\treturn inches;\n\t}\n};\n\nfrappe.ellipsis = function(text, max) {\n\tif(!max) max = 20;\n\ttext = cstr(text);\n\tif(text.length > max) {\n\t\ttext = text.substr(0, max) + '...';\n\t}\n\treturn text;\n};\n\nfrappe.run_serially = function(tasks) {\n\tvar result = Promise.resolve();\n\ttasks.forEach(task => {\n\t\tif(task) {\n\t\t\tresult = result.then ? result.then(task) : Promise.resolve();\n\t\t}\n\t});\n\treturn result;\n};\n\nfrappe.load_image = (src, onload, onerror, preprocess = () => {}) => {\n\tvar tester = new Image();\n\ttester.onload = function() {\n\t\tonload(this);\n\t};\n\ttester.onerror = onerror;\n\n\tpreprocess(tester);\n\ttester.src = src;\n}\n\nfrappe.timeout = seconds => {\n\treturn new Promise((resolve) => {\n\t\tsetTimeout(() => resolve(), seconds * 1000);\n\t});\n};\n\nfrappe.scrub = function(text, spacer='_') {\n\treturn text.replace(/ /g, spacer).toLowerCase();\n};\n\nfrappe.get_modal = function(title, content) {\n\treturn $(`<div class=\"modal fade\" style=\"overflow: auto;\" tabindex=\"-1\">\n\t\t<div class=\"modal-dialog\">\n\t\t\t<div class=\"modal-content\">\n\t\t\t\t<div class=\"modal-header\">\n\t\t\t\t\t<div class=\"flex justify-between\">\n\t\t\t\t\t\t<div class=\"fill-width flex\">\n\t\t\t\t\t\t\t<span class=\"indicator hidden\"></span>\n\t\t\t\t\t\t\t<h4 class=\"modal-title\" style=\"font-weight: bold;\">${title}</h4>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<div class=\"text-right buttons\">\n\t\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-default btn-sm btn-modal-minimize hide\">\n\t\t\t\t\t\t\t\t\t<i class=\"octicon octicon-chevron-down\" style=\"padding: 1px 0px;\"></i>\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-default btn-sm btn-modal-close\" data-dismiss=\"modal\">\n\t\t\t\t\t\t\t\t\t<i class=\"octicon octicon-x visible-xs\" style=\"padding: 1px 0px;\"></i>\n\t\t\t\t\t\t\t\t\t<span class=\"hidden-xs\">${__(\"Close\")}</span>\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-primary btn-sm hide\">\n\t\t\t\t\t\t\t\t\t${__(\"Confirm\")}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"modal-body ui-front\">${content}</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>`);\n};\n\nfrappe.is_online = function() {\n\tif (frappe.boot.developer_mode == 1) {\n\t\t// always online in developer_mode\n\t\treturn true;\n\t}\n\tif ('onLine' in navigator) {\n\t\treturn navigator.onLine;\n\t}\n\treturn true;\n};\n\n// bind online/offline events\n$(window).on('online', function() {\n\tfrappe.show_alert({\n\t\tindicator: 'green',\n\t\tmessage: __('You are connected to internet.')\n\t});\n});\n\n$(window).on('offline', function() {\n\tfrappe.show_alert({\n\t\tindicator: 'orange',\n\t\tmessage: __('Connection lost. Some features might not work.')\n\t});\n});\n","\nimport './field_group';\nimport '../dom';\n\nfrappe.provide('frappe.ui');\n\nwindow.cur_dialog = null;\n\nfrappe.ui.open_dialogs = [];\n\nfrappe.ui.Dialog = class Dialog extends frappe.ui.FieldGroup {\n\tconstructor(opts) {\n\t\tsuper();\n\t\tthis.display = false;\n\t\tthis.is_dialog = true;\n\n\t\t$.extend(this, { animate: true, size: null }, opts);\n\t\tthis.make();\n\t}\n\n\tmake() {\n\t\tthis.$wrapper = frappe.get_modal(\"\", \"\");\n\n\t\tif(this.static) {\n\t\t\tthis.$wrapper.modal({\n\t\t\t\tbackdrop: 'static',\n\t\t\t\tkeyboard: false\n\t\t\t});\n\t\t\tthis.get_close_btn().hide();\n\t\t}\n\n\t\tthis.wrapper = this.$wrapper.find('.modal-dialog')\n\t\t\t.get(0);\n\t\tif ( this.size == \"small\" )\n\t\t\t$(this.wrapper).addClass(\"modal-sm\");\n\t\telse if ( this.size == \"large\" )\n\t\t\t$(this.wrapper).addClass(\"modal-lg\");\n\n\t\tthis.make_head();\n\t\tthis.modal_body = this.$wrapper.find(\".modal-body\");\n\t\tthis.$body = $('<div></div>').appendTo(this.modal_body);\n\t\tthis.body = this.$body.get(0);\n\t\tthis.$message = $('<div class=\"hide modal-message\"></div>').appendTo(this.modal_body);\n\t\tthis.header = this.$wrapper.find(\".modal-header\");\n\t\tthis.buttons = this.header.find('.buttons');\n\t\tthis.set_indicator();\n\n\t\t// make fields (if any)\n\t\tsuper.make();\n\n\t\t// show footer\n\t\tthis.action = this.action || { primary: { }, secondary: { } };\n\t\tif(this.primary_action || (this.action.primary && this.action.primary.onsubmit)) {\n\t\t\tthis.set_primary_action(this.primary_action_label || this.action.primary.label || __(\"Submit\"),\n\t\t\t\tthis.primary_action || this.action.primary.onsubmit);\n\t\t}\n\n\t\tif(this.secondary_action) {\n\t\t\tthis.set_secondary_action(this.secondary_action);\n\t\t}\n\n\t\tif (this.secondary_action_label || (this.action.secondary && this.action.secondary.label)) {\n\t\t\tthis.get_close_btn().html(this.secondary_action_label || this.action.secondary.label);\n\t\t}\n\n\t\tif (this.minimizable) {\n\t\t\tthis.header.find('.modal-title').click(() => this.toggle_minimize());\n\t\t\tthis.get_minimize_btn().removeClass('hide').on('click', () => this.toggle_minimize());\n\t\t}\n\n\t\tvar me = this;\n\t\tthis.$wrapper\n\t\t\t.on(\"hide.bs.modal\", function() {\n\t\t\t\tme.display = false;\n\t\t\t\tme.secondary_action && me.secondary_action();\n\n\t\t\t\tif(frappe.ui.open_dialogs[frappe.ui.open_dialogs.length-1]===me) {\n\t\t\t\t\tfrappe.ui.open_dialogs.pop();\n\t\t\t\t\tif(frappe.ui.open_dialogs.length) {\n\t\t\t\t\t\twindow.cur_dialog = frappe.ui.open_dialogs[frappe.ui.open_dialogs.length-1];\n\t\t\t\t\t} else {\n\t\t\t\t\t\twindow.cur_dialog = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tme.onhide && me.onhide();\n\t\t\t\tme.on_hide && me.on_hide();\n\t\t\t})\n\t\t\t.on(\"shown.bs.modal\", function() {\n\t\t\t\t// focus on first input\n\t\t\t\tme.display = true;\n\t\t\t\twindow.cur_dialog = me;\n\t\t\t\tfrappe.ui.open_dialogs.push(me);\n\t\t\t\tme.focus_on_first_input();\n\t\t\t\tme.on_page_show && me.on_page_show();\n\t\t\t\t$(document).trigger('frappe.ui.Dialog:shown');\n\t\t\t})\n\t\t\t.on('scroll', function() {\n\t\t\t\tvar $input = $('input:focus');\n\t\t\t\tif($input.length && ['Date', 'Datetime', 'Time'].includes($input.attr('data-fieldtype'))) {\n\t\t\t\t\t$input.blur();\n\t\t\t\t}\n\t\t\t});\n\n\t}\n\n\tget_primary_btn() {\n\t\treturn this.$wrapper.find(\".modal-header .btn-primary\");\n\t}\n\n\tget_minimize_btn() {\n\t\treturn this.$wrapper.find(\".modal-header .btn-modal-minimize\");\n\t}\n\n\tset_message(text) {\n\t\tthis.$message.removeClass('hide');\n\t\tthis.$body.addClass('hide');\n\t\tthis.$message.text(text);\n\t}\n\n\tclear_message() {\n\t\tthis.$message.addClass('hide');\n\t\tthis.$body.removeClass('hide');\n\t}\n\n\tclear() {\n\t\tsuper.clear();\n\t\tthis.clear_message();\n\t}\n\n\tset_primary_action(label, click) {\n\t\tthis.has_primary_action = true;\n\t\tvar me = this;\n\t\treturn this.get_primary_btn()\n\t\t\t.removeClass(\"hide\")\n\t\t\t.html(label)\n\t\t\t.click(function() {\n\t\t\t\tme.primary_action_fulfilled = true;\n\t\t\t\t// get values and send it\n\t\t\t\t// as first parameter to click callback\n\t\t\t\t// if no values then return\n\t\t\t\tvar values = me.get_values();\n\t\t\t\tif(!values) return;\n\t\t\t\tclick && click.apply(me, [values]);\n\t\t\t});\n\t}\n\n\tset_secondary_action(click) {\n\t\tthis.get_close_btn().on('click', click);\n\t}\n\n\tdisable_primary_action() {\n\t\tthis.get_primary_btn().addClass('disabled');\n\t}\n\tenable_primary_action() {\n\t\tthis.get_primary_btn().removeClass('disabled');\n\t}\n\tmake_head() {\n\t\tthis.set_title(this.title);\n\t}\n\tset_title(t) {\n\t\tthis.$wrapper.find(\".modal-title\").html(t);\n\t}\n\tset_indicator() {\n\t\tif (this.indicator) {\n\t\t\tthis.header.find('.indicator').removeClass().addClass('indicator ' + this.indicator);\n\t\t}\n\t}\n\tshow() {\n\t\t// show it\n\t\tif ( this.animate ) {\n\t\t\tthis.$wrapper.addClass('fade');\n\t\t} else {\n\t\t\tthis.$wrapper.removeClass('fade');\n\t\t}\n\t\tthis.$wrapper.modal(\"show\");\n\n\t\t// clear any message\n\t\tthis.clear_message();\n\n\t\tthis.primary_action_fulfilled = false;\n\t\tthis.is_visible = true;\n\t\treturn this;\n\t}\n\thide() {\n\t\tthis.$wrapper.modal(\"hide\");\n\t\tthis.is_visible = false;\n\t}\n\tget_close_btn() {\n\t\treturn this.$wrapper.find(\".btn-modal-close\");\n\t}\n\tno_cancel() {\n\t\tthis.get_close_btn().toggle(false);\n\t}\n\tcancel() {\n\t\tthis.get_close_btn().trigger(\"click\");\n\t}\n\ttoggle_minimize() {\n\t\tlet modal = this.$wrapper.closest('.modal').toggleClass('modal-minimize');\n\t\tmodal.attr('tabindex') ? modal.removeAttr('tabindex') : modal.attr('tabindex', -1);\n\t\tthis.get_minimize_btn().find('i').toggleClass('octicon-chevron-down').toggleClass('octicon-chevron-up');\n\t\tthis.is_minimized = !this.is_minimized;\n\t\tthis.on_minimize_toggle && this.on_minimize_toggle(this.is_minimized);\n\t\tthis.header.find('.modal-title').toggleClass('cursor-pointer');\n\t}\n};\n","// frappe.ui.Capture\n// Author - Achilles Rasquinha <achilles@frappe.io>\n\n/**\n * @description Converts a canvas, image or a video to a data URL string.\n * \n * @param \t{HTMLElement} element - canvas, img or video.\n * @returns {string} \t\t\t  - The data URL string.\n * \n * @example\n * frappe._.get_data_uri(video)\n * // returns \"data:image/pngbase64,...\"\n */\nfrappe._.get_data_uri = element =>\n{\n\tconst $element = $(element)\n\tconst width    = $element.width()\n\tconst height   = $element.height()\n\n\tconst $canvas     = $('<canvas/>')\n\t$canvas[0].width  = width\n\t$canvas[0].height = height\n\n\tconst context     = $canvas[0].getContext('2d')\n\tcontext.drawImage($element[0], 0, 0, width, height)\n\t\n\tconst data_uri = $canvas[0].toDataURL('image/png')\n\n\treturn data_uri\n}\n\n/**\n * @description Frappe's Capture object.\n * \n * @example\n * const capture = frappe.ui.Capture()\n * capture.show()\n * \n * capture.click((data_uri) => {\n * \t// do stuff\n * })\n * \n * @see https://developer.mozilla.org/en-US/docs/Web/API/WebRTC_API/Taking_still_photos\n */\nfrappe.ui.Capture = class\n{\n\tconstructor (options = { })\n\t{\n\t\tthis.options = frappe.ui.Capture.OPTIONS\n\t\tthis.set_options(options)\n\t}\n\t\n\tset_options (options)\n\t{\n\t\tthis.options = { ...frappe.ui.Capture.OPTIONS, ...options }\n\t\t\n\t\treturn this\n\t}\n\t\n\trender ( )\n\t{\n\t\treturn navigator.mediaDevices.getUserMedia({ video: true }).then(stream =>\n\t\t{\n\t\t\tthis.dialog \t = new frappe.ui.Dialog({\n\t\t\t\t  title: this.options.title,\n\t\t\t\tanimate: this.options.animate,\n\t\t\t\t action:\n\t\t\t\t{\n\t\t\t\t\tsecondary:\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: \"<b>&times</b>\"\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\n\t\t\tconst $e \t\t = $(frappe.ui.Capture.TEMPLATE)\n\t\t\t\n\t\t\tconst video      = $e.find('video')[0]\n\t\t\tvideo.srcObject  = stream\n\t\t\tvideo.play()\n\t\t\t\n\t\t\tconst $container = $(this.dialog.body)\n\t\t\t$container.html($e)\n\t\t\t\n\t\t\t$e.find('.fc-btf').hide()\n\n\t\t\t$e.find('.fc-bcp').click(() =>\n\t\t\t{\n\t\t\t\tconst data_url = frappe._.get_data_uri(video)\n\t\t\t\t$e.find('.fc-p').attr('src', data_url)\n\n\t\t\t\t$e.find('.fc-s').hide()\n\t\t\t\t$e.find('.fc-p').show()\n\n\t\t\t\t$e.find('.fc-btu').hide()\n\t\t\t\t$e.find('.fc-btf').show()\n\t\t\t})\n\n\t\t\t$e.find('.fc-br').click(() =>\n\t\t\t{\n\t\t\t\t$e.find('.fc-p').hide()\n\t\t\t\t$e.find('.fc-s').show()\n\n\t\t\t\t$e.find('.fc-btf').hide()\n\t\t\t\t$e.find('.fc-btu').show()\n\t\t\t})\n\n\t\t\t$e.find('.fc-bs').click(() =>\n\t\t\t{\n\t\t\t\tconst data_url = frappe._.get_data_uri(video)\n\t\t\t\tthis.hide()\n\t\t\t\t\n\t\t\t\tif (this.callback)\n\t\t\t\t\tthis.callback(data_url)\n\t\t\t})\n\t\t})\n\t}\n\n\tshow ( )\n\t{\n\t\tthis.render().then(() =>\n\t\t{\n\t\t\tthis.dialog.show()\n\t\t}).catch(err => {\n\t\t\tif ( this.options.error )\n\t\t\t{\n\t\t\t\tconst alert = `<span class=\"indicator red\"/> ${frappe.ui.Capture.ERR_MESSAGE}`\n\t\t\t\tfrappe.show_alert(alert, 3)\n\t\t\t}\n\n\t\t\tthrow err\n\t\t})\n\t}\n\n\thide ( )\n\t{\n\t\tif ( this.dialog )\n\t\t\tthis.dialog.hide()\n\t}\n\n\tsubmit (fn)\n\t{\n\t\tthis.callback = fn\n\t}\n}\nfrappe.ui.Capture.OPTIONS =\n{\n\t  title: __(`Camera`),\n\tanimate: false,\n\t  error: false,\n}\nfrappe.ui.Capture.ERR_MESSAGE = __(\"Unable to load camera.\")\nfrappe.ui.Capture.TEMPLATE \t  =\n`\n<div class=\"frappe-capture\">\n\t<div class=\"panel panel-default\">\n\t\t<img class=\"fc-p img-responsive\"/>\n\t\t<div class=\"fc-s  embed-responsive embed-responsive-16by9\">\n\t\t\t<video class=\"embed-responsive-item\">${frappe.ui.Capture.ERR_MESSAGE}</video>\n\t\t</div>\n\t</div>\n\t<div>\n\t\t<div class=\"fc-btf\">\n\t\t\t<div class=\"row\">\n\t\t\t\t<div class=\"col-md-6\">\n\t\t\t\t\t<div class=\"pull-left\">\n\t\t\t\t\t\t<button class=\"btn btn-default fc-br\">\n\t\t\t\t\t\t\t<small>${__('Retake')}</small>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"col-md-6\">\n\t\t\t\t\t<div class=\"pull-right\">\n\t\t\t\t\t\t<button class=\"btn btn-primary fc-bs\">\n\t\t\t\t\t\t\t<small>${__('Submit')}</small>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"fc-btu\">\n\t\t\t<div class=\"row\">\n\t\t\t\t<div class=\"col-md-6\">\n\t\t\t\t\t${\n\t\t\t\t\t\t''\n\t\t\t\t\t\t// <div class=\"pull-left\">\n\t\t\t\t\t\t// \t<button class=\"btn btn-default\">\n\t\t\t\t\t\t// \t\t<small>${__('Take Video')}</small>\n\t\t\t\t\t\t// \t</button>\n\t\t\t\t\t\t// </div>\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"col-md-6\">\n\t\t\t\t\t<div class=\"pull-right\">\n\t\t\t\t\t\t<button class=\"btn btn-default fc-bcp\">\n\t\t\t\t\t\t\t<small>${__('Take Photo')}</small>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n`","\n\nfrappe.user_info = function(uid) {\n\tif(!uid)\n\t\tuid = frappe.session.user;\n\n\tif(uid.toLowerCase()===\"bot\") {\n\t\treturn {\n\t\t\tfullname: __(\"Bot\"),\n\t\t\timage: \"/assets/frappe/images/ui/bot.png\",\n\t\t\tabbr: \"B\"\n\t\t};\n\t}\n\n\tif(!(frappe.boot.user_info && frappe.boot.user_info[uid])) {\n\t\tvar user_info = {fullname: uid || \"Unknown\"};\n\t} else {\n\t\tvar user_info = frappe.boot.user_info[uid];\n\t}\n\n\tuser_info.abbr = frappe.get_abbr(user_info.fullname);\n\tuser_info.color = frappe.get_palette(user_info.fullname);\n\n\treturn user_info;\n};\n\nfrappe.ui.set_user_background = function(src, selector, style) {\n\tif(!selector) selector = \"#page-desktop\";\n\tif(!style) style = \"Fill Screen\";\n\tif(src) {\n\t\tif (window.cordova && src.indexOf(\"http\") === -1) {\n\t\t\tsrc = frappe.base_url + src;\n\t\t}\n\t\tvar background = repl('background: url(\"%(src)s\") center center;', {src: src});\n\t} else {\n\t\tvar background = \"background-color: #4B4C9D;\";\n\t}\n\n\tfrappe.dom.set_style(repl('%(selector)s { \\\n\t\t%(background)s \\\n\t\tbackground-attachment: fixed; \\\n\t\t%(style)s \\\n\t}', {\n\t\tselector:selector,\n\t\tbackground:background,\n\t\tstyle: style===\"Fill Screen\" ? \"background-size: cover;\" : \"\"\n\t}));\n};\n\nfrappe.provide('frappe.user');\n\n$.extend(frappe.user, {\n\tname: 'Guest',\n\tfull_name: function(uid) {\n\t\treturn uid === frappe.session.user ?\n\t\t\t__(\"You\") :\n\t\t\tfrappe.user_info(uid).fullname;\n\t},\n\timage: function(uid) {\n\t\treturn frappe.user_info(uid).image;\n\t},\n\tabbr: function(uid) {\n\t\treturn frappe.user_info(uid).abbr;\n\t},\n\thas_role: function(rl) {\n\t\tif(typeof rl=='string')\n\t\t\trl = [rl];\n\t\tfor(var i in rl) {\n\t\t\tif((frappe.boot ? frappe.boot.user.roles : ['Guest']).indexOf(rl[i])!=-1)\n\t\t\t\treturn true;\n\t\t}\n\t},\n\tget_desktop_items: function() {\n\t\t// hide based on permission\n\t\tvar modules_list = $.map(frappe.boot.allowed_modules, function(icon) {\n\t\t\tvar m = icon.module_name;\n\t\t\tvar type = frappe.modules[m] && frappe.modules[m].type;\n\n\t\t\tif(frappe.boot.user.allow_modules.indexOf(m) === -1) return null;\n\n\t\t\tvar ret = null;\n\t\t\tif (type === \"module\") {\n\t\t\t\tif(frappe.boot.user.allow_modules.indexOf(m)!=-1 || frappe.modules[m].is_help)\n\t\t\t\t\tret = m;\n\t\t\t} else if (type === \"page\") {\n\t\t\t\tif(frappe.boot.allowed_pages.indexOf(frappe.modules[m].link)!=-1)\n\t\t\t\t\tret = m;\n\t\t\t} else if (type === \"list\") {\n\t\t\t\tif(frappe.model.can_read(frappe.modules[m]._doctype))\n\t\t\t\t\tret = m;\n\t\t\t} else if (type === \"view\") {\n\t\t\t\tret = m;\n\t\t\t} else if (type === \"setup\") {\n\t\t\t\tif(frappe.user.has_role(\"System Manager\") || frappe.user.has_role(\"Administrator\"))\n\t\t\t\t\tret = m;\n\t\t\t} else {\n\t\t\t\tret = m;\n\t\t\t}\n\n\t\t\treturn ret;\n\t\t});\n\n\t\treturn modules_list;\n\t},\n\n\tis_report_manager: function() {\n\t\treturn frappe.user.has_role(['Administrator', 'System Manager', 'Report Manager']);\n\t},\n\n\tget_formatted_email: function(email) {\n\t\tvar fullname = frappe.user.full_name(email);\n\n\t\tif (!fullname) {\n\t\t\treturn email;\n\t\t} else {\n\t\t\t// to quote or to not\n\t\t\tvar quote = '';\n\n\t\t\t// only if these special characters are found\n\t\t\t// why? To make the output same as that in python!\n\t\t\tif (fullname.search(/[\\[\\]\\\\()<>@,:;\".]/) !== -1) {\n\t\t\t\tquote = '\"';\n\t\t\t}\n\n\t\t\treturn repl('%(quote)s%(fullname)s%(quote)s <%(email)s>', {\n\t\t\t\tfullname: fullname,\n\t\t\t\temail: email,\n\t\t\t\tquote: quote\n\t\t\t});\n\t\t}\n\t},\n\n\tget_emails: ( ) => {\n\t\treturn Object.keys(frappe.boot.user_info).map(key => frappe.boot.user_info[key].email);\n\t},\n\n\t/* Normally frappe.user is an object\n\t * having properties and methods.\n\t * But in the following case\n\t *\n\t * if (frappe.user === 'Administrator')\n\t *\n\t * frappe.user will cast to a string\n\t * returning frappe.user.name\n\t */\n\ttoString: function() {\n\t\treturn this.name;\n\t}\n});\n\nfrappe.session_alive = true;\n$(document).bind('mousemove', function() {\n\tif(frappe.session_alive===false) {\n\t\t$(document).trigger(\"session_alive\");\n\t}\n\tfrappe.session_alive = true;\n\tif(frappe.session_alive_timeout)\n\t\tclearTimeout(frappe.session_alive_timeout);\n\tfrappe.session_alive_timeout = setTimeout('frappe.session_alive=false;', 30000);\n});","// Frappe Chat\n// Author - Achilles Rasquinha <achilles@frappe.io>\n\nimport Fuse   from 'fuse.js'\nimport hyper  from '../lib/hyper.min'\n\nimport './socketio_client'\n\nimport './ui/dialog'\nimport './ui/capture'\n\nimport './utils/user'\n\n/* eslint semi: \"never\" */\n// Fuck semicolons - https://mislav.net/2010/05/semicolons\n\n// frappe extensions\n\n/**\n * @description The base class for all Frappe Errors.\n *\n * @example\n * try\n *      throw new frappe.Error(\"foobar\")\n * catch (e)\n *      console.log(e.name)\n * // returns \"FrappeError\"\n *\n * @see  https://stackoverflow.com/a/32749533\n * @todo Requires \"transform-builtin-extend\" for Babel 6\n */\nfrappe.Error = Error\n// class extends Error {\n// \tconstructor (message) {\n// \t\tsuper (message)\n\n// \t\tthis.name = 'FrappeError'\n\n// \t\tif ( typeof Error.captureStackTrace === 'function' )\n// \t\t\tError.captureStackTrace(this, this.constructor)\n// \t\telse\n// \t\t\tthis.stack = (new Error(message)).stack\n// \t}\n// }\n\n/**\n * @description TypeError\n */\nfrappe.TypeError  = TypeError\n// class extends frappe.Error {\n// \tconstructor (message) {\n// \t\tsuper (message)\n\n// \t\tthis.name = this.constructor.name\n// \t}\n// }\n\n/**\n * @description ValueError\n */\nfrappe.ValueError = Error\n// class extends frappe.Error {\n// \tconstructor (message) {\n// \t\tsuper (message)\n\n// \t\tthis.name = this.constructor.name\n// \t}\n// }\n\n/**\n * @description ImportError\n */\nfrappe.ImportError = Error\n// class extends frappe.Error {\n// \tconstructor (message) {\n// \t\tsuper (message)\n\n// \t\tthis.name  = this.constructor.name\n// \t}\n// }\n\n// frappe.datetime\nfrappe.provide('frappe.datetime')\n\n/**\n * @description Frappe's datetime object. (Inspired by Python's datetime object).\n *\n * @example\n * const datetime = new frappe.datetime.datetime()\n */\nfrappe.datetime.datetime = class {\n\t/**\n\t * @description Frappe's datetime Class's constructor.\n\t */\n\tconstructor (instance, format = null) {\n\t\tif ( typeof moment === 'undefined' )\n\t\t\tthrow new frappe.ImportError(`Moment.js not installed.`)\n\n\t\tthis.moment = instance ? moment(instance, format) : moment()\n\t}\n\n\t/**\n\t * @description Returns a formatted string of the datetime object.\n\t */\n\tformat (format = null) {\n\t\tconst  formatted = this.moment.format(format)\n\t\treturn formatted\n\t}\n}\n\n/**\n * @description Frappe's daterange object.\n *\n * @example\n * const range = new frappe.datetime.range(frappe.datetime.now(), frappe.datetime.now())\n * range.contains(frappe.datetime.now())\n */\nfrappe.datetime.range   = class {\n\tconstructor (start, end) {\n\t\tif ( typeof moment === undefined )\n\t\t\tthrow new frappe.ImportError(`Moment.js not installed.`)\n\n\t\tthis.start = start\n\t\tthis.end   = end\n\t}\n\n\tcontains (datetime) {\n\t\tconst  contains = datetime.moment.isBetween(this.start.moment, this.end.moment)\n\t\treturn contains\n\t}\n}\n\n/**\n * @description Returns the current datetime.\n *\n * @example\n * const datetime = new frappe.datetime.now()\n */\nfrappe.datetime.now   = () => new frappe.datetime.datetime()\n\nfrappe.datetime.equal = (a, b, type) => {\n\ta = a.moment\n\tb = b.moment\n\n\tconst equal = a.isSame(b, type)\n\n\treturn equal\n}\n\n/**\n * @description Compares two frappe.datetime.datetime objects.\n *\n * @param   {frappe.datetime.datetime} a - A frappe.datetime.datetime/moment object.\n * @param   {frappe.datetime.datetime} b - A frappe.datetime.datetime/moment object.\n *\n * @returns {number} 0 (if a and b are equal), 1 (if a is before b), -1 (if a is after b).\n *\n * @example\n * frappe.datetime.compare(frappe.datetime.now(), frappe.datetime.now())\n * // returns 0\n * const then = frappe.datetime.now()\n *\n * frappe.datetime.compare(then, frappe.datetime.now())\n * // returns 1\n */\nfrappe.datetime.compare = (a, b) => {\n\ta = a.moment\n\tb = b.moment\n\n\tif ( a.isBefore(b) )\n\t\treturn  1\n\telse\n\tif ( b.isBefore(a) )\n\t\treturn -1\n\telse\n\t\treturn  0\n}\n\n// frappe.quick_edit\nfrappe.quick_edit      = (doctype, docname, fn) => {\n\treturn new Promise(resolve => {\n\t\tfrappe.model.with_doctype(doctype, () => {\n\t\t\tfrappe.db.get_doc(doctype, docname).then(doc  => {\n\t\t\t\tconst meta     = frappe.get_meta(doctype)\n\t\t\t\tconst fields   = meta.fields\n\t\t\t\tconst required = fields.filter(f => f.reqd || f.bold && !f.read_only)\n\n\t\t\t\trequired.map(f => {\n\t\t\t\t\tif(f.fieldname == 'content' && doc.type == 'File') {\n\t\t\t\t\t\tf['read_only'] = 1;\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\tconst dialog   = new frappe.ui.Dialog({\n\t\t\t\t\t title: __(`Edit ${doctype} (${docname})`),\n\t\t\t\t\tfields: required,\n\t\t\t\t\taction: {\n\t\t\t\t\t\tprimary: {\n\t\t\t\t\t\t\t   label: __(\"Save\"),\n\t\t\t\t\t\t\tonsubmit: (values) => {\n\t\t\t\t\t\t\t\tfrappe.call('frappe.client.save',\n\t\t\t\t\t\t\t\t\t{ doc: { doctype: doctype, docname: docname, ...doc, ...values } })\n\t\t\t\t\t\t\t\t\t  .then(r => {\n\t\t\t\t\t\t\t\t\t\tif ( fn )\n\t\t\t\t\t\t\t\t\t\t\tfn(r.message)\n\n\t\t\t\t\t\t\t\t\t\tresolve(r.message)\n\t\t\t\t\t\t\t\t\t  })\n\n\t\t\t\t\t\t\t\tdialog.hide()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsecondary: {\n\t\t\t\t\t\t\tlabel: __(\"Discard\")\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\tdialog.set_values(doc)\n\n\t\t\t\tconst $element = $(dialog.body)\n\t\t\t\t$element.append(`\n\t\t\t\t\t<div class=\"qe-fp\" style=\"padding-top: '15px'; padding-bottom: '15px'; padding-left: '7px'\">\n\t\t\t\t\t\t<button class=\"btn btn-default btn-sm\">\n\t\t\t\t\t\t\t${__(\"Edit in Full Page\")}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t`)\n\t\t\t\t$element.find('.qe-fp').click(() => {\n\t\t\t\t\tdialog.hide()\n\t\t\t\t\tfrappe.set_route(`Form/${doctype}/${docname}`)\n\t\t\t\t})\n\n\t\t\t\tdialog.show()\n\t\t\t})\n\t\t})\n\t})\n}\n\n// frappe._\n// frappe's utility namespace.\nfrappe.provide('frappe._')\n\n// String Utilities\n\n/**\n * @description Python-inspired format extension for string objects.\n *\n * @param  {string} string - A string with placeholders.\n * @param  {object} object - An object with placeholder, value pairs.\n *\n * @return {string}        - The formatted string.\n *\n * @example\n * frappe._.format('{foo} {bar}', { bar: 'foo', foo: 'bar' })\n * // returns \"bar foo\"\n */\nfrappe._.format = (string, object) => {\n\tfor (const key in object)\n\t\tstring  = string.replace(`{${key}}`, object[key])\n\n\treturn string\n}\n\n/**\n * @description Fuzzy Search a given query within a dataset.\n *\n * @param  {string} query   - A query string.\n * @param  {array}  dataset - A dataset to search within, can contain singletons or objects.\n * @param  {object} options - Options as per fuze.js\n *\n * @return {array}          - The fuzzy matched index/object within the dataset.\n *\n * @example\n * frappe._.fuzzy_search(\"foobar\", [\"foobar\", \"bartender\"])\n * // returns [0, 1]\n *\n * @see http://fusejs.io\n */\nfrappe._.fuzzy_search = (query, dataset, options) => {\n\tconst DEFAULT     = {\n\t\t\t\tshouldSort: true,\n\t\t\t\t threshold: 0.6,\n\t\t\t\t  location: 0,\n\t\t\t\t  distance: 100,\n\t\tminMatchCharLength: 1,\n\t\t  maxPatternLength: 32\n\t}\n\toptions       = { ...DEFAULT, ...options }\n\n\tconst fuse    = new Fuse(dataset, options)\n\tconst result  = fuse.search(query)\n\n\treturn result\n}\n\n/**\n * @description Pluralizes a given word.\n *\n * @param  {string} word  - The word to be pluralized.\n * @param  {number} count - The count.\n *\n * @return {string}       - The pluralized string.\n *\n * @example\n * frappe._.pluralize('member',  1)\n * // returns \"member\"\n * frappe._.pluralize('members', 0)\n * // returns \"members\"\n *\n * @todo Handle more edge cases.\n */\nfrappe._.pluralize = (word, count = 0, suffix = 's') => `${word}${count === 1 ? '' : suffix}`\n\n/**\n * @description Captializes a given string.\n *\n * @param   {word}  - The word to be capitalized.\n *\n * @return {string} - The capitalized word.\n *\n * @example\n * frappe._.capitalize('foobar')\n * // returns \"Foobar\"\n */\nfrappe._.capitalize = word => `${word.charAt(0).toUpperCase()}${word.slice(1)}`\n\n// Array Utilities\n\n/**\n * @description Returns the first element of an array.\n *\n * @param   {array} array - The array.\n *\n * @returns - The first element of an array, undefined elsewise.\n *\n * @example\n * frappe._.head([1, 2, 3])\n * // returns 1\n * frappe._.head([])\n * // returns undefined\n */\nfrappe._.head = arr => frappe._.is_empty(arr) ? undefined : arr[0]\n\n/**\n * @description Returns a copy of the given array (shallow).\n *\n * @param   {array} array - The array to be copied.\n *\n * @returns {array}       - The copied array.\n *\n * @example\n * frappe._.copy_array([\"foobar\", \"barfoo\"])\n * // returns [\"foobar\", \"barfoo\"]\n *\n * @todo Add optional deep copy.\n */\nfrappe._.copy_array = array => {\n\tif ( Array.isArray(array) )\n\t\treturn array.slice()\n\telse\n\t\tthrow frappe.TypeError(`Expected Array, recieved ${typeof array} instead.`)\n}\n\n/**\n * @description Check whether an array|string|object|jQuery is empty.\n *\n * @param   {any}     value - The value to be checked on.\n *\n * @returns {boolean}       - Returns if the object is empty.\n *\n * @example\n * frappe._.is_empty([])      // returns true\n * frappe._.is_empty([\"foo\"]) // returns false\n *\n * frappe._.is_empty(\"\")      // returns true\n * frappe._.is_empty(\"foo\")   // returns false\n *\n * frappe._.is_empty({ })            // returns true\n * frappe._.is_empty({ foo: \"bar\" }) // returns false\n *\n * frappe._.is_empty($('.papito'))   // returns false\n *\n * @todo Handle other cases.\n */\nfrappe._.is_empty = value => {\n\tlet empty = false\n\n\tif ( value === undefined || value === null )\n\t\tempty = true\n\telse\n\tif ( Array.isArray(value) || typeof value === 'string' || value instanceof $ )\n\t\tempty = value.length === 0\n\telse\n\tif ( typeof value === 'object' )\n\t\tempty = Object.keys(value).length === 0\n\n\treturn empty\n}\n\n/**\n * @description Converts a singleton to an array, if required.\n *\n * @param {object} item - An object\n *\n * @example\n * frappe._.as_array(\"foo\")\n * // returns [\"foo\"]\n *\n * frappe._.as_array([\"foo\"])\n * // returns [\"foo\"]\n *\n * @see https://docs.oracle.com/javase/8/docs/api/java/util/Arrays.html#asList-T...-\n */\nfrappe._.as_array = item => Array.isArray(item) ? item : [item]\n\n/**\n * @description Return a singleton if array contains a single element.\n *\n * @param   {array}        list - An array to squash.\n *\n * @returns {array|object}      - Returns an array if there's more than 1 object else the first object itself.\n *\n * @example\n * frappe._.squash([\"foo\"])\n * // returns \"foo\"\n *\n * frappe._.squash([\"foo\", \"bar\"])\n * // returns [\"foo\", \"bar\"]\n */\nfrappe._.squash = list => Array.isArray(list) && list.length === 1 ? list[0] : list\n\n/**\n * @description Returns true, if the current device is a mobile device.\n *\n * @example\n * frappe._.is_mobile()\n * // returns true|false\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/HTTP/Browser_detection_using_the_user_agent\n */\nfrappe._.is_mobile = () => {\n\tconst regex    = new RegExp(\"Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini\", \"i\")\n\tconst agent    = navigator.userAgent\n\tconst mobile   = regex.test(agent)\n\n\treturn mobile\n}\n\n/**\n * @description Removes falsey values from an array.\n *\n * @example\n * frappe._.compact([1, 2, false, NaN, ''])\n * // returns [1, 2]\n */\nfrappe._.compact   = array => array.filter(Boolean)\n\n// extend utils to base.\nfrappe.utils       = { ...frappe.utils, ...frappe._ }\n\n// frappe extensions\n\n// frappe.user extensions\n/**\n * @description Returns the first name of a User.\n *\n * @param {string} user - User\n *\n * @returns The first name of the user.\n *\n * @example\n * frappe.user.first_name(\"Rahul Malhotra\")\n * // returns \"Rahul\"\n */\nfrappe.provide('frappe.user')\nfrappe.user.first_name = user => frappe._.head(frappe.user.full_name(user).split(\" \"))\n\nfrappe.provide('frappe.ui.keycode')\nfrappe.ui.keycode = { RETURN: 13 }\n\n/**\n * @description Frappe's Store Class\n */\n // frappe.stores  - A registry for frappe stores.\nfrappe.provide('frappe.stores')\nfrappe.stores = [ ]\nfrappe.Store  = class\n{\n\t/**\n\t * @description Frappe's Store Class's constructor.\n\t *\n\t * @param {string} name - Name of the logger.\n\t */\n\tconstructor (name) {\n\t\tif ( typeof name !== 'string' )\n\t\t\tthrow new frappe.TypeError(`Expected string for name, got ${typeof name} instead.`)\n\t\tthis.name = name\n\t}\n\n\t/**\n\t * @description Get instance of frappe.Store (return registered one if declared).\n\t *\n\t * @param {string} name - Name of the store.\n\t */\n\tstatic get (name) {\n\t\tif ( !(name in frappe.stores) )\n\t\t\tfrappe.stores[name] = new frappe.Store(name)\n\t\treturn frappe.stores[name]\n\t}\n\n\tset (key, value) { localStorage.setItem(`${this.name}:${key}`, value) }\n\tget (key, value) { return localStorage.getItem(`${this.name}:${key}`) }\n}\n\n// frappe.loggers - A registry for frappe loggers.\nfrappe.provide('frappe.loggers')\n/**\n * @description Frappe's Logger Class\n *\n * @example\n * frappe.log       = frappe.Logger.get('foobar')\n * frappe.log.level = frappe.Logger.DEBUG\n *\n * frappe.log.info('foobar')\n * // prints '[timestamp] foobar: foobar'\n */\nfrappe.Logger = class {\n\t/**\n\t * @description Frappe's Logger Class's constructor.\n\t *\n\t * @param {string} name - Name of the logger.\n\t */\n\tconstructor (name, level) {\n\t\tif ( typeof name !== 'string' )\n\t\t\tthrow new frappe.TypeError(`Expected string for name, got ${typeof name} instead.`)\n\n\t\tthis.name   = name\n\t\tthis.level  = level\n\n\t\tif ( !this.level ) {\n\t\t\tif ( frappe.boot.developer_mode )\n\t\t\t\tthis.level = frappe.Logger.ERROR\n\t\t\telse\n\t\t\t\tthis.level = frappe.Logger.NOTSET\n\t\t}\n\t\tthis.format = frappe.Logger.FORMAT\n\t}\n\n\t/**\n\t * @description Get instance of frappe.Logger (return registered one if declared).\n\t *\n\t * @param {string} name - Name of the logger.\n\t */\n\tstatic get (name, level) {\n\t\tif ( !(name in frappe.loggers) )\n\t\t\tfrappe.loggers[name] = new frappe.Logger(name, level)\n\t\treturn frappe.loggers[name]\n\t}\n\n\tdebug (message) { this.log(message, frappe.Logger.DEBUG) }\n\tinfo  (message) { this.log(message, frappe.Logger.INFO)  }\n\twarn  (message) { this.log(message, frappe.Logger.WARN)  }\n\terror (message) { this.log(message, frappe.Logger.ERROR) }\n\n\tlog (message, level) {\n\t\tconst timestamp   = frappe.datetime.now()\n\n\t\tif ( level.value <= this.level.value ) {\n\t\t\tconst format  = frappe._.format(this.format, {\n\t\t\t\ttime: timestamp.format('HH:mm:ss'),\n\t\t\t\tname: this.name\n\t\t\t})\n\t\t\tconsole.log(`%c ${format}:`, `color: ${level.color}`, message)\n\t\t}\n\t}\n}\n\nfrappe.Logger.DEBUG  = { value: 10, color: '#616161', name: 'DEBUG'  }\nfrappe.Logger.INFO   = { value: 20, color: '#2196F3', name: 'INFO'   }\nfrappe.Logger.WARN   = { value: 30, color: '#FFC107', name: 'WARN'   }\nfrappe.Logger.ERROR  = { value: 40, color: '#F44336', name: 'ERROR'  }\nfrappe.Logger.NOTSET = { value:  0,                   name: 'NOTSET' }\n\nfrappe.Logger.FORMAT = '{time} {name}'\n\n// frappe.chat\nfrappe.provide('frappe.chat')\n\nfrappe.log = frappe.Logger.get('frappe.chat', frappe.Logger.NOTSET)\n\n// frappe.chat.profile\nfrappe.provide('frappe.chat.profile')\n\n/**\n * @description Create a Chat Profile.\n *\n * @param   {string|array} fields - (Optional) fields to be retrieved after creating a Chat Profile.\n * @param   {function}     fn     - (Optional) callback with the returned Chat Profile.\n *\n * @returns {Promise}\n *\n * @example\n * frappe.chat.profile.create(console.log)\n *\n * frappe.chat.profile.create(\"status\").then(console.log) // { status: \"Online\" }\n */\nfrappe.chat.profile.create = (fields, fn) => {\n\tif ( typeof fields === \"function\" ) {\n\t\tfn     = fields\n\t\tfields = null\n\t} else\n\tif ( typeof fields === \"string\" )\n\t\tfields = frappe._.as_array(fields)\n\n\treturn new Promise(resolve => {\n\t\tfrappe.call(\"frappe.chat.doctype.chat_profile.chat_profile.create\",\n\t\t\t{ user: frappe.session.user, exists_ok: true, fields: fields },\n\t\t\t\tresponse => {\n\t\t\t\t\tif ( fn )\n\t\t\t\t\t\tfn(response.message)\n\n\t\t\t\t\tresolve(response.message)\n\t\t\t\t})\n\t})\n}\n\n/**\n * @description Updates a Chat Profile.\n *\n * @param   {string} user   - (Optional) Chat Profile User, defaults to session user.\n * @param   {object} update - (Required) Updates to be dispatched.\n *\n * @example\n * frappe.chat.profile.update(frappe.session.user, { \"status\": \"Offline\" })\n */\nfrappe.chat.profile.update = (user, update, fn) => {\n\treturn new Promise(resolve => {\n\t\tfrappe.call(\"frappe.chat.doctype.chat_profile.chat_profile.update\",\n\t\t\t{ user: user || frappe.session.user, data: update },\n\t\t\t\tresponse => {\n\t\t\t\t\tif ( fn )\n\t\t\t\t\t\tfn(response.message)\n\n\t\t\t\t\tresolve(response.message)\n\t\t\t\t})\n\t})\n}\n\n// frappe.chat.profile.on\nfrappe.provide('frappe.chat.profile.on')\n\n/**\n * @description Triggers on a Chat Profile update of a user (Only if there's a one-on-one conversation).\n *\n * @param   {function} fn - (Optional) callback with the User and the Chat Profile update.\n *\n * @returns {Promise}\n *\n * @example\n * frappe.chat.profile.on.update(function (user, update)\n * {\n *      // do stuff\n * })\n */\nfrappe.chat.profile.on.update = function (fn) {\n\tfrappe.realtime.on(\"frappe.chat.profile:update\", r => fn(r.user, r.data))\n}\nfrappe.chat.profile.STATUSES\n=\n[\n\t{\n\t\tname: \"Online\",\n\t   color: \"green\"\n\t},\n\t{\n\t\t name: \"Away\",\n\t\tcolor: \"yellow\"\n\t},\n\t{\n\t\t name: \"Busy\",\n\t\tcolor: \"red\"\n\t},\n\t{\n\t\t name: \"Offline\",\n\t\tcolor: \"darkgrey\"\n\t}\n]\n\n// frappe.chat.room\nfrappe.provide('frappe.chat.room')\n\n/**\n * @description Creates a Chat Room.\n *\n * @param   {string}       kind  - (Required) \"Direct\", \"Group\" or \"Visitor\".\n * @param   {string}       owner - (Optional) Chat Room owner (defaults to current user).\n * @param   {string|array} users - (Required for \"Direct\" and \"Visitor\", Optional for \"Group\") User(s) within Chat Room.\n * @param   {string}       name  - Chat Room name.\n * @param   {function}     fn    - callback with created Chat Room.\n *\n * @returns {Promise}\n *\n * @example\n * frappe.chat.room.create(\"Direct\", frappe.session.user, \"foo@bar.com\", function (room) {\n *      // do stuff\n * })\n * frappe.chat.room.create(\"Group\",  frappe.session.user, [\"santa@gmail.com\", \"banta@gmail.com\"], \"Santa and Banta\", function (room) {\n *      // do stuff\n * })\n */\nfrappe.chat.room.create = function (kind, owner, users, name, fn) {\n\tif ( typeof name === \"function\" ) {\n\t\tfn   = name\n\t\tname = null\n\t}\n\n\tusers    = frappe._.as_array(users)\n\n\treturn new Promise(resolve => {\n\t\tfrappe.call(\"frappe.chat.doctype.chat_room.chat_room.create\",\n\t\t\t{ kind: kind, owner: owner || frappe.session.user, users: users, name: name },\n\t\t\tr => {\n\t\t\t\tlet room = r.message\n\t\t\t\troom     = { ...room, creation: new frappe.datetime.datetime(room.creation) }\n\n\t\t\t\tif ( fn )\n\t\t\t\t\tfn(room)\n\n\t\t\t\tresolve(room)\n\t\t\t})\n\t})\n}\n\n/**\n * @description Returns Chat Room(s).\n *\n * @param   {string|array} names   - (Optional) Chat Room(s) to retrieve.\n * @param   {string|array} fields  - (Optional) fields to be retrieved for each Chat Room.\n * @param   {function}     fn      - (Optional) callback with the returned Chat Room(s).\n *\n * @returns {Promise}\n *\n * @example\n * frappe.chat.room.get(function (rooms) {\n *      // do stuff\n * })\n * frappe.chat.room.get().then(function (rooms) {\n *      // do stuff\n * })\n *\n * frappe.chat.room.get(null, [\"room_name\", \"avatar\"], function (rooms) {\n *      // do stuff\n * })\n *\n * frappe.chat.room.get(\"CR00001\", \"room_name\", function (room) {\n *      // do stuff\n * })\n *\n * frappe.chat.room.get([\"CR00001\", \"CR00002\"], [\"room_name\", \"last_message\"], function (rooms) {\n *\n * })\n */\nfrappe.chat.room.get = function (names, fields, fn) {\n\tif ( typeof names === \"function\" ) {\n\t\tfn     = names\n\t\tnames  = null\n\t\tfields = null\n\t}\n\telse\n\tif ( typeof names === \"string\" ) {\n\t\tnames  = frappe._.as_array(names)\n\n\t\tif ( typeof fields === \"function\" ) {\n\t\t\tfn     = fields\n\t\t\tfields = null\n\t\t}\n\t\telse\n\t\tif ( typeof fields === \"string\" )\n\t\t\tfields = frappe._.as_array(fields)\n\t}\n\n\treturn new Promise(resolve => {\n\t\tfrappe.call(\"frappe.chat.doctype.chat_room.chat_room.get\",\n\t\t\t{ user: frappe.session.user, rooms: names, fields: fields },\n\t\t\t\tresponse => {\n\t\t\t\t\tlet rooms = response.message\n\t\t\t\t\tif ( rooms ) { // frappe.api BOGZ! (emtpy arrays are falsified, not good design).\n\t\t\t\t\t\trooms = frappe._.as_array(rooms)\n\t\t\t\t\t\trooms = rooms.map(room => {\n\t\t\t\t\t\t\treturn { ...room, creation: new frappe.datetime.datetime(room.creation),\n\t\t\t\t\t\t\t\tlast_message: room.last_message ? {\n\t\t\t\t\t\t\t\t\t...room.last_message,\n\t\t\t\t\t\t\t\t\tcreation: new frappe.datetime.datetime(room.last_message.creation)\n\t\t\t\t\t\t\t\t} : null\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\trooms = frappe._.squash(rooms)\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\trooms = [ ]\n\n\t\t\t\t\tif ( fn )\n\t\t\t\t\t\tfn(rooms)\n\n\t\t\t\t\tresolve(rooms)\n\t\t\t\t})\n\t})\n}\n\n/**\n * @description Subscribe current user to said Chat Room(s).\n *\n * @param {string|array} rooms - Chat Room(s).\n *\n * @example\n * frappe.chat.room.subscribe(\"CR00001\")\n */\nfrappe.chat.room.subscribe = function (rooms) {\n\tfrappe.realtime.publish(\"frappe.chat.room:subscribe\", rooms)\n}\n\n/**\n * @description Get Chat Room history.\n *\n * @param   {string} name - Chat Room name\n *\n * @returns {Promise}     - Chat Message(s)\n *\n * @example\n * frappe.chat.room.history(function (messages)\n * {\n *      // do stuff.\n * })\n */\nfrappe.chat.room.history = function (name, fn) {\n\treturn new Promise(resolve => {\n\t\tfrappe.call(\"frappe.chat.doctype.chat_room.chat_room.history\",\n\t\t\t{ room: name, user: frappe.session.user },\n\t\t\t\tr => {\n\t\t\t\t\tlet messages = r.message ? frappe._.as_array(r.message) : [ ] // frappe.api BOGZ! (emtpy arrays are falsified, not good design).\n\t\t\t\t\tmessages     = messages.map(m => {\n\t\t\t\t\t\treturn { ...m,\n\t\t\t\t\t\t\tcreation: new frappe.datetime.datetime(m.creation)\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\n\t\t\t\t\tif ( fn )\n\t\t\t\t\t\tfn(messages)\n\n\t\t\t\t\tresolve(messages)\n\t\t\t\t})\n\t})\n}\n\n/**\n * @description Searches Rooms based on a query.\n *\n * @param   {string} query - The query string.\n * @param   {array}  rooms - A list of Chat Rooms.\n *\n * @returns {array}        - A fuzzy searched list of rooms.\n */\nfrappe.chat.room.search = function (query, rooms) {\n\tconst dataset = rooms.map(r => {\n\t\tif ( r.room_name )\n\t\t\treturn r.room_name\n\t\telse\n\t\t\tif ( r.owner === frappe.session.user )\n\t\t\t\treturn frappe.user.full_name(frappe._.squash(r.users))\n\t\t\telse\n\t\t\t\treturn frappe.user.full_name(r.owner)\n\t})\n\tconst results = frappe._.fuzzy_search(query, dataset)\n\trooms         = results.map(i => rooms[i])\n\n\treturn rooms\n}\n\n/**\n * @description Sort Chat Room(s) based on Last Message Timestamp or Creation Date.\n *\n * @param {array}   - A list of Chat Room(s)\n * @param {compare} - (Optional) a comparision function.\n */\nfrappe.chat.room.sort = function (rooms, compare = null) {\n\tcompare = compare || function (a, b) {\n\t\tif ( a.last_message && b.last_message )\n\t\t\treturn frappe.datetime.compare(a.last_message.creation, b.last_message.creation)\n\t\telse\n\t\tif ( a.last_message )\n\t\t\treturn frappe.datetime.compare(a.last_message.creation, b.creation)\n\t\telse\n\t\tif ( b.last_message )\n\t\t\treturn frappe.datetime.compare(a.creation, b.last_message.creation)\n\t\telse\n\t\t\treturn frappe.datetime.compare(a.creation, b.creation)\n\t}\n\trooms.sort(compare)\n\n\treturn rooms\n}\n\n// frappe.chat.room.on\nfrappe.provide('frappe.chat.room.on')\n\n/**\n * @description Triggers on Chat Room updated.\n *\n * @param {function} fn - callback with the Chat Room and Update.\n */\nfrappe.chat.room.on.update = function (fn) {\n\tfrappe.realtime.on(\"frappe.chat.room:update\", r => {\n\t\tif ( r.data.last_message )\n\t\t\t// creation to frappe.datetime.datetime (easier to manipulate).\n\t\t\tr.data = { ...r.data, last_message: { ...r.data.last_message, creation: new frappe.datetime.datetime(r.data.last_message.creation) } }\n\n\t\tfn(r.room, r.data)\n\t})\n}\n\n/**\n * @description Triggers on Chat Room created.\n *\n * @param {function} fn - callback with the created Chat Room.\n */\nfrappe.chat.room.on.create = function (fn) {\n\tfrappe.realtime.on(\"frappe.chat.room:create\", r =>\n\t\tfn({ ...r, creation: new frappe.datetime.datetime(r.creation) })\n\t)\n}\n\n/**\n * @description Triggers when a User is typing in a Chat Room.\n *\n * @param {function} fn - callback with the typing User within the Chat Room.\n */\nfrappe.chat.room.on.typing = function (fn) {\n\tfrappe.realtime.on(\"frappe.chat.room:typing\", r => fn(r.room, r.user))\n}\n\n// frappe.chat.message\nfrappe.provide('frappe.chat.message')\n\nfrappe.chat.message.typing = function (room, user) {\n\tfrappe.realtime.publish(\"frappe.chat.message:typing\", { user: user || frappe.session.user, room: room })\n}\n\nfrappe.chat.message.send   = function (room, message, type = \"Content\") {\n\tfrappe.call(\"frappe.chat.doctype.chat_message.chat_message.send\",\n\t\t{ user: frappe.session.user, room: room, content: message, type: type })\n}\n\nfrappe.chat.message.update = function (message, update, fn) {\n\treturn new Promise(resolve => {\n\t\tfrappe.call('frappe.chat.doctype.chat_message.chat_message.update',\n\t\t\t{ user: frappe.session.user, message: message, update: update },\n\t\t\tr =>  {\n\t\t\t\tif ( fn )\n\t\t\t\t\tfn(response.message)\n\n\t\t\t\tresolve(response.message)\n\t\t\t})\n\t})\n}\n\nfrappe.chat.message.sort   = (messages) => {\n\tif ( !frappe._.is_empty(messages) )\n\t\tmessages.sort((a, b) => frappe.datetime.compare(b.creation, a.creation))\n\n\treturn messages\n}\n\n/**\n * @description Add user to seen (defaults to session.user)\n */\nfrappe.chat.message.seen   = (mess, user) => {\n\tfrappe.call('frappe.chat.doctype.chat_message.chat_message.seen',\n\t\t{ message: mess, user: user || frappe.session.user })\n}\n\nfrappe.provide('frappe.chat.message.on')\nfrappe.chat.message.on.create = function (fn) {\n\tfrappe.realtime.on(\"frappe.chat.message:create\", r =>\n\t\tfn({ ...r, creation: new frappe.datetime.datetime(r.creation) })\n\t)\n}\n\nfrappe.chat.message.on.update = function (fn) {\n\tfrappe.realtime.on(\"frappe.chat.message:update\", r => fn(r.message, r.data))\n}\n\nfrappe.chat.pretty_datetime   = function (date) {\n\tconst today    = moment()\n\tconst instance = date.moment\n\n\tif ( today.isSame(instance, \"d\") )\n\t\treturn instance.format(\"hh:mm A\")\n\telse\n\tif ( today.isSame(instance, \"week\") )\n\t\treturn instance.format(\"dddd\")\n\telse\n\t\treturn instance.format(\"DD/MM/YYYY\")\n}\n\n// frappe.chat.sound\nfrappe.provide('frappe.chat.sound')\n\n/**\n * @description Plays a given registered sound.\n *\n * @param {value} - The name of the registered sound.\n *\n * @example\n * frappe.chat.sound.play(\"message\")\n */\nfrappe.chat.sound.play  = function (name, volume = 0.1) {\n\t// frappe._.play_sound(`chat-${name}`)\n\tconst $audio = $(`<audio class=\"chat-audio\"/>`)\n\t$audio.attr('volume', volume)\n\n\tif  ( frappe._.is_empty($audio) )\n\t\t$(document).append($audio)\n\n\tif  ( !$audio.paused ) {\n\t\tfrappe.log.info('Stopping sound playing.')\n\t\t$audio[0].pause()\n\t\t$audio.attr('currentTime', 0)\n\t}\n\n\tfrappe.log.info('Playing sound.')\n\t$audio.attr('src', `${frappe.chat.sound.PATH}/chat-${name}.mp3`)\n\t$audio[0].play()\n}\nfrappe.chat.sound.PATH  = '/assets/frappe/sounds'\n\n// frappe.chat.emoji\nfrappe.chat.emojis = [ ]\nfrappe.chat.emoji  = function (fn) {\n\treturn new Promise(resolve => {\n\t\tif ( !frappe._.is_empty(frappe.chat.emojis) ) {\n\t\t\tif ( fn )\n\t\t\t\tfn(frappe.chat.emojis)\n\n\t\t\tresolve(frappe.chat.emojis)\n\t\t}\n\t\telse\n\t\t\t$.get('https://cdn.rawgit.com/frappe/emoji/master/emoji', (data) => {\n\t\t\t\tfrappe.chat.emojis = JSON.parse(data)\n\n\t\t\t\tif ( fn )\n\t\t\t\t\tfn(frappe.chat.emojis)\n\n\t\t\t\tresolve(frappe.chat.emojis)\n\t\t\t})\n\t})\n}\n\n// Website Settings\nfrappe.provide('frappe.chat.website.settings')\nfrappe.chat.website.settings = (fields, fn) =>\n{\n\tif ( typeof fields === \"function\" ) {\n\t\tfn     = fields\n\t\tfields = null\n\t} else\n\tif ( typeof fields === \"string\" )\n\t\tfields = frappe._.as_array(fields)\n\n\treturn new Promise(resolve => {\n\t\tfrappe.call(\"frappe.chat.website.settings\",\n\t\t\t{ fields: fields })\n\t\t\t.then(response => {\n\t\t\t\tvar message = response.message\n\n\t\t\t\tif ( message.enable_from )\n\t\t\t\t\tmessage   = { ...message, enable_from: new frappe.datetime.datetime(message.enable_from, 'HH:mm:ss') }\n\t\t\t\tif ( message.enable_to )\n\t\t\t\t\tmessage   = { ...message, enable_to:   new frappe.datetime.datetime(message.enable_to,   'HH:mm:ss') }\n\n\t\t\t\tif ( fn )\n\t\t\t\t\tfn(message)\n\n\t\t\t\tresolve(message)\n\t\t\t})\n\t})\n}\n\nfrappe.chat.website.token    = (fn) =>\n{\n\treturn new Promise(resolve => {\n\t\tfrappe.call(\"frappe.chat.website.token\")\n\t\t\t.then(response => {\n\t\t\t\tif ( fn )\n\t\t\t\t\tfn(response.message)\n\n\t\t\t\tresolve(response.message)\n\t\t\t})\n\t})\n}\n\nconst { h, Component } = hyper\n\n// frappe.components\n// frappe's component namespace.\nfrappe.provide('frappe.components')\n\nfrappe.provide('frappe.chat.component')\n\n/**\n * @description Button Component\n *\n * @prop {string}  type  - (Optional) \"default\", \"primary\", \"info\", \"success\", \"warning\", \"danger\" (defaults to \"default\")\n * @prop {boolean} block - (Optional) Render a button block (defaults to false).\n */\nfrappe.components.Button\n=\nclass extends Component {\n\trender ( ) {\n\t\tconst { props } = this\n\t\tconst size      = frappe.components.Button.SIZE[props.size]\n\n\t\treturn (\n\t\t\th(\"button\", { ...props, class: `btn ${size && size.class} btn-${props.type} ${props.block ? \"btn-block\" : \"\"} ${props.class ? props.class : \"\"}` },\n\t\t\t\tprops.children\n\t\t\t)\n\t\t)\n\t}\n}\nfrappe.components.Button.SIZE\n=\n{\n\tsmall: {\n\t\tclass: \"btn-sm\"\n\t},\n\tlarge: {\n\t\tclass: \"btn-lg\"\n\t}\n}\nfrappe.components.Button.defaultProps\n=\n{\n\t type: \"default\",\n\tblock: false\n}\n\n/**\n * @description FAB Component\n *\n * @extends frappe.components.Button\n */\nfrappe.components.FAB\n=\nclass extends frappe.components.Button {\n\trender ( ) {\n\t\tconst { props } = this\n\t\tconst size      = frappe.components.FAB.SIZE[props.size]\n\n\t\treturn (\n\t\t\th(frappe.components.Button, { ...props, class: `${props.class} ${size && size.class}`},\n\t\t\t\th(\"i\", { class: props.icon })\n\t\t\t)\n\t\t)\n\t}\n}\nfrappe.components.FAB.defaultProps\n=\n{\n\ticon: \"octicon octicon-plus\"\n}\nfrappe.components.FAB.SIZE\n=\n{\n\tsmall:\n\t{\n\t\tclass: \"frappe-fab-sm\"\n\t},\n\tlarge:\n\t{\n\t\tclass: \"frappe-fab-lg\"\n\t}\n}\n\n/**\n * @description Octicon Component\n *\n * @prop color - (Required) color for the indicator\n */\nfrappe.components.Indicator\n=\nclass extends Component {\n\trender ( ) {\n\t\tconst { props } = this\n\n\t\treturn props.color ? h(\"span\", { ...props, class: `indicator ${props.color}` }) : null\n\t}\n}\n\n/**\n * @description FontAwesome Component\n */\nfrappe.components.FontAwesome\n=\nclass extends Component {\n\trender ( ) {\n\t\tconst { props } = this\n\n\t\treturn props.type ? h(\"i\", { ...props, class: `fa ${props.fixed ? \"fa-fw\" : \"\"} fa-${props.type} ${props.class}` }) : null\n\t}\n}\nfrappe.components.FontAwesome.defaultProps\n=\n{\n\tfixed: false\n}\n\n/**\n * @description Octicon Component\n *\n * @extends frappe.Component\n */\nfrappe.components.Octicon\n=\nclass extends Component {\n\trender ( ) {\n\t\tconst { props } = this\n\n\t\treturn props.type ? h(\"i\", { ...props, class: `octicon octicon-${props.type}` }) : null\n\t}\n}\n\n/**\n * @description Avatar Component\n *\n * @prop {string} title - (Optional) title for the avatar.\n * @prop {string} abbr  - (Optional) abbreviation for the avatar, defaults to the first letter of the title.\n * @prop {string} size  - (Optional) size of the avatar to be displayed.\n * @prop {image}  image - (Optional) image for the avatar, defaults to the first letter of the title.\n */\nfrappe.components.Avatar\n=\nclass extends Component {\n\trender ( ) {\n\t\tconst { props } = this\n\t\tconst abbr      = props.abbr || props.title.substr(0, 1)\n\t\tconst size      = frappe.components.Avatar.SIZE[props.size] || frappe.components.Avatar.SIZE.medium\n\n\t\treturn (\n\t\t\th(\"span\", { class: `avatar ${size.class} ${props.class ? props.class : \"\"}` },\n\t\t\t\tprops.image ?\n\t\t\t\t\th(\"img\", { class: \"media-object\", src: props.image })\n\t\t\t\t\t:\n\t\t\t\t\th(\"div\", { class: \"standard-image\" }, abbr)\n\t\t\t)\n\t\t)\n\t}\n}\nfrappe.components.Avatar.SIZE\n=\n{\n\tsmall:\n\t{\n\t\tclass: \"avatar-small\"\n\t},\n\tlarge:\n\t{\n\t\tclass: \"avatar-large\"\n\t},\n\tmedium:\n\t{\n\t\tclass: \"avatar-medium\"\n\t}\n}\n\n/**\n * @description Frappe Chat Object.\n *\n * @example\n * const chat = new frappe.Chat(options) // appends to \"body\"\n * chat.render()\n * const chat = new frappe.Chat(\".selector\", options)\n * chat.render()\n *\n * const chat = new frappe.Chat()\n * chat.set_wrapper('.selector')\n *     .set_options(options)\n *     .render()\n */\nfrappe.Chat\n=\nclass {\n\t/**\n\t * @description Frappe Chat Object.\n\t *\n\t * @param {string} selector - A query selector, HTML Element or jQuery object.\n\t * @param {object} options  - Optional configurations.\n\t */\n\tconstructor (selector, options) {\n\t\tif ( !(typeof selector === \"string\" || selector instanceof $ || selector instanceof HTMLElement) ) {\n\t\t\toptions  = selector\n\t\t\tselector = null\n\t\t}\n\n\t\tthis.options = frappe.Chat.OPTIONS\n\n\t\tthis.set_wrapper(selector ? selector : \"body\")\n\t\tthis.set_options(options)\n\n\t\t// Load Emojis.\n\t\tfrappe.chat.emoji()\n\t}\n\n\t/**\n\t * Set the container on which the chat widget is mounted on.\n\t * @param   {string|HTMLElement} selector - A query selector, HTML Element or jQuery object.\n\t *\n\t * @returns {frappe.Chat}                 - The instance.\n\t *\n\t * @example\n\t * const chat = new frappe.Chat()\n\t * chat.set_wrapper(\".selector\")\n\t */\n\tset_wrapper (selector) {\n\t\tthis.$wrapper = $(selector)\n\n\t\treturn this\n\t}\n\n\t/**\n\t * Set the configurations for the chat interface.\n\t * @param   {object}      options - Optional Configurations.\n\t *\n\t * @returns {frappe.Chat}         - The instance.\n\t *\n\t * @example\n\t * const chat = new frappe.Chat()\n\t * chat.set_options({ layout: frappe.Chat.Layout.PAGE })\n\t */\n\tset_options (options) {\n\t\tthis.options = { ...this.options, ...options }\n\n\t\treturn this\n\t}\n\n\t/**\n\t * @description Destory the chat widget.\n\t *\n\t * @returns {frappe.Chat} - The instance.\n\t *\n\t * @example\n\t * const chat = new frappe.Chat()\n\t * chat.render()\n\t *     .destroy()\n\t */\n\tdestroy ( ) {\n\t\tconst $wrapper = this.$wrapper\n\t\t$wrapper.remove(\".frappe-chat\")\n\n\t\treturn this\n\t}\n\n\t/**\n\t * @description Render the chat widget component onto destined wrapper.\n\t *\n\t * @returns {frappe.Chat} - The instance.\n\t *\n\t * @example\n\t * const chat = new frappe.Chat()\n\t * chat.render()\n\t */\n\trender (props = { }) {\n\t\tthis.destroy()\n\n\t\tconst $wrapper   = this.$wrapper\n\t\tconst options    = this.options\n\n\t\tconst component  = h(frappe.Chat.Widget, {\n\t\t\tlayout: options.layout,\n\t\t\ttarget: options.target,\n\t\t\t...props\n\t\t})\n\n\t\thyper.render(component, $wrapper[0])\n\n\t\treturn this\n\t}\n}\nfrappe.Chat.Layout\n=\n{\n\tPAGE: \"page\", POPPER: \"popper\"\n}\nfrappe.Chat.OPTIONS\n=\n{\n\tlayout: frappe.Chat.Layout.POPPER\n}\n\n/**\n * @description The base Component for Frappe Chat\n */\nfrappe.Chat.Widget\n=\nclass extends Component {\n\tconstructor (props) {\n\t\tsuper (props)\n\n\t\tthis.setup(props)\n\t\tthis.make()\n\t}\n\n\tsetup (props) {\n\t\t// room actions\n\t\tthis.room           = { }\n\t\tthis.room.add       = rooms => {\n\t\t\trooms           = frappe._.as_array(rooms)\n\t\t\tconst names     = rooms.map(r => r.name)\n\n\t\t\tfrappe.log.info(`Subscribing ${frappe.session.user} to Chat Rooms ${names.join(\", \")}.`)\n\t\t\tfrappe.chat.room.subscribe(names)\n\n\t\t\tconst state     = [ ]\n\n\t\t\tfor (const room of rooms)\n\t\t\t\t  if ( [\"Group\", \"Visitor\"].includes(room.type) || room.owner === frappe.session.user || room.last_message || room.users.includes(frappe.session.user)) {\n\t\t\t\t\tfrappe.log.info(`Adding ${room.name} to component.`)\n\t\t\t\t\tstate.push(room)\n\t\t\t\t}\n\n\t\t\tthis.set_state({ rooms: [ ...this.state.rooms, ...state ] })\n\t\t}\n\t\tthis.room.update    = (room, update) => {\n\t\t\tconst { state } = this\n\t\t\tvar   exists    = false\n\t\t\tconst rooms     = state.rooms.map(r => {\n\t\t\t\tif ( r.name === room ) {\n\t\t\t\t\texists  = true\n\t\t\t\t\tif ( update.typing ) {\n\t\t\t\t\t\tif ( !frappe._.is_empty(r.typing) ) {\n\t\t\t\t\t\t\tconst usr = update.typing\n\t\t\t\t\t\t\tif ( !r.typing.includes(usr) ) {\n\t\t\t\t\t\t\t\tupdate.typing = frappe._.copy_array(r.typing)\n\t\t\t\t\t\t\t\tupdate.typing.push(usr)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tupdate.typing = frappe._.as_array(update.typing)\n\t\t\t\t\t}\n\n\t\t\t\t\treturn { ...r, ...update }\n\t\t\t\t}\n\n\t\t\t\treturn r\n\t\t\t})\n\n\t\t\tif ( frappe.session.user !== 'Guest' ) {\n\t\t\t\tif ( !exists )\n\t\t\t\t\tfrappe.chat.room.get(room, (room) => this.room.add(room))\n\t\t\t\telse\n\t\t\t\t\tthis.set_state({ rooms })\n\t\t\t}\n\n\t\t\tif ( state.room.name === room ) {\n\t\t\t\tif ( update.typing ) {\n\t\t\t\t\tif ( !frappe._.is_empty(state.room.typing) ) {\n\t\t\t\t\t\tconst usr = update.typing\n\t\t\t\t\t\tif ( !state.room.typing.includes(usr) ) {\n\t\t\t\t\t\t\tupdate.typing = frappe._.copy_array(state.room.typing)\n\t\t\t\t\t\t\tupdate.typing.push(usr)\n\t\t\t\t\t\t}\n\t\t\t\t\t} else\n\t\t\t\t\t\tupdate.typing = frappe._.as_array(update.typing)\n\t\t\t\t}\n\n\t\t\t\tconst room  = { ...state.room, ...update }\n\n\t\t\t\tthis.set_state({ room })\n\t\t\t}\n\t\t}\n\t\tthis.room.select    = (name) => {\n\t\t\tfrappe.chat.room.history(name, (messages) => {\n\t\t\t\tconst  { state } = this\n\t\t\t\tconst room       = state.rooms.find(r => r.name === name)\n\n\t\t\t\tthis.set_state({\n\t\t\t\t\troom: { ...state.room, ...room, messages: messages }\n\t\t\t\t})\n\t\t\t})\n\t\t}\n\n\t\tthis.state = { ...frappe.Chat.Widget.defaultState, ...props }\n\t}\n\n\tmake ( ) {\n\t\tif ( frappe.session.user !== 'Guest' ) {\n\t\t\tfrappe.chat.profile.create([\n\t\t\t\t\"status\", \"message_preview\", \"notification_tones\", \"conversation_tones\"\n\t\t\t]).then(profile => {\n\t\t\t\tthis.set_state({ profile })\n\n\t\t\t\tfrappe.chat.room.get(rooms => {\n\t\t\t\t\trooms = frappe._.as_array(rooms)\n\t\t\t\t\tfrappe.log.info(`User ${frappe.session.user} is subscribed to ${rooms.length} ${frappe._.pluralize('room', rooms.length)}.`)\n\n\t\t\t\t\tif ( !frappe._.is_empty(rooms) )\n\t\t\t\t\t\tthis.room.add(rooms)\n\t\t\t\t})\n\n\t\t\t\tthis.bind()\n\t\t\t})\n\t\t} else {\n\t\t\tthis.bind()\n\t\t}\n\t}\n\n\tbind ( ) {\n\t\tfrappe.chat.profile.on.update((user, update) => {\n\t\t\tfrappe.log.warn(`TRIGGER: Chat Profile update ${JSON.stringify(update)} of User ${user}.`)\n\n\t\t\tif ( 'status' in update ) {\n\t\t\t\tif ( user === frappe.session.user ) {\n\t\t\t\t\tthis.set_state({\n\t\t\t\t\t\tprofile: { ...this.state.profile, status: update.status }\n\t\t\t\t\t})\n\t\t\t\t} else {\n\t\t\t\t\tconst status = frappe.chat.profile.STATUSES.find(s => s.name === update.status)\n\t\t\t\t\tconst color  = status.color\n\n\t\t\t\t\tconst alert  = `<span class=\"indicator ${color}\"/> ${frappe.user.full_name(user)} is currently <b>${update.status}</b>`\n\t\t\t\t\tfrappe.show_alert(alert, 3)\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\n\t\tfrappe.chat.room.on.create((room) => {\n\t\t\tfrappe.log.warn(`TRIGGER: Chat Room ${room.name} created.`)\n\t\t\tthis.room.add(room)\n\t\t})\n\n\t\tfrappe.chat.room.on.update((room, update) => {\n\t\t\tfrappe.log.warn(`TRIGGER: Chat Room ${room} update ${JSON.stringify(update)} recieved.`)\n\t\t\tthis.room.update(room, update)\n\t\t})\n\n\t\tfrappe.chat.room.on.typing((room, user) => {\n\t\t\tif ( user !== frappe.session.user ) {\n\t\t\t\tfrappe.log.warn(`User ${user} typing in Chat Room ${room}.`)\n\t\t\t\tthis.room.update(room, { typing: user })\n\n\t\t\t\tsetTimeout(() => this.room.update(room, { typing: null }), 5000)\n\t\t\t}\n\t\t})\n\n\t\tfrappe.chat.message.on.create((r) => {\n\t\t\tconst { state } = this\n\n\t\t\t// play sound.\n\t\t\tif ( state.room.name )\n\t\t\t\tstate.profile.conversation_tones && frappe.chat.sound.play('message')\n\t\t\telse\n\t\t\t\tstate.profile.notification_tones && frappe.chat.sound.play('notification')\n\n\t\t\tif ( r.user !== frappe.session.user && state.profile.message_preview && !state.toggle ) {\n\t\t\t\tconst $element = $('body').find('.frappe-chat-alert')\n\t\t\t\t$element.remove()\n\n\t\t\t\tconst  alert   = // TODO: ellipses content\n\t\t\t\t`\n\t\t\t\t<span data-action=\"show-message\" class=\"cursor-pointer\">\n\t\t\t\t\t<span class=\"indicator yellow\"/>\n\t\t\t\t\t\t<span class=\"avatar avatar-small\">\n\t\t\t\t\t\t\t<span class=\"avatar-frame\" style=\"background-image: url(${frappe.user.image(r.user)})\"></span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<b>${frappe.user.first_name(r.user)}</b>: ${r.content}\n\t\t\t\t</span>\n\t\t\t\t`\n\t\t\t\tfrappe.show_alert(alert, 15, {\n\t\t\t\t\t\"show-message\": function (r) {\n\t\t\t\t\t\tthis.room.select(r.room)\n\t\t\t\t\t\tthis.base.firstChild._component.toggle()\n\t\t\t\t\t}.bind(this, r)\n\t\t\t\t})\n\t\t\t\tfrappe.notify(`${frappe.user.first_name(r.user)}`, {\n\t\t\t\t\tbody: r.content,\n\t\t\t\t\ticon: frappe.user.image(r.user),\n\t\t\t\t\ttag: r.user\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tif ( r.room === state.room.name ) {\n\t\t\t\tconst mess  = frappe._.copy_array(state.room.messages)\n\t\t\t\tmess.push(r)\n\n\t\t\t\tthis.set_state({ room: { ...state.room, messages: mess } })\n\t\t\t}\n\t\t})\n\n\t\tfrappe.chat.message.on.update((message, update) => {\n\t\t\tfrappe.log.warn(`TRIGGER: Chat Message ${message} update ${JSON.stringify(update)} recieved.`)\n\t\t})\n\t}\n\n\trender ( ) {\n\t\tconst { props, state } = this\n\t\tconst me               = this\n\n\t\tconst ActionBar        = h(frappe.Chat.Widget.ActionBar, {\n\t\t\tplaceholder: __(\"Search or Create a New Chat\"),\n\t\t\t\t  class: \"level\",\n\t\t\t\t layout: props.layout,\n\t\t\t\tactions:\n\t\t\tfrappe._.compact([\n\t\t\t\t{\n\t\t\t\t\t  label: __(\"New\"),\n\t\t\t\t\tonclick: function ( ) {\n\t\t\t\t\t\tconst dialog = new frappe.ui.Dialog({\n\t\t\t\t\t\t\t  title: __(\"New Chat\"),\n\t\t\t\t\t\t\t fields: [\n\t\t\t\t\t\t\t\t {\n\t\t\t\t\t\t\t\t\t\t label: __(\"Chat Type\"),\n\t\t\t\t\t\t\t\t\t fieldname: \"type\",\n\t\t\t\t\t\t\t\t\t fieldtype: \"Select\",\n\t\t\t\t\t\t\t\t\t   options: [\"Group\", \"Direct Chat\"],\n\t\t\t\t\t\t\t\t\t   default: \"Group\",\n\t\t\t\t\t\t\t\t\t  onchange: () =>  {\n\t\t\t\t\t\t\t\t\t\t\tconst type     = dialog.get_value(\"type\")\n\t\t\t\t\t\t\t\t\t\t\tconst is_group = type === \"Group\"\n\n\t\t\t\t\t\t\t\t\t\t\tdialog.set_df_property(\"group_name\", \"reqd\",  is_group)\n\t\t\t\t\t\t\t\t\t\t\tdialog.set_df_property(\"user\",       \"reqd\", !is_group)\n\t\t\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t\t\t },\n\t\t\t\t\t\t\t\t {\n\t\t\t\t\t\t\t\t\t\t label: __(\"Group Name\"),\n\t\t\t\t\t\t\t\t\t fieldname: \"group_name\",\n\t\t\t\t\t\t\t\t\t fieldtype: \"Data\",\n\t\t\t\t\t\t\t\t\t\t  reqd: true,\n\t\t\t\t\t\t\t\t\tdepends_on: \"eval:doc.type == 'Group'\"\n\t\t\t\t\t\t\t\t },\n\t\t\t\t\t\t\t\t {\n\t\t\t\t\t\t\t\t\t\t label: __(\"Users\"),\n\t\t\t\t\t\t\t\t\t fieldname: \"users\",\n\t\t\t\t\t\t\t\t\t fieldtype: \"MultiSelect\",\n\t\t\t\t\t\t\t\t\t   options: frappe.user.get_emails(),\n\t\t\t\t\t\t\t\t\tdepends_on: \"eval:doc.type == 'Group'\"\n\t\t\t\t\t\t\t\t },\n\t\t\t\t\t\t\t\t {\n\t\t\t\t\t\t\t\t\t\t label: __(\"User\"),\n\t\t\t\t\t\t\t\t\t fieldname: \"user\",\n\t\t\t\t\t\t\t\t\t fieldtype: \"Link\",\n\t\t\t\t\t\t\t\t\t   options: \"User\",\n\t\t\t\t\t\t\t\t\tdepends_on: \"eval:doc.type == 'Direct Chat'\"\n\t\t\t\t\t\t\t\t }\n\t\t\t\t\t\t\t ],\n\t\t\t\t\t\t\taction: {\n\t\t\t\t\t\t\t\tprimary: {\n\t\t\t\t\t\t\t\t\t   label: __('Create'),\n\t\t\t\t\t\t\t\t\tonsubmit: (values) => {\n\t\t\t\t\t\t\t\t\t\tif ( values.type === \"Group\" ) {\n\t\t\t\t\t\t\t\t\t\t\tif ( !frappe._.is_empty(values.users) ) {\n\t\t\t\t\t\t\t\t\t\t\t\tconst name  = values.group_name\n\t\t\t\t\t\t\t\t\t\t\t\tconst users = dialog.fields_dict.users.get_values()\n\n\t\t\t\t\t\t\t\t\t\t\t\tfrappe.chat.room.create(\"Group\",  null, users, name)\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tconst user      = values.user\n\n\t\t\t\t\t\t\t\t\t\t\tfrappe.chat.room.create(\"Direct\", null, user)\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tdialog.hide()\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\tdialog.show()\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfrappe._.is_mobile() && {\n\t\t\t\t\t   icon: \"octicon octicon-x\",\n\t\t\t\t\t   class: \"frappe-chat-close\",\n\t\t\t\t\tonclick: () => this.set_state({ toggle: false })\n\t\t\t\t}\n\t\t\t], Boolean),\n\t\t\tchange: query => { me.set_state({ query }) },\n\t\t\t  span: span  => { me.set_state({ span  }) },\n\t\t})\n\n\t\tvar   contacts   = [ ]\n\t\tif ( 'user_info' in frappe.boot ) {\n\t\t\tconst emails = frappe.user.get_emails()\n\t\t\tfor (const email of emails) {\n\t\t\t\tvar exists = false\n\n\t\t\t\tfor (const room of state.rooms) {\n\t\t\t\t\tif ( room.type === 'Direct' ) {\n\t\t\t\t\t\tif ( room.owner === email || frappe._.squash(room.users) === email )\n\t\t\t\t\t\t\texists = true\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( !exists )\n\t\t\t\t\tcontacts.push({ owner: frappe.session.user, users: [email] })\n\t\t\t}\n\t\t}\n\t\tconst rooms      = state.query ? frappe.chat.room.search(state.query, state.rooms.concat(contacts)) : frappe.chat.room.sort(state.rooms)\n\n\t\tconst layout     = state.span  ? frappe.Chat.Layout.PAGE : frappe.Chat.Layout.POPPER\n\n\t\tconst RoomList   = frappe._.is_empty(rooms) && !state.query ?\n\t\t\th(\"div\", { class: \"vcenter\" },\n\t\t\t\th(\"div\", { class: \"text-center text-extra-muted\" },\n\t\t\t\t\th(\"p\",\"\",__(\"You don't have any messages yet.\"))\n\t\t\t\t)\n\t\t\t)\n\t\t\t:\n\t\t\th(frappe.Chat.Widget.RoomList, { rooms: rooms, click: room =>  {\n\t\t\t\tif ( room.name )\n\t\t\t\t\tthis.room.select(room.name)\n\t\t\t\telse\n\t\t\t\t\tfrappe.chat.room.create(\"Direct\", room.owner, frappe._.squash(room.users), ({ name }) => this.room.select(name))\n\t\t\t}})\n\t\tconst Room       = h(frappe.Chat.Widget.Room, { ...state.room, layout: layout, destroy: () => {\n\t\t\tthis.set_state({\n\t\t\t\troom: { name: null, messages: [ ] }\n\t\t\t})\n\t\t}})\n\n\t\tconst component  = layout === frappe.Chat.Layout.POPPER ?\n\t\t\th(frappe.Chat.Widget.Popper, { heading: ActionBar, page: state.room.name && Room, target: props.target,\n\t\t\t\ttoggle: (t) => this.set_state({ toggle: t }) },\n\t\t\t\tRoomList\n\t\t\t)\n\t\t\t:\n\t\t\th(\"div\", { class: \"frappe-chat-popper\" },\n\t\t\t\th(\"div\", { class: \"frappe-chat-popper-collapse\" },\n\t\t\t\t\th(\"div\", { class: \"panel panel-default panel-span\", style: { width: \"25%\" } },\n\t\t\t\t\t\th(\"div\", { class: \"panel-heading\" },\n\t\t\t\t\t\t\tActionBar\n\t\t\t\t\t\t),\n\t\t\t\t\t\tRoomList\n\t\t\t\t\t),\n\t\t\t\t\tRoom\n\t\t\t\t)\n\t\t\t)\n\n\t\treturn (\n\t\t\th(\"div\", { class: \"frappe-chat\" },\n\t\t\t\tcomponent\n\t\t\t)\n\t\t)\n\t}\n}\nfrappe.Chat.Widget.defaultState =  {\n\t  query: \"\",\n\tprofile: { },\n\t  rooms: [ ],\n\t   room: { name: null, messages: [ ], typing: [ ] },\n\t toggle: false,\n\t   span: false\n}\nfrappe.Chat.Widget.defaultProps = {\n\tlayout: frappe.Chat.Layout.POPPER\n}\n\n/**\n * @description Chat Widget Popper HOC.\n */\nfrappe.Chat.Widget.Popper\n=\nclass extends Component {\n\tconstructor (props) {\n\t\tsuper (props)\n\n\t\tthis.setup(props);\n\t}\n\n\tsetup (props) {\n\t\tthis.toggle = this.toggle.bind(this)\n\n\t\tthis.state  = frappe.Chat.Widget.Popper.defaultState\n\n\t\tif ( props.target )\n\t\t\t$(props.target).click(() => this.toggle())\n\n\t\tfrappe.chat.widget = this\n\t}\n\n\ttoggle  (active) {\n\t\tlet toggle\n\t\tif ( arguments.length === 1 )\n\t\t\ttoggle = active\n\t\telse\n\t\t\ttoggle = this.state.active ? false : true\n\n\t\tthis.set_state({ active: toggle })\n\n\t\tthis.props.toggle(toggle)\n\t}\n\n\ton_mounted ( ) {\n\t\t$(document.body).on('click', '.page-container, .frappe-chat-close', ({ currentTarget }) => {\n\t\t\tthis.toggle(false)\n\t\t})\n\t}\n\n\trender  ( )  {\n\t\tconst { props, state } = this\n\n\t\treturn !state.destroy ?\n\t\t(\n\t\t\th(\"div\", { class: \"frappe-chat-popper\", style: !props.target ? { \"margin-bottom\": \"80px\" } : null },\n\t\t\t\t!props.target ?\n\t\t\t\t\th(frappe.components.FAB, {\n\t\t\t\t\t\t  class: \"frappe-fab\",\n\t\t\t\t\t\t   icon: state.active ? \"fa fa-fw fa-times\" : \"font-heavy octicon octicon-comment\",\n\t\t\t\t\t\t   size: frappe._.is_mobile() ? null : \"large\",\n\t\t\t\t\t\t   type: \"primary\",\n\t\t\t\t\t\tonclick: () => this.toggle(),\n\t\t\t\t\t}) : null,\n\t\t\t\tstate.active ?\n\t\t\t\t\th(\"div\", { class: \"frappe-chat-popper-collapse\" },\n\t\t\t\t\t\tprops.page ? props.page : (\n\t\t\t\t\t\t\th(\"div\", { class: `panel panel-default ${frappe._.is_mobile() ? \"panel-span\" : \"\"}` },\n\t\t\t\t\t\t\t\th(\"div\", { class: \"panel-heading\" },\n\t\t\t\t\t\t\t\t\tprops.heading\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\tprops.children\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t) : null\n\t\t\t)\n\t\t) : null\n\t}\n}\nfrappe.Chat.Widget.Popper.defaultState\n=\n{\n\t active: false,\n\tdestroy: false\n}\n\n/**\n * @description frappe.Chat.Widget ActionBar Component\n */\nfrappe.Chat.Widget.ActionBar\n=\nclass extends Component {\n\tconstructor (props) {\n\t\tsuper (props)\n\n\t\tthis.change = this.change.bind(this)\n\t\tthis.submit = this.submit.bind(this)\n\n\t\tthis.state  = frappe.Chat.Widget.ActionBar.defaultState\n\t}\n\n\tchange (e) {\n\t\tconst { props, state } = this\n\n\t\tthis.set_state({\n\t\t\t[e.target.name]: e.target.value\n\t\t})\n\n\t\tprops.change(state.query)\n\t}\n\n\tsubmit (e) {\n\t\tconst { props, state } = this\n\n\t\te.preventDefault()\n\n\t\tprops.submit(state.query)\n\t}\n\n\trender ( ) {\n\t\tconst me               = this\n\t\tconst { props, state } = this\n\t\tconst { actions }      = props\n\n\t\treturn (\n\t\t\th(\"div\", { class: `frappe-chat-action-bar ${props.class ? props.class : \"\"}` },\n\t\t\t\th(\"form\", { oninput: this.change, onsubmit: this.submit },\n\t\t\t\t\th(\"input\", { autocomplete: \"off\", class: \"form-control input-sm\", name: \"query\", value: state.query, placeholder: props.placeholder || \"Search\" }),\n\t\t\t\t),\n\t\t\t\t!frappe._.is_empty(actions) ?\n\t\t\t\t\tactions.map(action => h(frappe.Chat.Widget.ActionBar.Action, { ...action })) : null,\n\t\t\t\t!frappe._.is_mobile() ?\n\t\t\t\t\th(frappe.Chat.Widget.ActionBar.Action, {\n\t\t\t\t\t\ticon: `octicon octicon-screen-${state.span ? \"normal\" : \"full\"}`,\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tconst span = !state.span\n\t\t\t\t\t\t\tme.set_state({ span })\n\t\t\t\t\t\t\tprops.span(span)\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t:\n\t\t\t\t\tnull\n\t\t\t)\n\t\t)\n\t}\n}\nfrappe.Chat.Widget.ActionBar.defaultState\n=\n{\n\tquery: null,\n\t span: false\n}\n\n/**\n * @description frappe.Chat.Widget ActionBar's Action Component.\n */\nfrappe.Chat.Widget.ActionBar.Action\n=\nclass extends Component {\n\trender ( ) {\n\t\tconst { props } = this\n\n\t\treturn (\n\t\t\th(frappe.components.Button, { size: \"small\", class: \"btn-action\", ...props },\n\t\t\t\tprops.icon ? h(\"i\", { class: props.icon }) : null,\n\t\t\t\t`${props.icon ? \" \" : \"\"}${props.label ? props.label : \"\"}`\n\t\t\t)\n\t\t)\n\t}\n}\n\n/**\n * @description frappe.Chat.Widget RoomList Component\n */\nfrappe.Chat.Widget.RoomList\n=\nclass extends Component {\n\trender ( ) {\n\t\tconst { props } = this\n\t\tconst rooms     = props.rooms\n\n\t\treturn !frappe._.is_empty(rooms) ? (\n\t\t\th(\"ul\", { class: \"frappe-chat-room-list nav nav-pills nav-stacked\" },\n\t\t\t\trooms.map(room => h(frappe.Chat.Widget.RoomList.Item, { ...room, click: props.click }))\n\t\t\t)\n\t\t) : null\n\t}\n}\n\n/**\n * @description frappe.Chat.Widget RoomList's Item Component\n */\nfrappe.Chat.Widget.RoomList.Item\n=\nclass extends Component {\n\trender ( ) {\n\t\tconst { props }    = this\n\t\tconst item         = { }\n\n\t\tif ( props.type === \"Group\" ) {\n\t\t\titem.title     = props.room_name\n\t\t\titem.image     = props.avatar\n\n\t\t\tif ( !frappe._.is_empty(props.typing) ) {\n\t\t\t\tprops.typing  = frappe._.as_array(props.typing) // HACK: (BUG) why does typing return a string?\n\t\t\t\tconst names   = props.typing.map(user => frappe.user.first_name(user))\n\t\t\t\titem.subtitle = `${names.join(\", \")} typing...`\n\t\t\t} else\n\t\t\tif ( props.last_message ) {\n\t\t\t\tconst message = props.last_message\n\t\t\t\tconst content = message.content\n\n\t\t\t\tif ( message.type === \"File\" ) {\n\t\t\t\t\titem.subtitle = ` ${content.name}`\n\t\t\t\t} else {\n\t\t\t\t\titem.subtitle = props.last_message.content\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tconst user     = props.owner === frappe.session.user ? frappe._.squash(props.users) : props.owner\n\n\t\t\titem.title     = frappe.user.full_name(user)\n\t\t\titem.image     = frappe.user.image(user)\n\t\t\titem.abbr      = frappe.user.abbr(user)\n\n\t\t\tif ( !frappe._.is_empty(props.typing) )\n\t\t\t\titem.subtitle = 'typing...'\n\t\t\telse\n\t\t\tif ( props.last_message ) {\n\t\t\t\tconst message = props.last_message\n\t\t\t\tconst content = message.content\n\n\t\t\t\tif ( message.type === \"File\" ) {\n\t\t\t\t\titem.subtitle = ` ${content.name}`\n\t\t\t\t} else {\n\t\t\t\t\titem.subtitle = props.last_message.content\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet is_unread = false\n\t\tif ( props.last_message ) {\n\t\t\titem.timestamp = frappe.chat.pretty_datetime(props.last_message.creation)\n\t\t\tis_unread = !props.last_message.seen.includes(frappe.session.user)\n\t\t}\n\n\t\treturn (\n\t\t\th(\"li\", null,\n\t\t\t\th(\"a\", { class: props.active ? \"active\": \"\", onclick: () => {\n\t\t\t\t\tif (props.last_message) {\n\t\t\t\t\t\tfrappe.chat.message.seen(props.last_message.name);\n\t\t\t\t\t}\n\t\t\t\t\tprops.click(props)\n\t\t\t\t} },\n\t\t\t\t\th(\"div\", { class: \"row\" },\n\t\t\t\t\t\th(\"div\", { class: \"col-xs-9\" },\n\t\t\t\t\t\t\th(frappe.Chat.Widget.MediaProfile, { ...item })\n\t\t\t\t\t\t),\n\t\t\t\t\t\th(\"div\", { class: \"col-xs-3 text-right\" },\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\th(\"div\", { class: \"text-muted\", style: { \"font-size\": \"9px\" } }, item.timestamp),\n\t\t\t\t\t\t\t\tis_unread ? h(\"span\", { class: \"indicator red\" }) : null\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t),\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t)\n\t\t)\n\t}\n}\n\n/**\n * @description frappe.Chat.Widget's MediProfile Component.\n */\nfrappe.Chat.Widget.MediaProfile\n=\nclass extends Component {\n\trender ( ) {\n\t\tconst { props } = this\n\t\tconst position  = frappe.Chat.Widget.MediaProfile.POSITION[props.position || \"left\"]\n\t\tconst avatar    = (\n\t\t\th(\"div\", { class: `${position.class} media-middle` },\n\t\t\t\th(frappe.components.Avatar, { ...props,\n\t\t\t\t\ttitle: props.title,\n\t\t\t\t\timage: props.image,\n\t\t\t\t\t size: props.size,\n\t\t\t\t\t abbr: props.abbr\n\t\t\t\t})\n\t\t\t)\n\t\t)\n\n\t\treturn (\n\t\t\th(\"div\", { class: \"media\", style: position.class === \"media-right\" ? { \"text-align\": \"right\" } : null },\n\t\t\t\tposition.class === \"media-left\"  ? avatar : null,\n\t\t\t\th(\"div\", { class: \"media-body\" },\n\t\t\t\t\th(\"div\", { class: \"media-heading ellipsis small\", style: `max-width: ${props.width_title || \"100%\"} display: inline-block` }, props.title),\n\t\t\t\t\tprops.content  ? h(\"div\",\"\",h(\"small\",\"\",props.content))  : null,\n\t\t\t\t\tprops.subtitle ? h(\"div\",{ class: \"media-subtitle small\" },h(\"small\", { class: \"text-muted\" }, props.subtitle)) : null\n\t\t\t\t),\n\t\t\t\tposition.class === \"media-right\" ? avatar : null\n\t\t\t)\n\t\t)\n\t}\n}\nfrappe.Chat.Widget.MediaProfile.POSITION\n=\n{\n\tleft: { class: \"media-left\" }, right: { class: \"media-right\" }\n}\n\n/**\n * @description frappe.Chat.Widget Room Component\n */\nfrappe.Chat.Widget.Room\n=\nclass extends Component {\n\trender ( ) {\n\t\tconst { props, state } = this\n\t\tconst hints            =\n\t\t[\n\t\t\t{\n\t\t\t\t match: /@(\\w*)$/,\n\t\t\t\tsearch: function (keyword, callback) {\n\t\t\t\t\tif ( props.type === 'Group' ) {\n\t\t\t\t\t\tconst query = keyword.slice(1)\n\t\t\t\t\t\tconst users = [].concat(frappe._.as_array(props.owner), props.users)\n\t\t\t\t\t\tconst grep  = users.filter(user => user !== frappe.session.user && user.indexOf(query) === 0)\n\n\t\t\t\t\t\tcallback(grep)\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcomponent: function (item) {\n\t\t\t\t\treturn (\n\t\t\t\t\t\th(frappe.Chat.Widget.MediaProfile, {\n\t\t\t\t\t\t\ttitle: frappe.user.full_name(item),\n\t\t\t\t\t\t\timage: frappe.user.image(item),\n\t\t\t\t\t\t\t size: \"small\"\n\t\t\t\t\t\t})\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tmatch: /:([a-z]*)$/,\n\t\t\t   search: function (keyword, callback) {\n\t\t\t\t\tfrappe.chat.emoji(function (emojis) {\n\t\t\t\t\t\tconst query = keyword.slice(1)\n\t\t\t\t\t\tconst items = [ ]\n\t\t\t\t\t\tfor (const emoji of emojis)\n\t\t\t\t\t\t\tfor (const alias of emoji.aliases)\n\t\t\t\t\t\t\t\tif ( alias.indexOf(query) === 0 )\n\t\t\t\t\t\t\t\t\titems.push({ name: alias, value: emoji.emoji })\n\n\t\t\t\t\t\tcallback(items)\n\t\t\t\t\t})\n\t\t\t   },\n\t\t\t\t content: (item) => item.value,\n\t\t\t   component: function (item) {\n\t\t\t\t\treturn (\n\t\t\t\t\t\th(frappe.Chat.Widget.MediaProfile, {\n\t\t\t\t\t\t\ttitle: item.name,\n\t\t\t\t\t\t\t abbr: item.value,\n\t\t\t\t\t\t\t size: \"small\"\n\t\t\t\t\t\t})\n\t\t\t\t\t)\n\t\t\t   }\n\t\t   }\n\t\t]\n\n\t\tconst actions = frappe._.compact([\n\t\t\t!frappe._.is_mobile() && {\n\t\t\t\t icon: \"camera\",\n\t\t\t\tlabel: \"Camera\",\n\t\t\t\tonclick: ( ) => {\n\t\t\t\t\tconst capture = new frappe.ui.Capture({\n\t\t\t\t\t\tanimate: false,\n\t\t\t\t\t\t  error: true\n\t\t\t\t\t})\n\t\t\t\t\tcapture.show()\n\n\t\t\t\t\tcapture.submit(data_url => {\n\t\t\t\t\t\t// data_url\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t icon: \"file\",\n\t\t\t\tlabel: \"File\",\n\t\t\t\tonclick: ( ) => {\n\t\t\t\t\tnew frappe.ui.FileUploader({\n\t\t\t\t\t\tdoctype: \"Chat Room\",\n\t\t\t\t\t\tdocname: props.name,\n\t\t\t\t\t\ton_success(file_doc) {\n\t\t\t\t\t\t\tconst { file_url, filename } = file_doc\n\t\t\t\t\t\t\tfrappe.chat.message.send(props.name, { path: file_url, name: filename }, \"File\")\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t])\n\n\t\tif ( frappe.session.user !== 'Guest' ) {\n\t\t\tif (props.messages) {\n\t\t\t\tprops.messages = frappe._.as_array(props.messages)\n\t\t\t\tfor (const message of props.messages)\n\t\t\t\t\tif ( !message.seen.includes(frappe.session.user) )\n\t\t\t\t\t\tfrappe.chat.message.seen(message.name)\n\t\t\t\t\telse\n\t\t\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\treturn (\n\t\t\th(\"div\", { class: `panel panel-default\n\t\t\t\t${props.name ? \"panel-bg\" : \"\"}\n\t\t\t\t${props.layout === frappe.Chat.Layout.PAGE || frappe._.is_mobile() ? \"panel-span\" : \"\"}`,\n\t\t\t\tstyle: props.layout === frappe.Chat.Layout.PAGE && { width: \"75%\", left: \"25%\", \"box-shadow\": \"none\" } },\n\t\t\t\tprops.name && h(frappe.Chat.Widget.Room.Header, { ...props, on_back: props.destroy }),\n\t\t\t\tprops.name ?\n\t\t\t\t\t!frappe._.is_empty(props.messages) ?\n\t\t\t\t\t\th(frappe.chat.component.ChatList, {\n\t\t\t\t\t\t\tmessages: props.messages\n\t\t\t\t\t\t})\n\t\t\t\t\t\t:\n\t\t\t\t\t\th(\"div\", { class: \"panel-body\", style: { \"height\": \"100%\" } },\n\t\t\t\t\t\t\th(\"div\", { class: \"vcenter\" },\n\t\t\t\t\t\t\t\th(\"div\", { class: \"text-center text-extra-muted\" },\n\t\t\t\t\t\t\t\t\th(frappe.components.Octicon, { type: \"comment-discussion\", style: \"font-size: 48px\" }),\n\t\t\t\t\t\t\t\t\th(\"p\",\"\",__(\"Start a conversation.\"))\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t:\n\t\t\t\t\th(\"div\", { class: \"panel-body\", style: { \"height\": \"100%\" } },\n\t\t\t\t\t\th(\"div\", { class: \"vcenter\" },\n\t\t\t\t\t\t\th(\"div\", { class: \"text-center text-extra-muted\" },\n\t\t\t\t\t\t\t\th(frappe.components.Octicon, { type: \"comment-discussion\", style: \"font-size: 125px\" }),\n\t\t\t\t\t\t\t\th(\"p\",\"\",__(\"Select a chat to start messaging.\"))\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t),\n\t\t\t\tprops.name ?\n\t\t\t\t\th(\"div\", { class: \"chat-room-footer\" },\n\t\t\t\t\t\th(frappe.chat.component.ChatForm, { actions: actions,\n\t\t\t\t\t\t\tonchange: () => {\n\t\t\t\t\t\t\t\tfrappe.chat.message.typing(props.name)\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonsubmit: (message) => {\n\t\t\t\t\t\t\t\tfrappe.chat.message.send(props.name, message)\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\thint: hints\n\t\t\t\t\t\t})\n\t\t\t\t\t)\n\t\t\t\t\t:\n\t\t\t\t\tnull\n\t\t\t)\n\t\t)\n\t}\n}\n\nfrappe.Chat.Widget.Room.Header\n=\nclass extends Component {\n\trender ( ) {\n\t\tconst { props }     = this\n\n\t\tconst item          = { }\n\n\t\tif ( [\"Group\", \"Visitor\"].includes(props.type) ) {\n\t\t\titem.route      = `Form/Chat Room/${props.name}`\n\n\t\t\titem.title      = props.room_name\n\t\t\titem.image      = props.avatar\n\n\t\t\tif ( !frappe._.is_empty(props.typing) ) {\n\t\t\t\tprops.typing  = frappe._.as_array(props.typing) // HACK: (BUG) why does typing return as a string?\n\t\t\t\tconst users   = props.typing.map(user => frappe.user.first_name(user))\n\t\t\t\titem.subtitle = `${users.join(\", \")} typing...`\n\t\t\t} else\n\t\t\t\titem.subtitle = props.type === \"Group\" ?\n\t\t\t\t\t__(`${props.users.length} ${frappe._.pluralize('member', props.users.length)}`)\n\t\t\t\t\t:\n\t\t\t\t\t\"\"\n\t\t}\n\t\telse {\n\t\t\tconst user      = props.owner === frappe.session.user ? frappe._.squash(props.users) : props.owner\n\n\t\t\titem.route      = `Form/User/${user}`\n\n\t\t\titem.title      = frappe.user.full_name(user)\n\t\t\titem.image      = frappe.user.image(user)\n\n\t\t\tif ( !frappe._.is_empty(props.typing) )\n\t\t\t\titem.subtitle = 'typing...'\n\t\t}\n\n\t\tconst popper        = props.layout === frappe.Chat.Layout.POPPER || frappe._.is_mobile()\n\n\t\treturn (\n\t\t\th(\"div\", { class: \"panel-heading\", style: { \"height\": \"50px\" } }, // sorry. :(\n\t\t\t\th(\"div\", { class: \"level\" },\n\t\t\t\t\tpopper && frappe.session.user !== \"Guest\" ?\n\t\t\t\t\t\th(frappe.components.Button,{class:\"btn-back\",onclick:props.on_back},\n\t\t\t\t\t\t\th(frappe.components.Octicon, { type: \"chevron-left\" })\n\t\t\t\t\t\t) : null,\n\t\t\t\t\th(\"div\",\"\",\n\t\t\t\t\t\th(\"div\", { class: \"panel-title\" },\n\t\t\t\t\t\t\th(\"div\", { class: \"cursor-pointer\", onclick: () => {\n\t\t\t\t\t\t\t\tfrappe.session.user !== \"Guest\" ?\n\t\t\t\t\t\t\t\t\tfrappe.set_route(item.route) : null;\n\t\t\t\t\t\t\t}},\n\t\t\t\t\t\t\t\th(frappe.Chat.Widget.MediaProfile, { ...item })\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t),\n\t\t\t\t\th(\"div\", { class: popper ? \"col-xs-2\"  : \"col-xs-3\" },\n\t\t\t\t\t\th(\"div\", { class: \"text-right\" },\n\t\t\t\t\t\t\tfrappe._.is_mobile() && h(frappe.components.Button, { class: \"frappe-chat-close\", onclick: props.toggle },\n\t\t\t\t\t\t\t\th(frappe.components.Octicon, { type: \"x\" })\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t)\n\t\t)\n\t}\n}\n\n/**\n * @description ChatList Component\n *\n * @prop {array} messages - ChatMessage(s)\n */\nfrappe.chat.component.ChatList\n=\nclass extends Component {\n\ton_mounted ( ) {\n\t\tthis.$element  = $('.frappe-chat').find('.chat-list')\n\t\tthis.$element.scrollTop(this.$element[0].scrollHeight)\n\t}\n\n\ton_updated ( ) {\n\t\tthis.$element.scrollTop(this.$element[0].scrollHeight)\n\t}\n\n\trender ( ) {\n\t\tvar messages = [ ]\n\t\tfor (var i   = 0 ; i < this.props.messages.length ; ++i) {\n\t\t\tvar   message   = this.props.messages[i]\n\t\t\tconst me        = message.user === frappe.session.user\n\n\t\t\tif ( i === 0 || !frappe.datetime.equal(message.creation, this.props.messages[i - 1].creation, 'day') )\n\t\t\t\tmessages.push({ type: \"Notification\", content: message.creation.format('MMMM DD') })\n\n\t\t\tmessages.push(message)\n\t\t}\n\n\t\treturn (\n\t\t\th(\"div\",{class:\"chat-list list-group\"},\n\t\t\t\t!frappe._.is_empty(messages) ?\n\t\t\t\t\tmessages.map(m => h(frappe.chat.component.ChatList.Item, {...m})) : null\n\t\t\t)\n\t\t)\n\t}\n}\n\n/**\n * @description ChatList.Item Component\n *\n * @prop {string} name       - ChatMessage name\n * @prop {string} user       - ChatMessage user\n * @prop {string} room       - ChatMessage room\n * @prop {string} room_type  - ChatMessage room_type (\"Direct\", \"Group\" or \"Visitor\")\n * @prop {string} content    - ChatMessage content\n * @prop {frappe.datetime.datetime} creation - ChatMessage creation\n *\n * @prop {boolean} groupable - Whether the ChatMessage is groupable.\n */\nfrappe.chat.component.ChatList.Item\n=\nclass extends Component {\n\trender ( ) {\n\t\tconst { props } = this\n\n\t\tconst me        = props.user === frappe.session.user\n\t\tconst content   = props.content\n\n\t\treturn (\n\t\t\th(\"div\",{class: \"chat-list-item list-group-item\"},\n\t\t\t\tprops.type === \"Notification\" ?\n\t\t\t\t\th(\"div\",{class:\"chat-list-notification\"},\n\t\t\t\t\t\th(\"div\",{class:\"chat-list-notification-content\"},\n\t\t\t\t\t\t\tcontent\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t\t:\n\t\t\t\t\th(\"div\",{class:`${me ? \"text-right\" : \"\"}`},\n\t\t\t\t\t\tprops.room_type === \"Group\" && !me ?\n\t\t\t\t\t\t\th(frappe.components.Avatar, {\n\t\t\t\t\t\t\t\ttitle: frappe.user.full_name(props.user),\n\t\t\t\t\t\t\t\timage: frappe.user.image(props.user)\n\t\t\t\t\t\t\t}) : null,\n\t\t\t\t\t\th(frappe.chat.component.ChatBubble, props)\n\t\t\t\t\t)\n\t\t\t)\n\t\t)\n\t}\n}\n\n/**\n * @description ChatBubble Component\n *\n * @prop {string} name       - ChatMessage name\n * @prop {string} user       - ChatMessage user\n * @prop {string} room       - ChatMessage room\n * @prop {string} room_type  - ChatMessage room_type (\"Direct\", \"Group\" or \"Visitor\")\n * @prop {string} content    - ChatMessage content\n * @prop {frappe.datetime.datetime} creation - ChatMessage creation\n *\n * @prop {boolean} groupable - Whether the ChatMessage is groupable.\n */\nfrappe.chat.component.ChatBubble\n=\nclass extends Component {\n\tconstructor (props) {\n\t\tsuper (props)\n\n\t\tthis.onclick = this.onclick.bind(this)\n\t}\n\n\tonclick ( ) {\n\t\tconst { props } = this\n\t\tif ( props.user === frappe.session.user ) {\n\t\t\tfrappe.quick_edit(\"Chat Message\", props.name, (values) => {\n\n\t\t\t})\n\t\t}\n\t}\n\n\trender  ( ) {\n\t\tconst { props } = this\n\t\tconst creation \t= props.creation.format('hh:mm A')\n\n\t\tconst me        = props.user === frappe.session.user\n\t\tconst read      = !frappe._.is_empty(props.seen) && !props.seen.includes(frappe.session.user)\n\n\t\tconst content   = props.content\n\n\t\treturn (\n\t\t\th(\"div\",{class:`chat-bubble ${props.groupable ? \"chat-groupable\" : \"\"} chat-bubble-${me ? \"r\" : \"l\"}`,\n\t\t\t\tonclick: this.onclick},\n\t\t\t\tprops.room_type === \"Group\" && !me?\n\t\t\t\t\th(\"div\",{class:\"chat-bubble-author\"},\n\t\t\t\t\t\th(\"a\", { onclick: () => { frappe.set_route(`Form/User/${props.user}`) } },\n\t\t\t\t\t\t\tfrappe.user.full_name(props.user)\n\t\t\t\t\t\t)\n\t\t\t\t\t) : null,\n\t\t\t\th(\"div\",{class:\"chat-bubble-content\"},\n\t\t\t\t\t\th(\"small\",\"\",\n\t\t\t\t\t\t\tprops.type === \"File\" ?\n\t\t\t\t\t\t\t\th(\"a\", { class: \"no-decoration\", href: content.path, target: \"_blank\" },\n\t\t\t\t\t\t\t\t\th(frappe.components.FontAwesome, { type: \"file\", fixed: true }), ` ${content.name}`\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t\tcontent\n\t\t\t\t\t\t)\n\t\t\t\t),\n\t\t\t\th(\"div\",{class:\"chat-bubble-meta\"},\n\t\t\t\t\th(\"span\",{class:\"chat-bubble-creation\"},creation),\n\t\t\t\t\tme && read ?\n\t\t\t\t\t\th(\"span\",{class:\"chat-bubble-check\"},\n\t\t\t\t\t\t\th(frappe.components.Octicon,{type:\"check\"})\n\t\t\t\t\t\t) : null\n\t\t\t\t)\n\t\t\t)\n\t\t)\n\t}\n}\n\n/**\n * @description ChatForm Component\n */\nfrappe.chat.component.ChatForm\n=\nclass extends Component {\n\tconstructor (props) {\n\t\tsuper (props)\n\n\t\tthis.onchange   = this.onchange.bind(this)\n\t\tthis.onsubmit   = this.onsubmit.bind(this)\n\n\t\tthis.hint        = this.hint.bind(this)\n\n\t\tthis.state       = frappe.chat.component.ChatForm.defaultState\n\t}\n\n\tonchange (e) {\n\t\tconst { props, state } = this\n\t\tconst value            = e.target.value\n\n\t\tthis.set_state({\n\t\t\t[e.target.name]: value\n\t\t})\n\n\t\tprops.onchange(state)\n\n\t\tthis.hint(value)\n\t}\n\n\thint (value) {\n\t\tconst { props, state } = this\n\n\t\tif ( props.hint ) {\n\t\t\tconst tokens =  value.split(\" \")\n\t\t\tconst sliced = tokens.slice(0, tokens.length - 1)\n\n\t\t\tconst token  = tokens[tokens.length - 1]\n\n\t\t\tif ( token ) {\n\t\t\t\tprops.hint   = frappe._.as_array(props.hint)\n\t\t\t\tconst hint   = props.hint.find(hint => hint.match.test(token))\n\n\t\t\t\tif ( hint ) {\n\t\t\t\t\thint.search(token, items => {\n\t\t\t\t\t\tconst hints = items.map(item => {\n\t\t\t\t\t\t\t// You should stop writing one-liners! >_>\n\t\t\t\t\t\t\tconst replace = token.replace(hint.match, hint.content ? hint.content(item) : item)\n\t\t\t\t\t\t\tconst content = `${sliced.join(\" \")} ${replace}`.trim()\n\t\t\t\t\t\t\titem          = { component: hint.component(item), content: content }\n\n\t\t\t\t\t\t\treturn item\n\t\t\t\t\t\t}).slice(0, hint.max || 5)\n\n\t\t\t\t\t\tthis.set_state({ hints })\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tthis.set_state({ hints: [ ] })\n\t\t\t} else\n\t\t\t\tthis.set_state({ hints: [ ] })\n\t\t}\n\t}\n\n\tonsubmit (e) {\n\t\te.preventDefault()\n\n\t\tif ( this.state.content ) {\n\t\t\tthis.props.onsubmit(this.state.content)\n\n\t\t\tthis.set_state({ content: null })\n\t\t}\n\t}\n\n\trender ( ) {\n\t\tconst { props, state } = this\n\n\t\treturn (\n\t\t\th(\"div\",{class:\"chat-form\"},\n\t\t\t\tstate.hints.length ?\n\t\t\t\t\th(\"ul\", { class: \"hint-list list-group\" },\n\t\t\t\t\t\tstate.hints.map((item) => {\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\th(\"li\", { class: \"hint-list-item list-group-item\" },\n\t\t\t\t\t\t\t\t\th(\"a\", { href: \"javascript:void(0)\", onclick: () => {\n\t\t\t\t\t\t\t\t\t\tthis.set_state({ content: item.content, hints: [ ] })\n\t\t\t\t\t\t\t\t\t}},\n\t\t\t\t\t\t\t\t\t\titem.component\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t})\n\t\t\t\t\t) : null,\n\t\t\t\th(\"form\", { oninput: this.onchange, onsubmit: this.onsubmit },\n\t\t\t\t\th(\"div\",{class:\"input-group input-group-lg\"},\n\t\t\t\t\t\t!frappe._.is_empty(props.actions) ?\n\t\t\t\t\t\t\th(\"div\",{class:\"input-group-btn dropup\"},\n\t\t\t\t\t\t\t\th(frappe.components.Button,{ class: (frappe.session.user === \"Guest\" ? \"disabled\" : \"dropdown-toggle\"), \"data-toggle\": \"dropdown\"},\n\t\t\t\t\t\t\t\t\th(frappe.components.FontAwesome, { class: \"text-muted\", type: \"paperclip\", fixed: true })\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\th(\"div\",{ class:\"dropdown-menu dropdown-menu-left\", onclick: e => e.stopPropagation() },\n\t\t\t\t\t\t\t\t\t!frappe._.is_empty(props.actions) && props.actions.map((action) => {\n\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\th(\"li\", null,\n\t\t\t\t\t\t\t\t\t\t\t\th(\"a\",{onclick:action.onclick},\n\t\t\t\t\t\t\t\t\t\t\t\t\th(frappe.components.FontAwesome,{type:action.icon,fixed:true}), ` ${action.label}`,\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t) : null,\n\t\t\t\t\t\th(\"textarea\", {\n\t\t\t\t\t\t\t\t\tclass: \"form-control\",\n\t\t\t\t\t\t\t\t\t name: \"content\",\n\t\t\t\t\t\t\t\t\tvalue: state.content,\n\t\t\t\t\t\t\t  placeholder: \"Type a message\",\n\t\t\t\t\t\t\t\tautofocus: true,\n\t\t\t\t\t\t\t   onkeypress: (e) => {\n\t\t\t\t\t\t\t\t\tif ( e.which === frappe.ui.keycode.RETURN && !e.shiftKey )\n\t\t\t\t\t\t\t\t\t\tthis.onsubmit(e)\n\t\t\t\t\t\t\t   }\n\t\t\t\t\t\t}),\n\t\t\t\t\t\th(\"div\",{class:\"input-group-btn\"},\n\t\t\t\t\t\t\th(frappe.components.Button, { onclick: this.onsubmit },\n\t\t\t\t\t\t\t\th(frappe.components.FontAwesome, { class: !frappe._.is_empty(state.content) ? \"text-primary\" : \"text-muted\", type: \"send\", fixed: true })\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t)\n\t\t)\n\t}\n}\nfrappe.chat.component.ChatForm.defaultState\n=\n{\n\tcontent: null,\n\t  hints: [ ],\n}\n\n/**\n * @description EmojiPicker Component\n *\n * @todo Under Development\n */\nfrappe.chat.component.EmojiPicker\n=\nclass extends Component  {\n\trender ( ) {\n\t\tconst { props } = this\n\n\t\treturn (\n\t\t\th(\"div\", { class: `frappe-chat-emoji dropup ${props.class}` },\n\t\t\t\th(frappe.components.Button, { type: \"primary\", class: \"dropdown-toggle\", \"data-toggle\": \"dropdown\" },\n\t\t\t\t\th(frappe.components.FontAwesome, { type: \"smile-o\", fixed: true })\n\t\t\t\t),\n\t\t\t\th(\"div\", { class: \"dropdown-menu dropdown-menu-right\", onclick: e => e.stopPropagation() },\n\t\t\t\t\th(\"div\", { class: \"panel panel-default\" },\n\t\t\t\t\t\th(frappe.chat.component.EmojiPicker.List)\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t)\n\t\t)\n\t}\n}\nfrappe.chat.component.EmojiPicker.List\n=\nclass extends Component {\n\trender ( ) {\n\t\tconst { props } = this\n\n\t\treturn (\n\t\t\th(\"div\", { class: \"list-group\" },\n\n\t\t\t)\n\t\t)\n\t}\n}\n\n/**\n * @description Python equivalent to sys.platform\n */\nfrappe.provide('frappe._')\nfrappe._.platform   = () => {\n\tconst string    = navigator.appVersion\n\n\tif ( string.includes(\"Win\") ) \treturn \"Windows\"\n\tif ( string.includes(\"Mac\") ) \treturn \"Darwin\"\n\tif ( string.includes(\"X11\") ) \treturn \"UNIX\"\n\tif ( string.includes(\"Linux\") ) return \"Linux\"\n\n\treturn undefined\n}\n\n/**\n * @description Frappe's Asset Helper\n */\nfrappe.provide('frappe.assets')\nfrappe.assets.image = (image, app = 'frappe') => {\n\tconst  path     = `/assets/${app}/images/${image}`\n\treturn path\n}\n\n/**\n * @description Notify using Web Push Notifications\n */\nfrappe.provide('frappe.boot')\nfrappe.provide('frappe.browser')\nfrappe.browser.Notification = 'Notification' in window\n\nfrappe.notify     = (string, options) => {\n\tfrappe.log    = frappe.Logger.get('frappe.notify')\n\n\tconst OPTIONS = {\n\t\ticon: frappe.assets.image('favicon.png', 'frappe'),\n\t\tlang: frappe.boot.lang || \"en\"\n\t}\n\toptions       = Object.assign({ }, OPTIONS, options)\n\n\tif ( !frappe.browser.Notification )\n\t\tfrappe.log.error('ERROR: This browser does not support desktop notifications.')\n\n\tNotification.requestPermission(status => {\n\t\tif ( status === \"granted\" ) {\n\t\t\tconst notification = new Notification(string, options)\n\t\t}\n\t})\n}\n\nfrappe.chat.render = (render = true, force = false) =>\n{\n\tfrappe.log.info(`${render ? \"Enable\" : \"Disable\"} Chat for User.`)\n\n\tconst desk = 'desk' in frappe\n\tif ( desk ) {\n\t\t// With the assumption, that there's only one navbar.\n\t\tconst $placeholder = $('.navbar .frappe-chat-dropdown')\n\n\t\t// Render if frappe-chat-toggle doesn't exist.\n\t\tif ( frappe.utils.is_empty($placeholder.has('.frappe-chat-toggle')) ) {\n\t\t\tconst $template = $(`\n\t\t\t\t<a class=\"dropdown-toggle frappe-chat-toggle\" data-toggle=\"dropdown\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<i class=\"octicon octicon-comment-discussion\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</a>\n\t\t\t`)\n\n\t\t\t$placeholder.addClass('dropdown hidden')\n\t\t\t$placeholder.html($template)\n\t\t}\n\n\t\tif ( render ) {\n\t\t\t$placeholder.removeClass('hidden')\n\t\t} else {\n\t\t\t$placeholder.addClass('hidden')\n\t\t}\n\t}\n\n\t// Avoid re-renders. Once is enough.\n\tif ( !frappe.chatter || force ) {\n\t\tfrappe.chatter = new frappe.Chat({\n\t\t\ttarget: desk ? '.frappe-chat-toggle' : null\n\t\t})\n\n\t\tif ( render ) {\n\t\t\tif ( frappe.session.user === 'Guest' && !desk ) {\n\t\t\t\tfrappe.store = frappe.Store.get('frappe.chat')\n\t\t\t\tvar token\t = frappe.store.get('guest_token')\n\n\t\t\t\tfrappe.log.info(`Local Guest Token - ${token}`)\n\n\t\t\t\tconst setup_room = (token) =>\n\t\t\t\t{\n\t\t\t\t\treturn new Promise(resolve => {\n\t\t\t\t\t\tfrappe.chat.room.create(\"Visitor\", token).then(room => {\n\t\t\t\t\t\t\tfrappe.log.info(`Visitor Room Created: ${room.name}`)\n\t\t\t\t\t\t\tfrappe.chat.room.subscribe(room.name)\n\n\t\t\t\t\t\t\tvar reference = room\n\n\t\t\t\t\t\t\tfrappe.chat.room.history(room.name).then(messages => {\n\t\t\t\t\t\t\t\tconst  room = { ...reference, messages: messages }\n\t\t\t\t\t\t\t\treturn room\n\t\t\t\t\t\t\t}).then(room => {\n\t\t\t\t\t\t\t\tresolve(room)\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t})\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\tif ( !token ) {\n\t\t\t\t\tfrappe.chat.website.token().then(token => {\n\t\t\t\t\t\tfrappe.log.info(`Generated Guest Token - ${token}`)\n\t\t\t\t\t\tfrappe.store.set('guest_token', token)\n\n\t\t\t\t\t\tsetup_room(token).then(room => {\n\t\t\t\t\t\t\tfrappe.chatter.render({ room })\n\t\t\t\t\t\t})\n\t\t\t\t\t})\n\t\t\t\t} else {\n\t\t\t\t\tsetup_room(token).then(room => {\n\t\t\t\t\t\tfrappe.chatter.render({ room })\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfrappe.chatter.render()\n\t\t\t}\n\t\t}\n\t}\n}\n\nfrappe.chat.setup  = () => {\n\tfrappe.log     = frappe.Logger.get('frappe.chat')\n\n\tfrappe.log.info('Setting up frappe.chat')\n\tfrappe.log.warn('TODO: frappe.chat.<object> requires a storage.')\n\n\tif ( frappe.session.user !== 'Guest' ) {\n\t\t// Create/Get Chat Profile for session User, retrieve enable_chat\n\t\tfrappe.log.info('Creating a Chat Profile.')\n\n\t\tfrappe.chat.profile.create('enable_chat').then(({ enable_chat }) => {\n\t\t\tfrappe.log.info(`Chat Profile created for User ${frappe.session.user}.`)\n\n\t\t\tif ( 'desk' in frappe && frappe.sys_defaults ) { // same as desk?\n\t\t\t\tconst should_render = Boolean(parseInt(frappe.sys_defaults.enable_chat)) && enable_chat\n\t\t\t\tfrappe.chat.render(should_render)\n\t\t\t}\n\t\t})\n\n\t\t// Triggered when a User updates his/her Chat Profile.\n\t\t// Don't worry, enable_chat is broadcasted to this user only. No overhead. :)\n\t\tfrappe.chat.profile.on.update((user, profile) => {\n\t\t\tif ( user === frappe.session.user && 'enable_chat' in profile ) {\n\t\t\t\tfrappe.log.warn(`Chat Profile update (Enable Chat - ${Boolean(profile.enable_chat)})`)\n\t\t\t\tconst should_render = Boolean(parseInt(frappe.sys_defaults.enable_chat)) && profile.enable_chat\n\t\t\t\tfrappe.chat.render(should_render)\n\t\t\t}\n\t\t})\n\t} else {\n\t\t// Website Settings\n\t\tfrappe.log.info('Retrieving Chat Website Settings.')\n\t\tfrappe.chat.website.settings([\"socketio\", \"enable\", \"enable_from\", \"enable_to\"])\n\t\t\t.then(settings => {\n\t\t\t\tfrappe.log.info(`Chat Website Setting - ${JSON.stringify(settings)}`)\n\t\t\t\tfrappe.log.info(`Chat Website Setting - ${settings.enable ? \"Enable\" : \"Disable\"}`)\n\n\t\t\t\tvar should_render = settings.enable\n\t\t\t\tif ( settings.enable_from && settings.enable_to ) {\n\t\t\t\t\tfrappe.log.info(`Enabling Chat Schedule - ${settings.enable_from.format()} : ${settings.enable_to.format()}`)\n\n\t\t\t\t\tconst range   = new frappe.datetime.range(settings.enable_from, settings.enable_to)\n\t\t\t\t\tshould_render = range.contains(frappe.datetime.now())\n\t\t\t\t}\n\n\t\t\t\tif ( should_render ) {\n\t\t\t\t\tfrappe.log.info(\"Initializing Socket.IO\")\n\t\t\t\t\tfrappe.socketio.init(settings.socketio.port)\n\t\t\t\t}\n\n\t\t\t\tfrappe.chat.render(should_render)\n\t\t})\n\t}\n}\n\n$(document).on('ready toolbar_setup', () =>\n{\n\tfrappe.chat.setup()\n})\n"],"names":["module","e","t","r","n","exports","o","i","l","call","m","c","d","Object","defineProperty","enumerable","get","Symbol","toStringTag","value","__esModule","create","bind","default","prototype","hasOwnProperty","p","s","iterator","constructor","a","deepValue","isArray","h","location","distance","threshold","maxPatternLength","u","f","caseSensitive","v","tokenSeparator","g","findAllMatches","y","minMatchCharLength","k","b","id","S","x","keys","M","_","shouldSort","w","L","getFn","A","O","sortFn","C","score","j","tokenize","P","I","matchAllTokens","F","T","includeMatches","N","z","includeScore","E","W","verbose","K","TypeError","this","options","isCaseSensitive","setCollection","_processKeys","key","list","_keyWeights","_keyNames","length","push","Error","name","weight","arguments","limit","_log","concat","_prepareSearchers","tokenSearchers","fullSearcher","_search","_computeScore","_sort","slice","_format","split","_analyze","record","index","resultMap","results","arrayIndex","search","pattern","isMatch","matchedIndices","output","item","Number","EPSILON","Math","pow","sort","JSON","stringify","indexOf","matches","indices","console","log","apply","configurable","writable","toLowerCase","patternAlphabet","RegExp","replace","match","errors","currentLocation","expectedLocation","min","lastIndexOf","floor","max","Array","charAt","$","abs","toString","isString","isNum","__d","pop","splitText","nodeName","_componentConstructor","__n","attributes","children","defaultProps","parentNode","removeChild","style","cssText","test","innerHTML","substring","addEventListener","removeEventListener","__l","removeAttribute","removeAttributeNS","setAttributeNS","setAttribute","className","type","on_mounted","D","H","ownerSVGElement","R","appendChild","_component","nodeValue","document","createTextNode","replaceChild","__hyperattr_","createElementNS","createElement","firstChild","nextSibling","html","childNodes","__k","trim","insertBefore","U","ref","lastChild","previousSibling","render","__b","splice","__x","__r","base","on_mount","componentWillReceiveProps","context","__c","__p","props","syncComponentUpdates","state","__s","shouldComponentUpdate","componentWillUpdate","getChildContext","__u","V","unshift","on_updated","afterUpdate","__h","componentWillUnmount","Promise","resolve","then","setTimeout","set_state","forceUpdate","Component","frappe","socketio","open_tasks","open_docs","emit_queue","init","port","window","io","boot","disable_async","socket","protocol","connect","get_host","secure","localStorage","server","on","message","msgprint","eval","data","progress","percent","flt","hide_progress","show_progress","title","__","description","setup_listeners","setup_reconnect","frm","is_new","doctype","docname","doc_subscribe","doc_open","doc_close","onbeforeunload","cur_frm","doc","host","origin","dev_server","parts","socketio_port","subscribe","task_id","opts","emit","task_subscribe","task_unsubscribe","flags","doc_unsubscribe","filter","last_doc","process_response","status","each","locals","method","callback","request","cleanup","always","status_code","error","provide","realtime","event","off","publish","global","fnTest","Class","extend","_super","proto","fn","tmp","ret","newClass","ui","form","Layout","views","pages","sections","fields_list","fields_dict","make","parent","body","wrapper","appendTo","fields","get_doctype_fields","setup_tabbing","show_empty_form_message","find","show_message","let","fieldtype","fieldname","reqd","hidden","label","get_status","field","meta","autoname","includes","sort_docfields","docfield_map","color","message_color","removeClass","substr","addClass","empty","new_fields","me","section","column","with_dashboard","setup_dashboard_section","no_opening_section","make_section","df","make_page","make_column","make_field","cssClass","collapsible","replace_field","const","fieldobj","init_field","$wrapper","remove","perm","refresh_fields","colspan","make_control","render_input","layout","head","page","fold_btn","next","hasClass","utils","scroll_to","folded","unfold","trigger","Section","Column","refresh","attach_doc_and_docfields","refresh_dependency","refresh_sections","refresh_section_collapse","cnt","$this","fieldnames","map","set_input","add_fields","collapse","collapsible_depends_on","evaluate_depends_on_value","has_missing_mandatory","getItem","get_docfield","refresh_section_count","ev","which","current","target","attr","handle_tab","shiftKey","shift","grid_row","prev","focused","get_open_grid_row","len","set_focus","primary_button","focus","focus_on_next_field","is_visible","idx","grid","grid_rows","toggle_view","start_idx","add_new_row","show_form","in_list","model","no_value_type","disp_status","is","editor","$input","has_dep","fkey","dependencies_clear","depends_on","guardian_has_value","hidden_due_to_dependency","expression","out","get_values","istable","throw","script_manager","row","make_head","collapse_link","indicator","hide","get_perm","permlevel","toggleClass","undefined","setItem","forEach","is_collapsed","missing_mandatory","section_df","resize_all_columns","cint","FieldGroup","dirty","values","set_values","def_value","datetime","get_today","no_submit_on_enter","catch_enter_as_submit","run_serially","timeout","first_button","focus_on_first_input","no_focus","keypress","has_primary_action","preventDefault","get_primary_btn","get_input","txt","input","get_field","ignore_errors","get_value","is_null","join","set_value","val","dict","clear","set_df_property","prop","dom","id_count","freeze_count","by_id","getElementById","get_unique_id","set_unique_id","ele","$ele","el","getElementsByTagName","remove_script_and_style","evil_tags","tag","div","found","elements","getAttribute","is_element_in_viewport","tolerance","jQuery","rect","getBoundingClientRect","top","left","bottom","height","right","width","set_style","se","element","styleSheet","add","newtag","cs","onclick","src","css","activate","$parent","$child","common_class","active_class","freeze","msg","css_class","cur_grid","repl","unfreeze","save_selection","getSelection","sel","getRangeAt","rangeCount","ranges","selection","createRange","restore_selection","savedSel","removeAllRanges","addRange","select","is_touchscreen","handle_broken_images","container","currentTarget","scroll_to_bottom","$container","scrollTop","scrollHeight","file_to_base64","file_obj","reader","FileReader","onload","result","readAsDataURL","scroll_to_section","section_name","click","scroll","pixel_to_inches","pixels","inches","offsetWidth","ellipsis","text","cstr","tasks","task","load_image","onerror","preprocess","tester","Image","seconds","scrub","spacer","get_modal","content","is_online","developer_mode","navigator","onLine","show_alert","cur_dialog","open_dialogs","Dialog","[object Object]","super","display","is_dialog","animate","size","static","modal","backdrop","keyboard","get_close_btn","modal_body","$body","$message","header","buttons","set_indicator","action","primary","secondary","primary_action","onsubmit","set_primary_action","primary_action_label","secondary_action","set_secondary_action","secondary_action_label","minimizable","toggle_minimize","get_minimize_btn","onhide","on_hide","on_page_show","blur","clear_message","primary_action_fulfilled","set_title","toggle","closest","removeAttr","is_minimized","on_minimize_toggle","get_data_uri","$element","$canvas","getContext","drawImage","toDataURL","Capture","OPTIONS","set_options","mediaDevices","getUserMedia","video","stream","dialog","$e","TEMPLATE","srcObject","play","data_url","show","catch","err","alert","ERR_MESSAGE","user_info","uid","session","user","fullname","image","abbr","get_abbr","get_palette","set_user_background","selector","cordova","base_url","background","full_name","has_role","rl","roles","get_desktop_items","allowed_modules","icon","module_name","modules","allow_modules","is_help","allowed_pages","link","can_read","_doctype","is_report_manager","get_formatted_email","email","quote","get_emails","session_alive","session_alive_timeout","clearTimeout","ValueError","ImportError","instance","format","moment","range","start","end","isBetween","now","equal","isSame","compare","isBefore","quick_edit","with_doctype","db","get_doc","required","get_meta","bold","read_only","append","set_route","string","object","fuzzy_search","query","dataset","Fuse","pluralize","word","count","suffix","capitalize","toUpperCase","arr","is_empty","copy_array","array","as_array","squash","is_mobile","regex","agent","userAgent","compact","Boolean","first_name","keycode","RETURN","stores","Store","Logger","level","ERROR","NOTSET","FORMAT","loggers","DEBUG","INFO","WARN","timestamp","time","chat","profile","exists_ok","response","update","STATUSES","room","kind","owner","users","creation","names","rooms","last_message","history","messages","room_name","typing","send","seen","mess","pretty_datetime","date","today","sound","volume","$audio","paused","info","pause","PATH","emojis","emoji","parse","website","settings","enable_from","enable_to","token","components","Button","SIZE","class","block","small","large","FAB","Indicator","FontAwesome","fixed","Octicon","Avatar","medium","Chat","HTMLElement","set_wrapper","destroy","component","Widget","hyper","PAGE","POPPER","setup","this$1","exists","usr","defaultState","warn","conversation_tones","notification_tones","message_preview","show-message","notify","ActionBar","placeholder","actions","onchange","is_group","group_name","change","span","contacts","RoomList","Room","Popper","heading","widget","active","margin-bottom","submit","oninput","autocomplete","Action","Item","avatar","subtitle","is_unread","MediaProfile","font-size","position","POSITION","text-align","width_title","hints","keyword","items","aliases","alias","capture","FileUploader","on_success","file_doc","path","file_url","filename","box-shadow","Header","on_back","ChatList","ChatForm","hint","route","popper","room_type","ChatBubble","read","groupable","href","tokens","sliced","data-toggle","stopPropagation","autofocus","onkeypress","EmojiPicker","List","platform","appVersion","assets","app","browser","Notification","lang","assign","requestPermission","force","desk","$placeholder","has","$template","chatter","store","setup_room","reference","set","sys_defaults","should_render","parseInt","enable_chat","enable","contains"],"mappings":"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"}